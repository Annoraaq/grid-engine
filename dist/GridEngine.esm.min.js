var tw=Object.create;var cu=Object.defineProperty,ew=Object.defineProperties,rw=Object.getOwnPropertyDescriptor,iw=Object.getOwnPropertyDescriptors,nw=Object.getOwnPropertyNames,ql=Object.getOwnPropertySymbols,ow=Object.getPrototypeOf,Ql=Object.prototype.hasOwnProperty,sw=Object.prototype.propertyIsEnumerable;var $l=(r,t,e)=>t in r?cu(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,it=(r,t)=>{for(var e in t||(t={}))Ql.call(t,e)&&$l(r,e,t[e]);if(ql)for(var e of ql(t))sw.call(t,e)&&$l(r,e,t[e]);return r},Pe=(r,t)=>ew(r,iw(t));var N=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var aw=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of nw(t))!Ql.call(r,s)&&s!==e&&cu(r,s,{get:()=>t[s],enumerable:!(n=rw(t,s))||n.enumerable});return r};var Yl=(r,t,e)=>(e=r!=null?tw(ow(r)):{},aw(t||!r||!r.__esModule?cu(e,"default",{value:r,enumerable:!0}):e,r));var In=N(An=>{var Lw=function(r,t){return r<t?-1:r>t?1:0},Ew=function(r,t){return r<t?1:r>t?-1:0};function Ow(r){return function(t,e){return r(e,t)}}function Aw(r){return r===2?function(t,e){return t[0]<e[0]?-1:t[0]>e[0]?1:t[1]<e[1]?-1:t[1]>e[1]?1:0}:function(t,e){for(var n=0;n<r;){if(t[n]<e[n])return-1;if(t[n]>e[n])return 1;n++}return 0}}An.DEFAULT_COMPARATOR=Lw;An.DEFAULT_REVERSE_COMPARATOR=Ew;An.reverseComparator=Ow;An.createTupleComparator=Aw});var xf=N(xu=>{xu.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer!="undefined";xu.SYMBOL_SUPPORT=typeof Symbol!="undefined"});var dt=N((kE,Cf)=>{var Sf=xf(),Iw=Sf.ARRAY_BUFFER_SUPPORT,Dw=Sf.SYMBOL_SUPPORT;Cf.exports=function(t,e){var n,s,a,h,l;if(!t)throw new Error("obliterator/forEach: invalid iterable.");if(typeof e!="function")throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(t)||Iw&&ArrayBuffer.isView(t)||typeof t=="string"||t.toString()==="[object Arguments]"){for(a=0,h=t.length;a<h;a++)e(t[a],a);return}if(typeof t.forEach=="function"){t.forEach(e);return}if(Dw&&Symbol.iterator in t&&typeof t.next!="function"&&(t=t[Symbol.iterator]()),typeof t.next=="function"){for(n=t,a=0;l=n.next(),l.done!==!0;)e(l.value,a),a++;return}for(s in t)t.hasOwnProperty(s)&&e(t[s],s)}});var ds=N((FE,Df)=>{var _f=In(),Lf=dt(),Ef=_f.DEFAULT_COMPARATOR,Mw=_f.reverseComparator;function ne(r){if(this.clear(),this.comparator=r||Ef,typeof this.comparator!="function")throw new Error("mnemonist/FibonacciHeap.constructor: given comparator should be a function.")}ne.prototype.clear=function(){this.root=null,this.min=null,this.size=0};function kw(r){return{item:r,degree:0}}function Of(r,t){r.root?(t.right=r.root.right,t.left=r.root,r.root.right.left=t,r.root.right=t):r.root=t}ne.prototype.push=function(r){var t=kw(r);return t.left=t,t.right=t,Of(this,t),(!this.min||this.comparator(t.item,this.min.item)<=0)&&(this.min=t),++this.size};ne.prototype.peek=function(){return this.min?this.min.item:void 0};function Af(r){for(var t=[],e=r,n=!1;!(e===r&&n);)e===r&&(n=!0),t.push(e),e=e.right;return t}function If(r,t){r.root===t&&(r.root=t.right),t.left.right=t.right,t.right.left=t.left}function Fw(r,t){r.child?(t.right=r.child.right,t.left=r.child,r.child.right.left=t,r.child.right=t):r.child=t}function Rw(r,t,e){If(r,t),t.left=t,t.right=t,Fw(e,t),e.degree++,t.parent=e}function zw(r){var t=new Array(r.size),e=Af(r.root),n,s,a,h,l,f;for(n=0,s=e.length;n<s;n++){for(a=e[n],l=a.degree;t[l];)h=t[l],r.comparator(a.item,h.item)>0&&(f=a,a=h,h=f),Rw(r,h,a),t[l]=null,l++;t[l]=a}for(n=0;n<r.size;n++)t[n]&&r.comparator(t[n].item,r.min.item)<=0&&(r.min=t[n])}ne.prototype.pop=function(){if(this.size){var r=this.min;if(r.child){var t=Af(r.child),e,n,s;for(n=0,s=t.length;n<s;n++)e=t[n],Of(this,e),delete e.parent}return If(this,r),r===r.right?(this.min=null,this.root=null):(this.min=r.right,zw(this)),this.size--,r.item}};ne.prototype.inspect=function(){var r={size:this.size};return this.min&&"item"in this.min&&(r.top=this.min.item),Object.defineProperty(r,"constructor",{value:ne,enumerable:!1}),r};typeof Symbol!="undefined"&&(ne.prototype[Symbol.for("nodejs.util.inspect.custom")]=ne.prototype.inspect);function ps(r){if(this.clear(),this.comparator=r||Ef,typeof this.comparator!="function")throw new Error("mnemonist/FibonacciHeap.constructor: given comparator should be a function.");this.comparator=Mw(this.comparator)}ps.prototype=ne.prototype;ne.from=function(r,t){var e=new ne(t);return Lf(r,function(n){e.push(n)}),e};ps.from=function(r,t){var e=new ps(t);return Lf(r,function(n){e.push(n)}),e};ne.MinFibonacciHeap=ne;ne.MaxFibonacciHeap=ps;Df.exports=ne});var oe=N(or=>{var Nw=Math.pow(2,8)-1,Vw=Math.pow(2,16)-1,Gw=Math.pow(2,32)-1,Uw=Math.pow(2,7)-1,jw=Math.pow(2,15)-1,Bw=Math.pow(2,31)-1;or.getPointerArray=function(r){var t=r-1;if(t<=Nw)return Uint8Array;if(t<=Vw)return Uint16Array;if(t<=Gw)return Uint32Array;throw new Error("mnemonist: Pointer Array of size > 4294967295 is not supported.")};or.getSignedPointerArray=function(r){var t=r-1;return t<=Uw?Int8Array:t<=jw?Int16Array:t<=Bw?Int32Array:Float64Array};or.getNumberType=function(r){return r===(r|0)?Math.sign(r)===-1?r<=127&&r>=-128?Int8Array:r<=32767&&r>=-32768?Int16Array:Int32Array:r<=255?Uint8Array:r<=65535?Uint16Array:Uint32Array:Float64Array};var Hw={Uint8Array:1,Int8Array:2,Uint16Array:3,Int16Array:4,Uint32Array:5,Int32Array:6,Float32Array:7,Float64Array:8};or.getMinimalRepresentation=function(r,t){var e=null,n=0,s,a,h,l,f;for(l=0,f=r.length;l<f;l++)h=t?t(r[l]):r[l],a=or.getNumberType(h),s=Hw[a.name],s>n&&(n=s,e=a);return e};or.isTypedArray=function(r){return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView(r)};or.concat=function(){var r=0,t,e,n;for(t=0,n=arguments.length;t<n;t++)r+=arguments[t].length;var s=new arguments[0].constructor(r);for(t=0,e=0;t<n;t++)s.set(arguments[t],e),e+=arguments[t].length;return s};or.indices=function(r){for(var t=or.getPointerArray(r),e=new t(r),n=0;n<r;n++)e[n]=n;return e}});var de=N(Mn=>{var Ff=dt(),Rf=oe();function Ww(r){return Array.isArray(r)||Rf.isTypedArray(r)}function Su(r){if(typeof r.length=="number")return r.length;if(typeof r.size=="number")return r.size}function qw(r){var t=Su(r),e=typeof t=="number"?new Array(t):[],n=0;return Ff(r,function(s){e[n++]=s}),e}function $w(r){var t=Su(r),e=typeof t=="number"?Rf.getPointerArray(t):Array,n=typeof t=="number"?new Array(t):[],s=typeof t=="number"?new e(t):[],a=0;return Ff(r,function(h){n[a]=h,s[a]=a++}),[n,s]}Mn.isArrayLike=Ww;Mn.guessLength=Su;Mn.toArray=qw;Mn.toArrayWithIndices=$w});var ws=N((oO,Gf)=>{var bs=dt(),zf=In(),sr=de(),Ps=zf.DEFAULT_COMPARATOR,Cu=zf.reverseComparator;function _u(r,t,e,n){for(var s=t[n],a,h;n>e;){if(a=n-1>>1,h=t[a],r(s,h)<0){t[n]=h,n=a;continue}break}t[n]=s}function kn(r,t,e){for(var n=t.length,s=e,a=t[e],h=2*e+1,l;h<n;)l=h+1,l<n&&r(t[h],t[l])>=0&&(h=l),t[e]=t[h],e=h,h=2*e+1;t[e]=a,_u(r,t,s,e)}function Nf(r,t,e){t.push(e),_u(r,t,0,t.length-1)}function Lu(r,t){var e=t.pop();if(t.length!==0){var n=t[0];return t[0]=e,kn(r,t,0),n}return e}function Vi(r,t,e){if(t.length===0)throw new Error("mnemonist/heap.replace: cannot pop an empty heap.");var n=t[0];return t[0]=e,kn(r,t,0),n}function Vf(r,t,e){var n;return t.length!==0&&r(t[0],e)<0&&(n=t[0],t[0]=e,e=n,kn(r,t,0)),e}function li(r,t){for(var e=t.length,n=e>>1,s=n;--s>=0;)kn(r,t,s)}function Eu(r,t){for(var e=t.length,n=0,s=new Array(e);n<e;)s[n++]=Lu(r,t);return s}function Qw(r,t,e){arguments.length===2&&(e=t,t=r,r=Ps);var n=Cu(r),s,a,h,l=1/0,f;if(t===1){if(sr.isArrayLike(e)){for(s=0,a=e.length;s<a;s++)h=e[s],(l===1/0||r(h,l)<0)&&(l=h);return f=new e.constructor(1),f[0]=l,f}return bs(e,function(y){(l===1/0||r(y,l)<0)&&(l=y)}),[l]}if(sr.isArrayLike(e)){if(t>=e.length)return e.slice().sort(r);for(f=e.slice(0,t),li(n,f),s=t,a=e.length;s<a;s++)n(e[s],f[0])>0&&Vi(n,f,e[s]);return f.sort(r)}var d=sr.guessLength(e);return d!==null&&d<t&&(t=d),f=new Array(t),s=0,bs(e,function(y){s<t?f[s]=y:(s===t&&li(n,f),n(y,f[0])>0&&Vi(n,f,y)),s++}),f.length>s&&(f.length=s),f.sort(r)}function Yw(r,t,e){arguments.length===2&&(e=t,t=r,r=Ps);var n=Cu(r),s,a,h,l=-1/0,f;if(t===1){if(sr.isArrayLike(e)){for(s=0,a=e.length;s<a;s++)h=e[s],(l===-1/0||r(h,l)>0)&&(l=h);return f=new e.constructor(1),f[0]=l,f}return bs(e,function(y){(l===-1/0||r(y,l)>0)&&(l=y)}),[l]}if(sr.isArrayLike(e)){if(t>=e.length)return e.slice().sort(n);for(f=e.slice(0,t),li(r,f),s=t,a=e.length;s<a;s++)r(e[s],f[0])>0&&Vi(r,f,e[s]);return f.sort(n)}var d=sr.guessLength(e);return d!==null&&d<t&&(t=d),f=new Array(t),s=0,bs(e,function(y){s<t?f[s]=y:(s===t&&li(r,f),r(y,f[0])>0&&Vi(r,f,y)),s++}),f.length>s&&(f.length=s),f.sort(n)}function at(r){if(this.clear(),this.comparator=r||Ps,typeof this.comparator!="function")throw new Error("mnemonist/Heap.constructor: given comparator should be a function.")}at.prototype.clear=function(){this.items=[],this.size=0};at.prototype.push=function(r){return Nf(this.comparator,this.items,r),++this.size};at.prototype.peek=function(){return this.items[0]};at.prototype.pop=function(){return this.size!==0&&this.size--,Lu(this.comparator,this.items)};at.prototype.replace=function(r){return Vi(this.comparator,this.items,r)};at.prototype.pushpop=function(r){return Vf(this.comparator,this.items,r)};at.prototype.consume=function(){return this.size=0,Eu(this.comparator,this.items)};at.prototype.toArray=function(){return Eu(this.comparator,this.items.slice())};at.prototype.inspect=function(){var r=this.toArray();return Object.defineProperty(r,"constructor",{value:at,enumerable:!1}),r};typeof Symbol!="undefined"&&(at.prototype[Symbol.for("nodejs.util.inspect.custom")]=at.prototype.inspect);function Ts(r){if(this.clear(),this.comparator=r||Ps,typeof this.comparator!="function")throw new Error("mnemonist/MaxHeap.constructor: given comparator should be a function.");this.comparator=Cu(this.comparator)}Ts.prototype=at.prototype;at.from=function(r,t){var e=new at(t),n;return sr.isArrayLike(r)?n=r.slice():n=sr.toArray(r),li(e.comparator,n),e.items=n,e.size=n.length,e};Ts.from=function(r,t){var e=new Ts(t),n;return sr.isArrayLike(r)?n=r.slice():n=sr.toArray(r),li(e.comparator,n),e.items=n,e.size=n.length,e};at.siftUp=kn;at.siftDown=_u;at.push=Nf;at.pop=Lu;at.replace=Vi;at.pushpop=Vf;at.heapify=li;at.consume=Eu;at.nsmallest=Qw;at.nlargest=Yw;at.MinHeap=at;at.MaxHeap=Ts;Gf.exports=at});var Wf=N((sO,Hf)=>{var Uf="";function jf(r,t,e){for(var n=t.length,s=[],a=n,h=-1,l,f=0,d;a--;)h=Math.max(r[t[a]+e],h);for(d=h>>24&&32||h>>16&&24||h>>8&&16||8;f<d;f+=4){for(a=16;a--;)s[a]=[];for(a=n;a--;)s[r[t[a]+e]>>f&15].push(t[a]);for(l=0;l<16;l++)for(h=s[l].length;h--;)t[++a]=s[l][h]}}function Kw(r,t,e,n){return r[e]-r[n]||(e%3===2?r[e+1]-r[n+1]||t[e+2]-t[n+2]:t[e+1]-t[n+1])}function Ou(r,t){var e=[],n=[],s=2*t/3|0,a=t-s,h=s+1>>1,l=s,f=0,d,y=[],b=[];if(t===1)return[0];for(;l--;)e[l]=(l*3>>1)+1;for(l=3;l--;)jf(r,e,l);for(f=n[(e[0]/3|0)+(e[0]%3===1?0:h)]=1,l=1;l<s;l++)(r[e[l]]!==r[e[l-1]]||r[e[l]+1]!==r[e[l-1]+1]||r[e[l]+2]!==r[e[l-1]+2])&&f++,n[(e[l]/3|0)+(e[l]%3===1?0:h)]=f;if(f<s)for(n=Ou(n,s),l=s;l--;)e[l]=n[l]<h?n[l]*3+1:(n[l]-h)*3+2;for(l=s;l--;)y[e[l]]=l;for(y[t]=-1,y[t+1]=-2,n=t%3===1?[t-1]:[],l=0;l<s;l++)e[l]%3===1&&n.push(e[l]-1);for(jf(r,n,0),l=0,f=0,d=0;l<s&&f<a;)b[d++]=Kw(r,y,e[l],n[f])<0?e[l++]:n[f++];for(;l<s;)b[d++]=e[l++];for(;f<a;)b[d++]=n[f++];return b}function Bf(r){var t=r.length,e=t%3,n=new Array(t+e),s,a;if(typeof r!="string"){var h=Object.create(null);for(a=0;a<t;a++)h[r[a]]||(h[r[a]]=!0);var l=Object.create(null),f=Object.keys(h).sort();for(a=0,s=f.length;a<s;a++)l[f[a]]=a+1;for(a=0;a<t;a++)n[a]=l[r[a]]}else for(a=0;a<t;a++)n[a]=r.charCodeAt(a);for(a=t;a<t+e;a++)n[a]=0;return n}function Hr(r){this.hasArbitrarySequence=typeof r!="string",this.string=r,this.length=r.length,this.array=Ou(Bf(r),this.length)}Hr.prototype.toString=function(){return this.array.join(",")};Hr.prototype.toJSON=function(){return this.array};Hr.prototype.inspect=function(){for(var r=new Array(this.length),t=0;t<this.length;t++)r[t]=this.string.slice(this.array[t]);return Object.defineProperty(r,"constructor",{value:Hr,enumerable:!1}),r};typeof Symbol!="undefined"&&(Hr.prototype[Symbol.for("nodejs.util.inspect.custom")]=Hr.prototype.inspect);function Wr(r){if(this.hasArbitrarySequence=typeof r[0]!="string",this.size=r.length,this.hasArbitrarySequence){this.text=[];for(var t=0,e=this.size;t<e;t++)this.text.push.apply(this.text,r[t]),t<e-1&&this.text.push(Uf)}else this.text=r.join(Uf);this.firstLength=r[0].length,this.length=this.text.length,this.array=Ou(Bf(this.text),this.length)}Wr.prototype.longestCommonSubsequence=function(){var r=this.hasArbitrarySequence?[]:"",t,e,n,s,a;for(e=1;e<this.length;e++)if(s=this.array[e],a=this.array[e-1],!(s<this.firstLength&&a<this.firstLength)&&!(s>this.firstLength&&a>this.firstLength)){for(t=Math.min(this.length-s,this.length-a),n=0;n<t;n++)if(this.text[s+n]!==this.text[a+n]){t=n;break}t>r.length&&(r=this.text.slice(s,s+t))}return r};Wr.prototype.toString=function(){return this.array.join(",")};Wr.prototype.toJSON=function(){return this.array};Wr.prototype.inspect=function(){for(var r=new Array(this.length),t=0;t<this.length;t++)r[t]=this.text.slice(this.array[t]);return Object.defineProperty(r,"constructor",{value:Wr,enumerable:!1}),r};typeof Symbol!="undefined"&&(Wr.prototype[Symbol.for("nodejs.util.inspect.custom")]=Wr.prototype.inspect);Hr.GeneralizedSuffixArray=Wr;Hf.exports=Hr});var Kf=N((aO,Yf)=>{var Xw=dt();function $e(r){this.size=0,this.items=new Map,this.inverse=r}function xe(){this.size=0,this.items=new Map,this.inverse=new $e(this)}function qf(){this.size=0,this.items.clear(),this.inverse.items.clear()}xe.prototype.clear=qf;$e.prototype.clear=qf;function $f(r,t){if(this.items.has(r)){var e=this.items.get(r);if(e===t)return this;this.inverse.items.delete(e)}if(this.inverse.items.has(t)){var n=this.inverse.items.get(t);if(n===r)return this;this.items.delete(n)}return this.items.set(r,t),this.inverse.items.set(t,r),this.size=this.items.size,this.inverse.size=this.inverse.items.size,this}xe.prototype.set=$f;$e.prototype.set=$f;function Qf(r){if(this.items.has(r)){var t=this.items.get(r);return this.items.delete(r),this.inverse.items.delete(t),this.size=this.items.size,this.inverse.size=this.inverse.items.size,!0}return!1}xe.prototype.delete=Qf;$e.prototype.delete=Qf;var Jw=["has","get","forEach","keys","values","entries"];Jw.forEach(function(r){xe.prototype[r]=$e.prototype[r]=function(){return Map.prototype[r].apply(this.items,arguments)}});typeof Symbol!="undefined"&&(xe.prototype[Symbol.iterator]=xe.prototype.entries,$e.prototype[Symbol.iterator]=$e.prototype.entries);xe.prototype.inspect=function(){var r={left:this.items,right:this.inverse.items};return Object.defineProperty(r,"constructor",{value:xe,enumerable:!1}),r};typeof Symbol!="undefined"&&(xe.prototype[Symbol.for("nodejs.util.inspect.custom")]=xe.prototype.inspect);$e.prototype.inspect=function(){var r={left:this.inverse.items,right:this.items};return Object.defineProperty(r,"constructor",{value:$e,enumerable:!1}),r};typeof Symbol!="undefined"&&($e.prototype[Symbol.for("nodejs.util.inspect.custom")]=$e.prototype.inspect);xe.from=function(r){var t=new xe;return Xw(r,function(e,n){t.set(n,e)}),t};Yf.exports=xe});var Vt=N((uO,Xf)=>{function ar(r){if(typeof r!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=r}typeof Symbol!="undefined"&&(ar.prototype[Symbol.iterator]=function(){return this});ar.of=function(){var r=arguments,t=r.length,e=0;return new ar(function(){return e>=t?{done:!0}:{done:!1,value:r[e++]}})};ar.empty=function(){var r=new ar(function(){return{done:!0}});return r};ar.fromSequence=function(r){var t=0,e=r.length;return new ar(function(){return t>=e?{done:!0}:{done:!1,value:r[t++]}})};ar.is=function(r){return r instanceof ar?!0:typeof r=="object"&&r!==null&&typeof r.next=="function"};Xf.exports=ar});var Iu=N(Qe=>{function Zf(r){return r|=r>>1,r|=r>>2,r|=r>>4,r|=r>>8,r|=r>>16,r&~(r>>1)}Qe.msb32=Zf;function Au(r){return r|=r>>1,r|=r>>2,r|=r>>4,r&~(r>>1)}Qe.msb8=Au;Qe.test=function(r,t){return r>>t&1};Qe.criticalBit8=function(r,t){return Au(r^t)};Qe.criticalBit8Mask=function(r,t){return~Au(r^t)>>>0&255};Qe.testCriticalBit8=function(r,t){return 1+(r|t)>>8};Qe.criticalBit32Mask=function(r,t){return~Zf(r^t)>>>0&4294967295};Qe.popcount=function(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),r=r+(r>>4)&252645135,r+=r>>8,r+=r>>16,r&127};var Gi=new Uint8Array(Math.pow(2,8));for(Fn=0,Jf=Gi.length;Fn<Jf;Fn++)Gi[Fn]=Qe.popcount(Fn);var Fn,Jf;Qe.table8Popcount=function(r){return Gi[r&255]+Gi[r>>8&255]+Gi[r>>16&255]+Gi[r>>24&255]}});var ip=N((cO,rp)=>{var ep=Vt(),tp=Iu();function Mt(r){this.length=r,this.clear()}Mt.prototype.clear=function(){this.size=0,this.array=new Uint32Array(Math.ceil(this.length/32))};Mt.prototype.set=function(r,t){var e=r>>5,n=r&31,s=this.array[e],a;return t===0||t===!1?a=this.array[e]&=~(1<<n):a=this.array[e]|=1<<n,a=a>>>0,a>s?this.size++:a<s&&this.size--,this};Mt.prototype.reset=function(r){var t=r>>5,e=r&31,n=this.array[t],s;return s=this.array[t]&=~(1<<e),s<n&&this.size--,this};Mt.prototype.flip=function(r){var t=r>>5,e=r&31,n=this.array[t],s=this.array[t]^=1<<e;return s=s>>>0,s>n?this.size++:s<n&&this.size--,this};Mt.prototype.get=function(r){var t=r>>5,e=r&31;return this.array[t]>>e&1};Mt.prototype.test=function(r){return!!this.get(r)};Mt.prototype.rank=function(r){if(this.size===0)return 0;for(var t=r>>5,e=r&31,n=0,s=0;s<t;s++)n+=tp.table8Popcount(this.array[s]);var a=this.array[t]&(1<<e)-1;return n+=tp.table8Popcount(a),n};Mt.prototype.select=function(r){if(this.size===0||r>=this.length)return-1;for(var t,e=32,n=0,s=0,a=0,h=this.array.length;a<h;a++)if(t=this.array[a],t!==0){a===h-1&&(e=this.length%32||32);for(var l=0;l<e;l++,n++)if(s+=t>>l&1,s===r)return n}};Mt.prototype.forEach=function(r,t){t=arguments.length>1?t:this;for(var e=this.length,n,s,a=32,h=0,l=this.array.length;h<l;h++){n=this.array[h],h===l-1&&(a=e%32||32);for(var f=0;f<a;f++)s=n>>f&1,r.call(t,s,h*32+f)}};Mt.prototype.values=function(){var r=this.length,t=!1,e,n,s=this.array,a=s.length,h=0,l=-1,f=32;return new ep(function d(){if(!t){if(h>=a)return{done:!0};h===a-1&&(f=r%32||32),e=s[h++],t=!0,l=-1}return l++,l>=f?(t=!1,d()):(n=e>>l&1,{value:n})})};Mt.prototype.entries=function(){var r=this.length,t=!1,e,n,s=this.array,a,h=s.length,l=0,f=-1,d=32;return new ep(function y(){if(!t){if(l>=h)return{done:!0};l===h-1&&(d=r%32||32),e=s[l++],t=!0,f=-1}return f++,a=~-l*32+f,f>=d?(t=!1,y()):(n=e>>f&1,{value:[a,n]})})};typeof Symbol!="undefined"&&(Mt.prototype[Symbol.iterator]=Mt.prototype.values);Mt.prototype.inspect=function(){var r=new Uint8Array(this.length);return this.forEach(function(t,e){r[e]=t}),Object.defineProperty(r,"constructor",{value:Mt,enumerable:!1}),r};typeof Symbol!="undefined"&&(Mt.prototype[Symbol.for("nodejs.util.inspect.custom")]=Mt.prototype.inspect);Mt.prototype.toJSON=function(){return Array.from(this.array)};rp.exports=Mt});var ap=N((lO,sp)=>{var op=Vt(),np=Iu(),Zw=function(r){return Math.max(1,Math.ceil(r*1.5))};function tx(r){return new Uint32Array(Math.ceil(r/32))}function mt(r){var t=r||0,e=Zw;typeof r=="object"&&(t=r.initialLength||r.initialCapacity||0,e=r.policy||e),this.size=0,this.length=t,this.capacity=Math.ceil(this.length/32)*32,this.policy=e,this.array=tx(this.capacity)}mt.prototype.set=function(r,t){if(this.length<r)throw new Error("BitVector.set: index out of bounds.");var e=r>>5,n=r&31,s=this.array[e],a;return t===0||t===!1?a=this.array[e]&=~(1<<n):a=this.array[e]|=1<<n,a=a>>>0,a>s?this.size++:a<s&&this.size--,this};mt.prototype.reset=function(r){var t=r>>5,e=r&31,n=this.array[t],s;return s=this.array[t]&=~(1<<e),s<n&&this.size--,this};mt.prototype.flip=function(r){var t=r>>5,e=r&31,n=this.array[t],s=this.array[t]^=1<<e;return s=s>>>0,s>n?this.size++:s<n&&this.size--,this};mt.prototype.applyPolicy=function(r){var t=this.policy(r||this.capacity);if(typeof t!="number"||t<0)throw new Error("mnemonist/bit-vector.applyPolicy: policy returned an invalid value (expecting a positive integer).");if(t<=this.capacity)throw new Error("mnemonist/bit-vector.applyPolicy: policy returned a less or equal capacity to allocate.");return Math.ceil(t/32)*32};mt.prototype.reallocate=function(r){var t=r;if(r=Math.ceil(r/32)*32,t<this.length&&(this.length=t),r===this.capacity)return this;var e=this.array,n=r/32;return n===this.array.length?this:(n>this.array.length?(this.array=new Uint32Array(n),this.array.set(e,0)):this.array=e.slice(0,n),this.capacity=r,this)};mt.prototype.grow=function(r){var t;if(typeof r=="number"){if(this.capacity>=r)return this;for(t=this.capacity;t<r;)t=this.applyPolicy(t);return this.reallocate(t),this}return t=this.applyPolicy(),this.reallocate(t),this};mt.prototype.resize=function(r){return r===this.length?this:r<this.length?(this.length=r,this):(this.length=r,this.reallocate(r),this)};mt.prototype.push=function(r){if(this.capacity===this.length&&this.grow(),r===0||r===!1)return++this.length;this.size++;var t=this.length++,e=t>>5,n=t&31;return this.array[e]|=1<<n,this.length};mt.prototype.pop=function(){if(this.length!==0){var r=--this.length,t=r>>5,e=r&31;return this.array[t]>>e&1}};mt.prototype.get=function(r){if(!(this.length<r)){var t=r>>5,e=r&31;return this.array[t]>>e&1}};mt.prototype.test=function(r){return this.length<r?!1:!!this.get(r)};mt.prototype.rank=function(r){if(this.size===0)return 0;for(var t=r>>5,e=r&31,n=0,s=0;s<t;s++)n+=np.table8Popcount(this.array[s]);var a=this.array[t]&(1<<e)-1;return n+=np.table8Popcount(a),n};mt.prototype.select=function(r){if(this.size===0||r>=this.length)return-1;for(var t,e=32,n=0,s=0,a=0,h=this.array.length;a<h;a++)if(t=this.array[a],t!==0){a===h-1&&(e=this.length%32||32);for(var l=0;l<e;l++,n++)if(s+=t>>l&1,s===r)return n}};mt.prototype.forEach=function(r,t){t=arguments.length>1?t:this;for(var e=this.length,n,s,a=32,h=0,l=this.array.length;h<l;h++){n=this.array[h],h===l-1&&(a=e%32||32);for(var f=0;f<a;f++)s=n>>f&1,r.call(t,s,h*32+f)}};mt.prototype.values=function(){var r=this.length,t=!1,e,n,s=this.array,a=s.length,h=0,l=-1,f=32;return new op(function d(){if(!t){if(h>=a)return{done:!0};h===a-1&&(f=r%32||32),e=s[h++],t=!0,l=-1}return l++,l>=f?(t=!1,d()):(n=e>>l&1,{value:n})})};mt.prototype.entries=function(){var r=this.length,t=!1,e,n,s=this.array,a,h=s.length,l=0,f=-1,d=32;return new op(function y(){if(!t){if(l>=h)return{done:!0};l===h-1&&(d=r%32||32),e=s[l++],t=!0,f=-1}return f++,a=~-l*32+f,f>=d?(t=!1,y()):(n=e>>f&1,{value:[a,n]})})};typeof Symbol!="undefined"&&(mt.prototype[Symbol.iterator]=mt.prototype.values);mt.prototype.inspect=function(){var r=new Uint8Array(this.length);return this.forEach(function(t,e){r[e]=t}),Object.defineProperty(r,"constructor",{value:mt,enumerable:!1}),r};typeof Symbol!="undefined"&&(mt.prototype[Symbol.for("nodejs.util.inspect.custom")]=mt.prototype.inspect);mt.prototype.toJSON=function(){return Array.from(this.array.slice(0,(this.length>>5)+1))};sp.exports=mt});var hp=N((fO,up)=>{function fi(r,t){return(r&65535)*t+(((r>>>16)*t&65535)<<16)&4294967295}function ex(r,t){return(r&65535)+(t>>>16)+(((r>>>16)+t&65535)<<16)&4294967295}function Du(r,t){return r<<t|r>>>32-t}up.exports=function(t,e){var n=3432918353,s=461845907,a=15,h=13,l=5,f=1801774676,d=t,y,b,S;for(b=0,S=e.length-4;b<=S;b+=4)y=e[b]|e[b+1]<<8|e[b+2]<<16|e[b+3]<<24,y=fi(y,n),y=Du(y,a),y=fi(y,s),d^=y,d=Du(d,h),d=fi(d,l),d=ex(d,f);switch(y=0,e.length&3){case 3:y^=e[b+2]<<16;case 2:y^=e[b+1]<<8;case 1:y^=e[b],y=fi(y,n),y=Du(y,a),y=fi(y,s),d^=y;default:}return d^=e.length,d^=d>>>16,d=fi(d,2246822507),d^=d>>>13,d=fi(d,3266489909),d^=d>>>16,d>>>0}});var pp=N((pO,fp)=>{var rx=hp(),ix=dt(),nx=Math.LN2*Math.LN2,ox={errorRate:.005};function cp(r){var t=new Uint16Array(r.length),e,n;for(e=0,n=r.length;e<n;e++)t[e]=r.charCodeAt(e);return t}function lp(r,t,e){var n=rx(t*4221880213&4294967295,e);return n%(r*8)}function pi(r){var t={};if(!r)throw new Error("mnemonist/BloomFilter.constructor: a BloomFilter must be created with a capacity.");if(typeof r=="object"?t=r:t.capacity=r,typeof t.capacity!="number"||t.capacity<=0)throw new Error("mnemonist/BloomFilter.constructor: `capacity` option should be a positive integer.");if(this.capacity=t.capacity,this.errorRate=t.errorRate||ox.errorRate,typeof this.errorRate!="number"||t.errorRate<=0)throw new Error("mnemonist/BloomFilter.constructor: `errorRate` option should be a positive float.");this.clear()}pi.prototype.clear=function(){var r=-1/nx*this.capacity*Math.log(this.errorRate),t=r/8|0;this.hashFunctions=t*8/this.capacity*Math.LN2|0,this.data=new Uint8Array(t)};pi.prototype.add=function(r){for(var t=cp(r),e=0,n=this.hashFunctions;e<n;e++){var s=lp(this.data.length,e,t),a=1<<(7&s);this.data[s>>3]|=a}return this};pi.prototype.test=function(r){for(var t=cp(r),e=0,n=this.hashFunctions;e<n;e++){var s=lp(this.data.length,e,t);if(!(this.data[s>>3]&1<<(7&s)))return!1}return!0};pi.prototype.toJSON=function(){return this.data};pi.from=function(r,t){if(!t&&(t=r.length||r.size,typeof t!="number"))throw new Error("BloomFilter.from: could not infer the filter's capacity. Try passing it as second argument.");var e=new pi(t);return ix(r,function(n){e.add(n)}),e};fp.exports=pi});var mp=N((dO,dp)=>{var sx=dt();function Ye(r){if(typeof r!="function")throw new Error("mnemonist/BKTree.constructor: given `distance` should be a function.");this.distance=r,this.clear()}Ye.prototype.add=function(r){if(!this.root)return this.root={item:r,children:{}},this.size++,this;for(var t=this.root,e;e=this.distance(r,t.item),!!t.children[e];)t=t.children[e];return t.children[e]={item:r,children:{}},this.size++,this};Ye.prototype.search=function(r,t){if(!this.root)return[];for(var e=[],n=[this.root],s,a,h,l,f;n.length;)for(s=n.pop(),h=this.distance(t,s.item),h<=r&&e.push({item:s.item,distance:h}),l=h-r,f=h+r+1;l<f;l++)a=s.children[l],a&&n.push(a);return e};Ye.prototype.clear=function(){this.size=0,this.root=null};Ye.prototype.toJSON=function(){return this.root};Ye.prototype.inspect=function(){for(var r=[],t=[this.root],e,n;t.length;)if(e=t.pop(),!!e){r.push(e.item);for(n in e.children)t.push(e.children[n])}return Object.defineProperty(r,"constructor",{value:Ye,enumerable:!1}),r};typeof Symbol!="undefined"&&(Ye.prototype[Symbol.for("nodejs.util.inspect.custom")]=Ye.prototype.inspect);Ye.from=function(r,t){var e=new Ye(t);return sx(r,function(n){e.add(n)}),e};dp.exports=Ye});var ku=N((mO,yp)=>{var Mu=de(),gp=Vt();function St(r,t){if(arguments.length<2)throw new Error("mnemonist/fixed-deque: expecting an Array class and a capacity.");if(typeof t!="number"||t<=0)throw new Error("mnemonist/fixed-deque: `capacity` should be a positive number.");this.ArrayClass=r,this.capacity=t,this.items=new r(this.capacity),this.clear()}St.prototype.clear=function(){this.start=0,this.size=0};St.prototype.push=function(r){if(this.size===this.capacity)throw new Error("mnemonist/fixed-deque.push: deque capacity ("+this.capacity+") exceeded!");var t=(this.start+this.size)%this.capacity;return this.items[t]=r,++this.size};St.prototype.unshift=function(r){if(this.size===this.capacity)throw new Error("mnemonist/fixed-deque.unshift: deque capacity ("+this.capacity+") exceeded!");var t=this.start-1;return this.start===0&&(t=this.capacity-1),this.items[t]=r,this.start=t,++this.size};St.prototype.pop=function(){if(this.size===0)return;let r=(this.start+this.size-1)%this.capacity;return this.size--,this.items[r]};St.prototype.shift=function(){if(this.size!==0){var r=this.start;return this.size--,this.start++,this.start===this.capacity&&(this.start=0),this.items[r]}};St.prototype.peekFirst=function(){if(this.size!==0)return this.items[this.start]};St.prototype.peekLast=function(){if(this.size!==0){var r=this.start+this.size-1;return r>this.capacity&&(r-=this.capacity),this.items[r]}};St.prototype.get=function(r){if(this.size!==0)return r=this.start+r,r>this.capacity&&(r-=this.capacity),this.items[r]};St.prototype.forEach=function(r,t){t=arguments.length>1?t:this;for(var e=this.capacity,n=this.size,s=this.start,a=0;a<n;)r.call(t,this.items[s],a,this),s++,a++,s===e&&(s=0)};St.prototype.toArray=function(){var r=this.start+this.size;if(r<this.capacity)return this.items.slice(this.start,r);for(var t=new this.ArrayClass(this.size),e=this.capacity,n=this.size,s=this.start,a=0;a<n;)t[a]=this.items[s],s++,a++,s===e&&(s=0);return t};St.prototype.values=function(){var r=this.items,t=this.capacity,e=this.size,n=this.start,s=0;return new gp(function(){if(s>=e)return{done:!0};var a=r[n];return n++,s++,n===t&&(n=0),{value:a,done:!1}})};St.prototype.entries=function(){var r=this.items,t=this.capacity,e=this.size,n=this.start,s=0;return new gp(function(){if(s>=e)return{done:!0};var a=r[n];return n++,n===t&&(n=0),{value:[s++,a],done:!1}})};typeof Symbol!="undefined"&&(St.prototype[Symbol.iterator]=St.prototype.values);St.prototype.inspect=function(){var r=this.toArray();return r.type=this.ArrayClass.name,r.capacity=this.capacity,Object.defineProperty(r,"constructor",{value:St,enumerable:!1}),r};typeof Symbol!="undefined"&&(St.prototype[Symbol.for("nodejs.util.inspect.custom")]=St.prototype.inspect);St.from=function(r,t,e){if(arguments.length<3&&(e=Mu.guessLength(r),typeof e!="number"))throw new Error("mnemonist/fixed-deque.from: could not guess iterable length. Please provide desired capacity as last argument.");var n=new St(t,e);if(Mu.isArrayLike(r)){var s,a;for(s=0,a=r.length;s<a;s++)n.items[s]=r[s];return n.size=a,n}return Mu.forEach(r,function(h){n.push(h)}),n};yp.exports=St});var Tp=N((gO,bp)=>{var Fu=de(),Ru=ku();function Ui(r,t){if(arguments.length<2)throw new Error("mnemonist/circular-buffer: expecting an Array class and a capacity.");if(typeof t!="number"||t<=0)throw new Error("mnemonist/circular-buffer: `capacity` should be a positive number.");this.ArrayClass=r,this.capacity=t,this.items=new r(this.capacity),this.clear()}function vp(r){Ui.prototype[r]=Ru.prototype[r]}Object.keys(Ru.prototype).forEach(vp);typeof Symbol!="undefined"&&Object.getOwnPropertySymbols(Ru.prototype).forEach(vp);Ui.prototype.push=function(r){var t=(this.start+this.size)%this.capacity;return this.items[t]=r,this.size===this.capacity?(this.start=(t+1)%this.capacity,this.size):++this.size};Ui.prototype.unshift=function(r){var t=this.start-1;return this.start===0&&(t=this.capacity-1),this.items[t]=r,this.size===this.capacity?(this.start=t,this.size):(this.start=t,++this.size)};Ui.from=function(r,t,e){if(arguments.length<3&&(e=Fu.guessLength(r),typeof e!="number"))throw new Error("mnemonist/circular-buffer.from: could not guess iterable length. Please provide desired capacity as last argument.");var n=new Ui(t,e);if(Fu.isArrayLike(r)){var s,a;for(s=0,a=r.length;s<a;s++)n.items[s]=r[s];return n.size=a,n}return Fu.forEach(r,function(h){n.push(h)}),n};bp.exports=Ui});var wp=N((yO,Pp)=>{function Wt(r){if(typeof r!="function")throw new Error("mnemonist/DefaultMap.constructor: expecting a function.");this.items=new Map,this.factory=r,this.size=0}Wt.prototype.clear=function(){this.items.clear(),this.size=0};Wt.prototype.get=function(r){var t=this.items.get(r);return typeof t=="undefined"&&(t=this.factory(r,this.size),this.items.set(r,t),this.size++),t};Wt.prototype.peek=function(r){return this.items.get(r)};Wt.prototype.set=function(r,t){return this.items.set(r,t),this.size=this.items.size,this};Wt.prototype.has=function(r){return this.items.has(r)};Wt.prototype.delete=function(r){var t=this.items.delete(r);return this.size=this.items.size,t};Wt.prototype.forEach=function(r,t){t=arguments.length>1?t:this,this.items.forEach(r,t)};Wt.prototype.entries=function(){return this.items.entries()};Wt.prototype.keys=function(){return this.items.keys()};Wt.prototype.values=function(){return this.items.values()};typeof Symbol!="undefined"&&(Wt.prototype[Symbol.iterator]=Wt.prototype.entries);Wt.prototype.inspect=function(){return this.items};typeof Symbol!="undefined"&&(Wt.prototype[Symbol.for("nodejs.util.inspect.custom")]=Wt.prototype.inspect);Wt.autoIncrement=function(){var r=0;return function(){return r++}};Pp.exports=Wt});var Sp=N((vO,xp)=>{function ur(r){if(typeof r!="function")throw new Error("mnemonist/DefaultWeakMap.constructor: expecting a function.");this.items=new WeakMap,this.factory=r}ur.prototype.clear=function(){this.items=new WeakMap};ur.prototype.get=function(r){var t=this.items.get(r);return typeof t=="undefined"&&(t=this.factory(r),this.items.set(r,t)),t};ur.prototype.peek=function(r){return this.items.get(r)};ur.prototype.set=function(r,t){return this.items.set(r,t),this};ur.prototype.has=function(r){return this.items.has(r)};ur.prototype.delete=function(r){return this.items.delete(r)};ur.prototype.inspect=function(){return this.items};typeof Symbol!="undefined"&&(ur.prototype[Symbol.for("nodejs.util.inspect.custom")]=ur.prototype.inspect);xp.exports=ur});var _p=N((bO,Cp)=>{var zu=oe();function hr(r){var t=zu.getPointerArray(r),e=zu.getPointerArray(Math.log2(r));this.size=r,this.dimension=r,this.parents=new t(r),this.ranks=new e(r);for(var n=0;n<r;n++)this.parents[n]=n}hr.prototype.find=function(r){for(var t=r,e,n;e=this.parents[t],t!==e;)t=e;for(;n=this.parents[r],n!==t;)this.parents[r]=t,r=n;return t};hr.prototype.union=function(r,t){var e=this.find(r),n=this.find(t);if(e===n)return this;this.dimension--;var s=this.ranks[r],a=this.ranks[t];return s<a?this.parents[e]=n:s>a?this.parents[n]=e:(this.parents[n]=e,this.ranks[e]++),this};hr.prototype.connected=function(r,t){var e=this.find(r);return e===this.find(t)};hr.prototype.mapping=function(){for(var r=zu.getPointerArray(this.dimension),t={},e=new r(this.size),n=0,s,a=0,h=this.parents.length;a<h;a++)s=this.find(a),typeof t[s]=="undefined"?(e[a]=n,t[s]=n++):e[a]=t[s];return e};hr.prototype.compile=function(){for(var r={},t=new Array(this.dimension),e=0,n,s=0,a=this.parents.length;s<a;s++)n=this.find(s),typeof r[n]=="undefined"?(t[e]=[s],r[n]=e++):t[r[n]].push(s);return t};hr.prototype.inspect=function(){var r=this.compile();return Object.defineProperty(r,"constructor",{value:hr,enumerable:!1}),r};typeof Symbol!="undefined"&&(hr.prototype[Symbol.for("nodejs.util.inspect.custom")]=hr.prototype.inspect);Cp.exports=hr});var xs=N((TO,Op)=>{var Lp=In(),Nu=ws(),ax=Lp.DEFAULT_COMPARATOR,ux=Lp.reverseComparator;function hx(r,t,e,n){for(var s=e,a=n,h=t[n],l=2*n+1,f;l<s;)f=l+1,f<s&&r(t[l],t[f])>=0&&(l=f),t[n]=t[l],n=l,l=2*n+1;t[n]=h,Nu.siftDown(r,t,a,n)}function Ep(r,t,e,n){for(var s=n,a=s,h=new r(n),l,f;a>0;)l=e[--a],a!==0&&(f=e[0],e[0]=l,hx(t,e,--n,0),l=f),h[a]=l;return h}function cr(r,t,e){if(arguments.length===2&&(e=t,t=null),this.ArrayClass=r,this.capacity=e,this.items=new r(e),this.clear(),this.comparator=t||ax,typeof e!="number"&&e<=0)throw new Error("mnemonist/FixedReverseHeap.constructor: capacity should be a number > 0.");if(typeof this.comparator!="function")throw new Error("mnemonist/FixedReverseHeap.constructor: given comparator should be a function.");this.comparator=ux(this.comparator)}cr.prototype.clear=function(){this.size=0};cr.prototype.push=function(r){return this.size<this.capacity?(this.items[this.size]=r,Nu.siftDown(this.comparator,this.items,0,this.size),this.size++):this.comparator(r,this.items[0])>0&&Nu.replace(this.comparator,this.items,r),this.size};cr.prototype.peek=function(){return this.items[0]};cr.prototype.consume=function(){var r=Ep(this.ArrayClass,this.comparator,this.items,this.size);return this.size=0,r};cr.prototype.toArray=function(){return Ep(this.ArrayClass,this.comparator,this.items.slice(0,this.size),this.size)};cr.prototype.inspect=function(){var r=this.toArray();return Object.defineProperty(r,"constructor",{value:cr,enumerable:!1}),r};typeof Symbol!="undefined"&&(cr.prototype[Symbol.for("nodejs.util.inspect.custom")]=cr.prototype.inspect);Op.exports=cr});var Dp=N((PO,Ip)=>{var cx=dt(),Ap=function(r){return r};function Kt(r){if(this.items=new Map,this.clear(),Array.isArray(r)?(this.writeHashFunction=r[0],this.readHashFunction=r[1]):(this.writeHashFunction=r,this.readHashFunction=r),this.writeHashFunction||(this.writeHashFunction=Ap),this.readHashFunction||(this.readHashFunction=Ap),typeof this.writeHashFunction!="function")throw new Error("mnemonist/FuzzyMap.constructor: invalid hash function given.");if(typeof this.readHashFunction!="function")throw new Error("mnemonist/FuzzyMap.constructor: invalid hash function given.")}Kt.prototype.clear=function(){this.items.clear(),this.size=0};Kt.prototype.add=function(r){var t=this.writeHashFunction(r);return this.items.set(t,r),this.size=this.items.size,this};Kt.prototype.set=function(r,t){return r=this.writeHashFunction(r),this.items.set(r,t),this.size=this.items.size,this};Kt.prototype.get=function(r){return r=this.readHashFunction(r),this.items.get(r)};Kt.prototype.has=function(r){return r=this.readHashFunction(r),this.items.has(r)};Kt.prototype.forEach=function(r,t){t=arguments.length>1?t:this,this.items.forEach(function(e){r.call(t,e,e)})};Kt.prototype.values=function(){return this.items.values()};typeof Symbol!="undefined"&&(Kt.prototype[Symbol.iterator]=Kt.prototype.values);Kt.prototype.inspect=function(){var r=Array.from(this.items.values());return Object.defineProperty(r,"constructor",{value:Kt,enumerable:!1}),r};typeof Symbol!="undefined"&&(Kt.prototype[Symbol.for("nodejs.util.inspect.custom")]=Kt.prototype.inspect);Kt.from=function(r,t,e){var n=new Kt(t);return cx(r,function(s,a){e?n.set(a,s):n.add(s)}),n};Ip.exports=Kt});var Vu=N((wO,Mp)=>{var Ss=Vt(),lx=dt();function lt(r){this.Container=r||Array,this.items=new Map,this.clear(),Object.defineProperty(this.items,"constructor",{value:lt,enumerable:!1})}lt.prototype.clear=function(){this.size=0,this.dimension=0,this.items.clear()};lt.prototype.set=function(r,t){var e=this.items.get(r),n;return e||(this.dimension++,e=new this.Container,this.items.set(r,e)),this.Container===Set?(n=e.size,e.add(t),n<e.size&&this.size++):(e.push(t),this.size++),this};lt.prototype.delete=function(r){var t=this.items.get(r);return t?(this.size-=this.Container===Set?t.size:t.length,this.dimension--,this.items.delete(r),!0):!1};lt.prototype.remove=function(r,t){var e=this.items.get(r),n,s;return e?this.Container===Set?(n=e.delete(t),n&&this.size--,e.size===0&&(this.items.delete(r),this.dimension--),n):(s=e.indexOf(t),s===-1?!1:(this.size--,e.length===1?(this.items.delete(r),this.dimension--,!0):(e.splice(s,1),!0))):!1};lt.prototype.has=function(r){return this.items.has(r)};lt.prototype.get=function(r){return this.items.get(r)};lt.prototype.multiplicity=function(r){var t=this.items.get(r);return typeof t=="undefined"?0:this.Container===Set?t.size:t.length};lt.prototype.count=lt.prototype.multiplicity;lt.prototype.forEach=function(r,t){t=arguments.length>1?t:this;var e;function n(s){r.call(t,s,e)}this.items.forEach(function(s,a){e=a,s.forEach(n)})};lt.prototype.forEachAssociation=function(r,t){t=arguments.length>1?t:this,this.items.forEach(r,t)};lt.prototype.keys=function(){return this.items.keys()};lt.prototype.values=function(){var r=this.items.values(),t=!1,e,n,s,a;return this.Container===Set?new Ss(function h(){if(!t){if(n=r.next(),n.done)return{done:!0};t=!0,e=n.value.values()}return n=e.next(),n.done?(t=!1,h()):{done:!1,value:n.value}}):new Ss(function h(){if(!t){if(n=r.next(),n.done)return{done:!0};t=!0,e=n.value,s=0,a=e.length}return s>=a?(t=!1,h()):{done:!1,value:e[s++]}})};lt.prototype.entries=function(){var r=this.items.entries(),t=!1,e,n,s,a,h;return this.Container===Set?new Ss(function l(){if(!t){if(n=r.next(),n.done)return{done:!0};t=!0,s=n.value[0],e=n.value[1].values()}return n=e.next(),n.done?(t=!1,l()):{done:!1,value:[s,n.value]}}):new Ss(function l(){if(!t){if(n=r.next(),n.done)return{done:!0};t=!0,s=n.value[0],e=n.value[1],a=0,h=e.length}return a>=h?(t=!1,l()):{done:!1,value:[s,e[a++]]}})};lt.prototype.containers=function(){return this.items.values()};lt.prototype.associations=function(){return this.items.entries()};typeof Symbol!="undefined"&&(lt.prototype[Symbol.iterator]=lt.prototype.entries);lt.prototype.inspect=function(){return this.items};typeof Symbol!="undefined"&&(lt.prototype[Symbol.for("nodejs.util.inspect.custom")]=lt.prototype.inspect);lt.prototype.toJSON=function(){return this.items};lt.from=function(r,t){var e=new lt(t);return lx(r,function(n,s){e.set(s,n)}),e};Mp.exports=lt});var Rp=N((xO,Fp)=>{var fx=Vu(),px=dt(),kp=function(r){return r};function Xt(r,t){if(this.items=new fx(t),this.clear(),Array.isArray(r)?(this.writeHashFunction=r[0],this.readHashFunction=r[1]):(this.writeHashFunction=r,this.readHashFunction=r),this.writeHashFunction||(this.writeHashFunction=kp),this.readHashFunction||(this.readHashFunction=kp),typeof this.writeHashFunction!="function")throw new Error("mnemonist/FuzzyMultiMap.constructor: invalid hash function given.");if(typeof this.readHashFunction!="function")throw new Error("mnemonist/FuzzyMultiMap.constructor: invalid hash function given.")}Xt.prototype.clear=function(){this.items.clear(),this.size=0,this.dimension=0};Xt.prototype.add=function(r){var t=this.writeHashFunction(r);return this.items.set(t,r),this.size=this.items.size,this.dimension=this.items.dimension,this};Xt.prototype.set=function(r,t){return r=this.writeHashFunction(r),this.items.set(r,t),this.size=this.items.size,this.dimension=this.items.dimension,this};Xt.prototype.get=function(r){return r=this.readHashFunction(r),this.items.get(r)};Xt.prototype.has=function(r){return r=this.readHashFunction(r),this.items.has(r)};Xt.prototype.forEach=function(r,t){t=arguments.length>1?t:this,this.items.forEach(function(e){r.call(t,e,e)})};Xt.prototype.values=function(){return this.items.values()};typeof Symbol!="undefined"&&(Xt.prototype[Symbol.iterator]=Xt.prototype.values);Xt.prototype.inspect=function(){var r=Array.from(this);return Object.defineProperty(r,"constructor",{value:Xt,enumerable:!1}),r};typeof Symbol!="undefined"&&(Xt.prototype[Symbol.for("nodejs.util.inspect.custom")]=Xt.prototype.inspect);Xt.from=function(r,t,e,n){arguments.length===3&&typeof e=="boolean"&&(n=e,e=Array);var s=new Xt(t,e);return px(r,function(a,h){n?s.set(h,a):s.add(a)}),s};Fp.exports=Xt});var Vp=N((SO,Np)=>{var zp=1024;function dx(r){return(r&r-1)===0}function Ke(r,t){if(arguments.length<1)throw new Error("mnemonist/hashed-array-tree: expecting at least a byte array constructor.");var e=t||0,n=zp,s=0;if(typeof t=="object"&&(e=t.initialCapacity||0,s=t.initialLength||0,n=t.blockSize||zp),!n||!dx(n))throw new Error("mnemonist/hashed-array-tree: block size should be a power of two.");var a=Math.max(s,e),h=Math.ceil(a/n);this.ArrayClass=r,this.length=s,this.capacity=h*n,this.blockSize=n,this.offsetMask=n-1,this.blockMask=Math.log2(n),this.blocks=new Array(h);for(var l=0;l<h;l++)this.blocks[l]=new this.ArrayClass(this.blockSize)}Ke.prototype.set=function(r,t){if(this.length<r)throw new Error("HashedArrayTree("+this.ArrayClass.name+").set: index out of bounds.");var e=r>>this.blockMask,n=r&this.offsetMask;return this.blocks[e][n]=t,this};Ke.prototype.get=function(r){if(!(this.length<r)){var t=r>>this.blockMask,e=r&this.offsetMask;return this.blocks[t][e]}};Ke.prototype.grow=function(r){if(typeof r!="number"&&(r=this.capacity+this.blockSize),this.capacity>=r)return this;for(;this.capacity<r;)this.blocks.push(new this.ArrayClass(this.blockSize)),this.capacity+=this.blockSize;return this};Ke.prototype.resize=function(r){return r===this.length?this:r<this.length?(this.length=r,this):(this.length=r,this.grow(r),this)};Ke.prototype.push=function(r){this.capacity===this.length&&this.grow();var t=this.length,e=t>>this.blockMask,n=t&this.offsetMask;return this.blocks[e][n]=r,++this.length};Ke.prototype.pop=function(){if(this.length!==0){var r=this.blocks[this.blocks.length-1],t=--this.length&this.offsetMask;return r[t]}};Ke.prototype.inspect=function(){for(var r=new this.ArrayClass(this.length),t,e=0,n=this.length;e<n;e++)t=e>>this.blockMask,r[e]=this.blocks[t][e&this.offsetMask];return r.type=this.ArrayClass.name,r.items=this.length,r.capacity=this.capacity,r.blockSize=this.blockSize,Object.defineProperty(r,"constructor",{value:Ke,enumerable:!1}),r};typeof Symbol!="undefined"&&(Ke.prototype[Symbol.for("nodejs.util.inspect.custom")]=Ke.prototype.inspect);Np.exports=Ke});var Uu=N((CO,Up)=>{var Gp=Vt(),Gu=de();function kt(r,t){if(arguments.length<2)throw new Error("mnemonist/fixed-stack: expecting an Array class and a capacity.");if(typeof t!="number"||t<=0)throw new Error("mnemonist/fixed-stack: `capacity` should be a positive number.");this.capacity=t,this.ArrayClass=r,this.items=new this.ArrayClass(this.capacity),this.clear()}kt.prototype.clear=function(){this.size=0};kt.prototype.push=function(r){if(this.size===this.capacity)throw new Error("mnemonist/fixed-stack.push: stack capacity ("+this.capacity+") exceeded!");return this.items[this.size++]=r,this.size};kt.prototype.pop=function(){if(this.size!==0)return this.items[--this.size]};kt.prototype.peek=function(){return this.items[this.size-1]};kt.prototype.forEach=function(r,t){t=arguments.length>1?t:this;for(var e=0,n=this.items.length;e<n;e++)r.call(t,this.items[n-e-1],e,this)};kt.prototype.toArray=function(){for(var r=new this.ArrayClass(this.size),t=this.size-1,e=this.size;e--;)r[e]=this.items[t-e];return r};kt.prototype.values=function(){var r=this.items,t=this.size,e=0;return new Gp(function(){if(e>=t)return{done:!0};var n=r[t-e-1];return e++,{value:n,done:!1}})};kt.prototype.entries=function(){var r=this.items,t=this.size,e=0;return new Gp(function(){if(e>=t)return{done:!0};var n=r[t-e-1];return{value:[e++,n],done:!1}})};typeof Symbol!="undefined"&&(kt.prototype[Symbol.iterator]=kt.prototype.values);kt.prototype.toString=function(){return this.toArray().join(",")};kt.prototype.toJSON=function(){return this.toArray()};kt.prototype.inspect=function(){var r=this.toArray();return r.type=this.ArrayClass.name,r.capacity=this.capacity,Object.defineProperty(r,"constructor",{value:kt,enumerable:!1}),r};typeof Symbol!="undefined"&&(kt.prototype[Symbol.for("nodejs.util.inspect.custom")]=kt.prototype.inspect);kt.from=function(r,t,e){if(arguments.length<3&&(e=Gu.guessLength(r),typeof e!="number"))throw new Error("mnemonist/fixed-stack.from: could not guess iterable length. Please provide desired capacity as last argument.");var n=new kt(t,e);if(Gu.isArrayLike(r)){var s,a;for(s=0,a=r.length;s<a;s++)n.items[s]=r[s];return n.size=a,n}return Gu.forEach(r,function(h){n.push(h)}),n};Up.exports=kt});var Bp=N((_O,jp)=>{var mx=de(),gx=oe(),yx=Uu();function ju(r,t,e,n,s,a,h,l){var f=h+(l-h)/2|0,d=~-f,y=-~f,b=e[f];n[a]=b+1;var S=t?t(r[b]):r[b][1],C=a*2+1,A=a*2+2,I=-1/0,F=-1/0;h<=d&&(I=ju(r,t,e,n,s,C,h,d)),y<=l&&(F=ju(r,t,e,n,s,A,y,l));var B=Math.max(S,I,F),j=b;return B===I?j=s[n[C]-1]:B===F&&(j=s[n[A]-1]),s[b]=j,B}function lr(r,t){this.size=r.length,this.intervals=r;var e=null,n=null;Array.isArray(t)&&(e=t[0],n=t[1]);var s=r.length,a=gx.getPointerArray(s+1),h=new a(s),l;for(l=1;l<s;l++)h[l]=l;h.sort(function(S,C){return S=r[S],C=r[C],e?(S=e(S),C=e(C)):(S=S[0],C=C[0]),S<C?-1:S>C?1:0});var f=Math.ceil(Math.log2(s+1)),d=Math.pow(2,f)-1,y=new a(d),b=new a(s);ju(r,n,h,y,b,0,0,s-1),h=null,this.height=f,this.tree=y,this.augmentations=b,this.startGetter=e,this.endGetter=n,this.stack=new yx(a,this.height)}lr.prototype.intervalsContainingPoint=function(r){var t=[],e=this.stack;e.clear(),e.push(0);for(var n=this.tree.length,s,a,h,l,f,d,y,b,S;e.size;)s=e.pop(),a=this.tree[s]-1,h=this.intervals[a],l=this.intervals[this.augmentations[a]],y=this.endGetter?this.endGetter(l):l[1],!(r>y)&&(b=s*2+1,b<n&&this.tree[b]!==0&&e.push(b),f=this.startGetter?this.startGetter(h):h[0],d=this.endGetter?this.endGetter(h):h[1],r>=f&&r<=d&&t.push(h),!(r<f)&&(S=s*2+2,S<n&&this.tree[S]!==0&&e.push(S)));return t};lr.prototype.intervalsOverlappingInterval=function(r){var t=this.startGetter?this.startGetter(r):r[0],e=this.endGetter?this.endGetter(r):r[1],n=[],s=this.stack;s.clear(),s.push(0);for(var a=this.tree.length,h,l,f,d,y,b,S,C,A;s.size;)h=s.pop(),l=this.tree[h]-1,f=this.intervals[l],d=this.intervals[this.augmentations[l]],S=this.endGetter?this.endGetter(d):d[1],!(t>S)&&(C=h*2+1,C<a&&this.tree[C]!==0&&s.push(C),y=this.startGetter?this.startGetter(f):f[0],b=this.endGetter?this.endGetter(f):f[1],e>=y&&t<=b&&n.push(f),!(e<y)&&(A=h*2+2,A<a&&this.tree[A]!==0&&s.push(A)));return n};lr.prototype.inspect=function(){var r=this.intervals.slice();return Object.defineProperty(r,"constructor",{value:lr,enumerable:!1}),r};typeof Symbol!="undefined"&&(lr.prototype[Symbol.for("nodejs.util.inspect.custom")]=lr.prototype.inspect);lr.from=function(r,t){return mx.isArrayLike(r)?new lr(r,t):new lr(Array.from(r),t)};jp.exports=lr});var Bu=N(qr=>{qr.search=function(r,t,e,n){var s=0;e=typeof e!="undefined"?e:0,n=typeof n!="undefined"?n:r.length,n--;for(var a;e<=n;)if(s=e+n>>>1,a=r[s],a>t)n=~-s;else if(a<t)e=-~s;else return s;return-1};qr.searchWithComparator=function(r,t,e){for(var n=0,s=0,a=~-t.length,h;s<=a;)if(n=s+a>>>1,h=r(t[n],e),h>0)a=~-n;else if(h<0)s=-~n;else return n;return-1};qr.lowerBound=function(r,t,e,n){var s=0;for(e=typeof e!="undefined"?e:0,n=typeof n!="undefined"?n:r.length;e<n;)s=e+n>>>1,t<=r[s]?n=s:e=-~s;return e};qr.lowerBoundWithComparator=function(r,t,e){for(var n=0,s=0,a=t.length;s<a;)n=s+a>>>1,r(e,t[n])<=0?a=n:s=-~n;return s};qr.lowerBoundIndices=function(r,t,e,n,s){var a=0;for(n=typeof n!="undefined"?n:0,s=typeof s!="undefined"?s:r.length;n<s;)a=n+s>>>1,e<=r[t[a]]?s=a:n=-~a;return n};qr.upperBound=function(r,t,e,n){var s=0;for(e=typeof e!="undefined"?e:0,n=typeof n!="undefined"?n:r.length;e<n;)s=e+n>>>1,t>=r[s]?e=-~s:n=s;return e};qr.upperBoundWithComparator=function(r,t,e){for(var n=0,s=0,a=t.length;s<a;)n=s+a>>>1,r(e,t[n])>=0?s=-~n:a=n;return s}});var $p=N($r=>{var ji=oe(),Bi=de().isArrayLike,di=Bu(),Hp=ds();function Wp(r,t){if(r.length===0)return t.slice();if(t.length===0)return r.slice();var e;r[0]>t[0]&&(e=r,r=t,t=e);var n=r[r.length-1],s=t[0];if(n<=s)return ji.isTypedArray(r)?ji.concat(r,t):r.concat(t);var a=new r.constructor(r.length+t.length),h,l,f;for(h=0,l=r.length;h<l&&(f=r[h],f<=s);h++)a[h]=f;for(var d=h,y=r.length,b=0,S=t.length,C,A;d<y&&b<S;)C=r[d],A=t[b],C<=A?(a[h++]=C,d++):(a[h++]=A,b++);for(;d<y;)a[h++]=r[d++];for(;b<S;)a[h++]=t[b++];return a}function qp(r,t){if(r.length===0)return t.slice();if(t.length===0)return r.slice();var e;r[0]>t[0]&&(e=r,r=t,t=e);var n=r[r.length-1],s=t[0];if(n<s)return ji.isTypedArray(r)?ji.concat(r,t):r.concat(t);var a=new r.constructor,h,l,f;for(h=0,l=r.length;h<l&&(f=r[h],f<s);h++)a.push(f);for(var d=h,y=r.length,b=0,S=t.length,C,A;d<y&&b<S;)C=r[d],A=t[b],C<=A?((a.length===0||a[a.length-1]!==C)&&a.push(C),d++):((a.length===0||a[a.length-1]!==A)&&a.push(A),b++);for(;d<y;)C=r[d++],(a.length===0||a[a.length-1]!==C)&&a.push(C);for(;b<S;)A=t[b++],(a.length===0||a[a.length-1]!==A)&&a.push(A);return a}$r.intersectionUniqueArrays=function(r,t){if(r.length===0||t.length===0)return new r.constructor(0);var e;r[0]>t[0]&&(e=r,r=t,t=e);var n=r[r.length-1],s=t[0];if(n<s)return new r.constructor(0);for(var a=new r.constructor,h=di.lowerBound(r,s),l=r.length,f=0,d=di.upperBound(t,n),y,b;h<l&&f<d;)y=r[h],b=t[f],y<b?h=di.lowerBound(r,b,h+1):y>b?f=di.lowerBound(t,y,f+1):(a.push(y),h++,f++);return a};function vx(r){var t=0,e=-1/0,n,s,a,h=[];for(s=0,a=r.length;s<a;s++)n=r[s].length,n!==0&&(h.push(r[s]),t+=n,n>e&&(e=n));if(h.length===0)return new r[0].constructor(0);if(h.length===1)return h[0].slice();if(h.length===2)return Wp(h[0],h[1]);r=h;var l=new r[0].constructor(t),f=ji.getPointerArray(e),d=new f(r.length),y=new Hp(function(C,A){return C=r[C][d[C]],A=r[A][d[A]],C<A?-1:C>A?1:0});for(s=0;s<a;s++)y.push(s);s=0;for(var b,S;y.size;)b=y.pop(),S=r[b][d[b]++],l[s++]=S,d[b]<r[b].length&&y.push(b);return l}function bx(r){var t=-1/0,e,n,s,a=[];for(n=0,s=r.length;n<s;n++)e=r[n].length,e!==0&&(a.push(r[n]),e>t&&(t=e));if(a.length===0)return new r[0].constructor(0);if(a.length===1)return a[0].slice();if(a.length===2)return qp(a[0],a[1]);r=a;var h=new r[0].constructor,l=ji.getPointerArray(t),f=new l(r.length),d=new Hp(function(S,C){return S=r[S][f[S]],C=r[C][f[C]],S<C?-1:S>C?1:0});for(n=0;n<s;n++)d.push(n);for(var y,b;d.size;)y=d.pop(),b=r[y][f[y]++],(h.length===0||h[h.length-1]!==b)&&h.push(b),f[y]<r[y].length&&d.push(y);return h}$r.kWayIntersectionUniqueArrays=function(r){var t=-1/0,e=-1/0,n=1/0,s,a,h,l,f;for(l=0,f=r.length;l<f;l++){if(h=r[l].length,h===0)return[];h>t&&(t=h),s=r[l][0],a=r[l][h-1],s>e&&(e=s),a<n&&(n=a)}if(e>n)return[];if(e===n)return[e];var d,y,b=r[0],S,C,A,I,F,B,j=e;for(l=1;l<f;l++){for(d=b,y=r[l],b=new Array,S=0,C=di.lowerBound(y,j),A=d.length,I=y.length;S<A&&C<I;)F=d[S],B=y[C],F<B?S=di.lowerBound(d,B,S+1):F>B?C=di.lowerBound(y,F,C+1):(b.push(F),S++,C++);if(b.length===0)return b;j=b[0]}return b};$r.merge=function(){if(arguments.length===2){if(Bi(arguments[0]))return Wp(arguments[0],arguments[1])}else if(Bi(arguments[0]))return vx(arguments);return null};$r.unionUnique=function(){if(arguments.length===2){if(Bi(arguments[0]))return qp(arguments[0],arguments[1])}else if(Bi(arguments[0]))return bx(arguments);return null};$r.intersectionUnique=function(){if(arguments.length===2){if(Bi(arguments[0]))return $r.intersectionUniqueArrays(arguments[0],arguments[1])}else if(Bi(arguments[0]))return $r.kWayIntersectionUniqueArrays(arguments);return null}});var Kp=N((OO,Yp)=>{var Tx=Vt(),Px=dt(),wx=$p();function Qp(r){return r}function se(r){if(this.clear(),Array.isArray(r)?(this.documentTokenizer=r[0],this.queryTokenizer=r[1]):(this.documentTokenizer=r,this.queryTokenizer=r),this.documentTokenizer||(this.documentTokenizer=Qp),this.queryTokenizer||(this.queryTokenizer=Qp),typeof this.documentTokenizer!="function")throw new Error("mnemonist/InvertedIndex.constructor: document tokenizer is not a function.");if(typeof this.queryTokenizer!="function")throw new Error("mnemonist/InvertedIndex.constructor: query tokenizer is not a function.")}se.prototype.clear=function(){this.items=[],this.mapping=new Map,this.size=0,this.dimension=0};se.prototype.add=function(r){this.size++;var t=this.items.length;this.items.push(r);var e=this.documentTokenizer(r);if(!Array.isArray(e))throw new Error("mnemonist/InvertedIndex.add: tokenizer function should return an array of tokens.");for(var n=new Set,s,a,h=0,l=e.length;h<l;h++)s=e[h],!n.has(s)&&(n.add(s),a=this.mapping.get(s),a||(a=[],this.mapping.set(s,a)),a.push(t));return this.dimension=this.mapping.size,this};se.prototype.get=function(r){if(!this.size)return[];var t=this.queryTokenizer(r);if(!Array.isArray(t))throw new Error("mnemonist/InvertedIndex.query: tokenizer function should return an array of tokens.");if(!t.length)return[];var e=this.mapping.get(t[0]),n,s,a;if(typeof e=="undefined"||e.length===0)return[];if(t.length>1)for(s=1,a=t.length;s<a;s++){if(n=this.mapping.get(t[s]),typeof n=="undefined"||n.length===0)return[];e=wx.intersectionUniqueArrays(e,n)}var h=new Array(e.length);for(s=0,a=h.length;s<a;s++)h[s]=this.items[e[s]];return h};se.prototype.forEach=function(r,t){t=arguments.length>1?t:this;for(var e=0,n=this.documents.length;e<n;e++)r.call(t,this.documents[e],e,this)};se.prototype.documents=function(){var r=this.items,t=r.length,e=0;return new Tx(function(){if(e>=t)return{done:!0};var n=r[e++];return{value:n,done:!1}})};se.prototype.tokens=function(){return this.mapping.keys()};typeof Symbol!="undefined"&&(se.prototype[Symbol.iterator]=se.prototype.documents);se.prototype.inspect=function(){var r=this.items.slice();return Object.defineProperty(r,"constructor",{value:se,enumerable:!1}),r};typeof Symbol!="undefined"&&(se.prototype[Symbol.for("nodejs.util.inspect.custom")]=se.prototype.inspect);se.from=function(r,t){var e=new se(t);return Px(r,function(n){e.add(n)}),e};Yp.exports=se});var Wu=N(Hu=>{var Gt=new Float64Array(64),Tt=new Float64Array(64);function xx(r,t,e){var n,s,a,h,l;for(Gt[0]=t,Tt[0]=e,s=0;s>=0;)if(a=Gt[s],h=Tt[s]-1,a<h){for(n=r[a];a<h;){for(;r[h]>=n&&a<h;)h--;for(a<h&&(r[a++]=r[h]);r[a]<=n&&a<h;)a++;a<h&&(r[h--]=r[a])}r[a]=n,Gt[s+1]=a+1,Tt[s+1]=Tt[s],Tt[s++]=a,Tt[s]-Gt[s]>Tt[s-1]-Gt[s-1]&&(l=Gt[s],Gt[s]=Gt[s-1],Gt[s-1]=l,l=Tt[s],Tt[s]=Tt[s-1],Tt[s-1]=l)}else s--;return r}Hu.inplaceQuickSort=xx;function Sx(r,t,e,n){var s,a,h,l,f,d;for(Gt[0]=e,Tt[0]=n,a=0;a>=0;)if(h=Gt[a],l=Tt[a]-1,h<l){for(f=t[h],s=r[f];h<l;){for(;r[t[l]]>=s&&h<l;)l--;for(h<l&&(t[h++]=t[l]);r[t[h]]<=s&&h<l;)h++;h<l&&(t[l--]=t[h])}t[h]=f,Gt[a+1]=h+1,Tt[a+1]=Tt[a],Tt[a++]=h,Tt[a]-Gt[a]>Tt[a-1]-Gt[a-1]&&(d=Gt[a],Gt[a]=Gt[a-1],Gt[a-1]=d,d=Tt[a],Tt[a]=Tt[a-1],Tt[a-1]=d)}else a--;return t}Hu.inplaceQuickSortIndices=Sx});var ed=N((IO,td)=>{var Cx=de(),Cs=oe(),Xp=In().createTupleComparator,Jp=xs(),_x=Wu().inplaceQuickSortIndices;function qu(r,t,e,n){var s,a=0,h;for(s=0;s<r;s++)h=t[s][e]-n[s],a+=h*h;return a}function Lx(r,t){var e=t.length,n=new Array(r),s=new Array(e),a,h=Cs.getPointerArray(e),l=new h(e),f,d,y,b=!0;for(f=0;f<r;f++){for(a=new Float64Array(e),d=0;d<e;d++)y=t[d],a[d]=y[1][f],b&&(s[d]=y[0],l[d]=d);b=!1,n[f]=a}return{axes:n,ids:l,labels:s}}function Zp(r,t,e,n){for(var s=n.length,a=Cs.getPointerArray(s+1),h=new a(s),l=new a(s),f=new a(s),d=[[0,0,e.length,-1,0]],y,b,S,C,A,I,F,B,j=0;d.length!==0;)y=d.pop(),B=y[0],I=y[1],F=y[2],b=y[3],S=y[4],_x(t[B],e,I,F),s=F-I,C=I+(s>>>1),A=e[C],h[j]=A,b>-1&&(S===0?l[b]=j+1:f[b]=j+1),B=(B+1)%r,C!==I&&C!==F-1&&d.push([B,C+1,F,j,1]),C!==I&&d.push([B,I,C,j,0]),j++;return{axes:t,labels:n,pivots:h,lefts:l,rights:f}}function ze(r,t){this.dimensions=r,this.visited=0,this.axes=t.axes,this.labels=t.labels,this.pivots=t.pivots,this.lefts=t.lefts,this.rights=t.rights,this.size=this.labels.length}ze.prototype.nearestNeighbor=function(r){var t=1/0,e=null,n=this.dimensions,s=this.axes,a=this.pivots,h=this.lefts,l=this.rights,f=0;function d(y,b){f++;var S=h[b],C=l[b],A=a[b],I=qu(n,s,A,r);if(!(I<t&&(e=A,t=I,I===0))){var F=s[y][A]-r[y];y=(y+1)%n,F>0?S!==0&&d(y,S-1):C!==0&&d(y,C-1),F*F<t&&(F>0?C!==0&&d(y,C-1):S!==0&&d(y,S-1))}}return d(0,0),this.visited=f,this.labels[e]};var Ex=Xp(3),Ox=Xp(2);ze.prototype.kNearestNeighbors=function(r,t){if(r<=0)throw new Error("mnemonist/kd-tree.kNearestNeighbors: k should be a positive number.");if(r=Math.min(r,this.size),r===1)return[this.nearestNeighbor(t)];var e=new Jp(Array,Ex,r),n=this.dimensions,s=this.axes,a=this.pivots,h=this.lefts,l=this.rights,f=0;function d(S,C){var A=h[C],I=l[C],F=a[C],B=qu(n,s,F,t);e.push([B,f++,F]);var j=t[S],Z=s[S][F],ht=j-Z;S=(S+1)%n,j<Z?A!==0&&d(S,A-1):I!==0&&d(S,I-1),(ht*ht<e.peek()[0]||e.size<r)&&(j<Z?I!==0&&d(S,I-1):A!==0&&d(S,A-1))}d(0,0),this.visited=f;for(var y=e.consume(),b=0;b<y.length;b++)y[b]=this.labels[y[b][2]];return y};ze.prototype.linearKNearestNeighbors=function(r,t){if(r<=0)throw new Error("mnemonist/kd-tree.kNearestNeighbors: k should be a positive number.");r=Math.min(r,this.size);var e=new Jp(Array,Ox,r),n,s,a;for(n=0,s=this.size;n<s;n++)a=qu(this.dimensions,this.axes,this.pivots[n],t),e.push([a,n]);var h=e.consume();for(n=0;n<h.length;n++)h[n]=this.labels[this.pivots[h[n][1]]];return h};ze.prototype.inspect=function(){var r=new Map;r.dimensions=this.dimensions,Object.defineProperty(r,"constructor",{value:ze,enumerable:!1});var t,e,n;for(t=0;t<this.size;t++){for(n=new Array(this.dimensions),e=0;e<this.dimensions;e++)n[e]=this.axes[e][t];r.set(this.labels[t],n)}return r};typeof Symbol!="undefined"&&(ze.prototype[Symbol.for("nodejs.util.inspect.custom")]=ze.prototype.inspect);ze.from=function(r,t){var e=Cx.toArray(r),n=Lx(t,e),s=Zp(t,n.axes,n.ids,n.labels);return new ze(t,s)};ze.fromAxes=function(r,t){t||(t=Cs.indices(r[0].length));var e=r.length,n=Zp(r.length,r,Cs.indices(t.length),t);return new ze(e,n)};td.exports=ze});var nd=N((DO,id)=>{var rd=Vt(),Ax=dt();function yt(){this.clear()}yt.prototype.clear=function(){this.head=null,this.tail=null,this.size=0};yt.prototype.first=function(){return this.head?this.head.item:void 0};yt.prototype.peek=yt.prototype.first;yt.prototype.last=function(){return this.tail?this.tail.item:void 0};yt.prototype.push=function(r){var t={item:r,next:null};return this.head?(this.tail.next=t,this.tail=t):(this.head=t,this.tail=t),this.size++,this.size};yt.prototype.unshift=function(r){var t={item:r,next:null};return this.head?(this.head.next||(this.tail=this.head),t.next=this.head,this.head=t):(this.head=t,this.tail=t),this.size++,this.size};yt.prototype.shift=function(){if(this.size){var r=this.head;return this.head=r.next,this.size--,r.item}};yt.prototype.forEach=function(r,t){if(this.size){t=arguments.length>1?t:this;for(var e=this.head,n=0;e;)r.call(t,e.item,n,this),e=e.next,n++}};yt.prototype.toArray=function(){if(!this.size)return[];for(var r=new Array(this.size),t=0,e=this.size,n=this.head;t<e;t++)r[t]=n.item,n=n.next;return r};yt.prototype.values=function(){var r=this.head;return new rd(function(){if(!r)return{done:!0};var t=r.item;return r=r.next,{value:t,done:!1}})};yt.prototype.entries=function(){var r=this.head,t=0;return new rd(function(){if(!r)return{done:!0};var e=r.item;return r=r.next,t++,{value:[t-1,e],done:!1}})};typeof Symbol!="undefined"&&(yt.prototype[Symbol.iterator]=yt.prototype.values);yt.prototype.toString=function(){return this.toArray().join(",")};yt.prototype.toJSON=function(){return this.toArray()};yt.prototype.inspect=function(){var r=this.toArray();return Object.defineProperty(r,"constructor",{value:yt,enumerable:!1}),r};typeof Symbol!="undefined"&&(yt.prototype[Symbol.for("nodejs.util.inspect.custom")]=yt.prototype.inspect);yt.from=function(r){var t=new yt;return Ax(r,function(e){t.push(e)}),t};id.exports=yt});var _s=N((MO,od)=>{var $u=Vt(),Ix=dt(),Dx=oe(),Mx=de();function Et(r,t,e){if(arguments.length<2&&(e=r,r=null,t=null),this.capacity=e,typeof this.capacity!="number"||this.capacity<=0)throw new Error("mnemonist/lru-cache: capacity should be positive number.");if(!isFinite(this.capacity)||Math.floor(this.capacity)!==this.capacity)throw new Error("mnemonist/lru-cache: capacity should be a finite positive integer.");var n=Dx.getPointerArray(e);this.forward=new n(e),this.backward=new n(e),this.K=typeof r=="function"?new r(e):new Array(e),this.V=typeof t=="function"?new t(e):new Array(e),this.size=0,this.head=0,this.tail=0,this.items={}}Et.prototype.clear=function(){this.size=0,this.head=0,this.tail=0,this.items={}};Et.prototype.splayOnTop=function(r){var t=this.head;if(this.head===r)return this;var e=this.backward[r],n=this.forward[r];return this.tail===r?this.tail=e:this.backward[n]=e,this.forward[e]=n,this.backward[t]=r,this.head=r,this.forward[r]=t,this};Et.prototype.set=function(r,t){var e=this.items[r];if(typeof e!="undefined"){this.splayOnTop(e),this.V[e]=t;return}this.size<this.capacity?e=this.size++:(e=this.tail,this.tail=this.backward[e],delete this.items[this.K[e]]),this.items[r]=e,this.K[e]=r,this.V[e]=t,this.forward[e]=this.head,this.backward[this.head]=e,this.head=e};Et.prototype.setpop=function(r,t){var e=null,n=null,s=this.items[r];return typeof s!="undefined"?(this.splayOnTop(s),e=this.V[s],this.V[s]=t,{evicted:!1,key:r,value:e}):(this.size<this.capacity?s=this.size++:(s=this.tail,this.tail=this.backward[s],e=this.V[s],n=this.K[s],delete this.items[this.K[s]]),this.items[r]=s,this.K[s]=r,this.V[s]=t,this.forward[s]=this.head,this.backward[this.head]=s,this.head=s,n?{evicted:!0,key:n,value:e}:null)};Et.prototype.has=function(r){return r in this.items};Et.prototype.get=function(r){var t=this.items[r];if(typeof t!="undefined")return this.splayOnTop(t),this.V[t]};Et.prototype.peek=function(r){var t=this.items[r];if(typeof t!="undefined")return this.V[t]};Et.prototype.forEach=function(r,t){t=arguments.length>1?t:this;for(var e=0,n=this.size,s=this.head,a=this.K,h=this.V,l=this.forward;e<n;)r.call(t,h[s],a[s],this),s=l[s],e++};Et.prototype.keys=function(){var r=0,t=this.size,e=this.head,n=this.K,s=this.forward;return new $u(function(){if(r>=t)return{done:!0};var a=n[e];return r++,r<t&&(e=s[e]),{done:!1,value:a}})};Et.prototype.values=function(){var r=0,t=this.size,e=this.head,n=this.V,s=this.forward;return new $u(function(){if(r>=t)return{done:!0};var a=n[e];return r++,r<t&&(e=s[e]),{done:!1,value:a}})};Et.prototype.entries=function(){var r=0,t=this.size,e=this.head,n=this.K,s=this.V,a=this.forward;return new $u(function(){if(r>=t)return{done:!0};var h=n[e],l=s[e];return r++,r<t&&(e=a[e]),{done:!1,value:[h,l]}})};typeof Symbol!="undefined"&&(Et.prototype[Symbol.iterator]=Et.prototype.entries);Et.prototype.inspect=function(){for(var r=new Map,t=this.entries(),e;e=t.next(),!e.done;)r.set(e.value[0],e.value[1]);return Object.defineProperty(r,"constructor",{value:Et,enumerable:!1}),r};typeof Symbol!="undefined"&&(Et.prototype[Symbol.for("nodejs.util.inspect.custom")]=Et.prototype.inspect);Et.from=function(r,t,e,n){if(arguments.length<2){if(n=Mx.guessLength(r),typeof n!="number")throw new Error("mnemonist/lru-cache.from: could not guess iterable length. Please provide desired capacity as last argument.")}else arguments.length===2&&(n=t,t=null,e=null);var s=new Et(t,e,n);return Ix(r,function(a,h){s.set(h,a)}),s};od.exports=Et});var ad=N((kO,sd)=>{var Hi=_s(),kx=dt(),Fx=oe(),Rx=de();function fr(r,t,e){arguments.length<2?Hi.call(this,r):Hi.call(this,r,t,e);var n=Fx.getPointerArray(this.capacity);this.deleted=new n(this.capacity),this.deletedSize=0}for(Qu in Hi.prototype)fr.prototype[Qu]=Hi.prototype[Qu];var Qu;typeof Symbol!="undefined"&&(fr.prototype[Symbol.iterator]=Hi.prototype[Symbol.iterator]);fr.prototype.clear=function(){Hi.prototype.clear.call(this),this.deletedSize=0};fr.prototype.set=function(r,t){var e=this.items[r];if(typeof e!="undefined"){this.splayOnTop(e),this.V[e]=t;return}this.size<this.capacity?(this.deletedSize>0?e=this.deleted[--this.deletedSize]:e=this.size,this.size++):(e=this.tail,this.tail=this.backward[e],delete this.items[this.K[e]]),this.items[r]=e,this.K[e]=r,this.V[e]=t,this.forward[e]=this.head,this.backward[this.head]=e,this.head=e};fr.prototype.setpop=function(r,t){var e=null,n=null,s=this.items[r];return typeof s!="undefined"?(this.splayOnTop(s),e=this.V[s],this.V[s]=t,{evicted:!1,key:r,value:e}):(this.size<this.capacity?(this.deletedSize>0?s=this.deleted[--this.deletedSize]:s=this.size,this.size++):(s=this.tail,this.tail=this.backward[s],e=this.V[s],n=this.K[s],delete this.items[this.K[s]]),this.items[r]=s,this.K[s]=r,this.V[s]=t,this.forward[s]=this.head,this.backward[this.head]=s,this.head=s,n?{evicted:!0,key:n,value:e}:null)};fr.prototype.delete=function(r){var t=this.items[r];if(typeof t=="undefined")return!1;if(delete this.items[r],this.size===1)return this.size=0,this.head=0,this.tail=0,this.deletedSize=0,!0;var e=this.backward[t],n=this.forward[t];return this.head===t&&(this.head=n),this.tail===t&&(this.tail=e),this.forward[e]=n,this.backward[n]=e,this.size--,this.deleted[this.deletedSize++]=t,!0};fr.prototype.remove=function(r,t=void 0){var e=this.items[r];if(typeof e=="undefined")return t;var n=this.V[e];if(delete this.items[r],this.size===1)return this.size=0,this.head=0,this.tail=0,this.deletedSize=0,n;var s=this.backward[e],a=this.forward[e];return this.head===e&&(this.head=a),this.tail===e&&(this.tail=s),this.forward[s]=a,this.backward[a]=s,this.size--,this.deleted[this.deletedSize++]=e,n};fr.from=function(r,t,e,n){if(arguments.length<2){if(n=Rx.guessLength(r),typeof n!="number")throw new Error("mnemonist/lru-cache.from: could not guess iterable length. Please provide desired capacity as last argument.")}else arguments.length===2&&(n=t,t=null,e=null);var s=new fr(t,e,n);return kx(r,function(a,h){s.set(h,a)}),s};sd.exports=fr});var Yu=N((FO,ud)=>{var Wi=_s(),zx=dt(),Nx=oe(),Vx=de();function qt(r,t,e){if(arguments.length<2&&(e=r,r=null,t=null),this.capacity=e,typeof this.capacity!="number"||this.capacity<=0)throw new Error("mnemonist/lru-map: capacity should be positive number.");if(!isFinite(this.capacity)||Math.floor(this.capacity)!==this.capacity)throw new Error("mnemonist/lru-map: capacity should be a finite positive integer.");var n=Nx.getPointerArray(e);this.forward=new n(e),this.backward=new n(e),this.K=typeof r=="function"?new r(e):new Array(e),this.V=typeof t=="function"?new t(e):new Array(e),this.size=0,this.head=0,this.tail=0,this.items=new Map}qt.prototype.clear=function(){this.size=0,this.head=0,this.tail=0,this.items.clear()};qt.prototype.set=function(r,t){var e=this.items.get(r);if(typeof e!="undefined"){this.splayOnTop(e),this.V[e]=t;return}this.size<this.capacity?e=this.size++:(e=this.tail,this.tail=this.backward[e],this.items.delete(this.K[e])),this.items.set(r,e),this.K[e]=r,this.V[e]=t,this.forward[e]=this.head,this.backward[this.head]=e,this.head=e};qt.prototype.setpop=function(r,t){var e=null,n=null,s=this.items.get(r);return typeof s!="undefined"?(this.splayOnTop(s),e=this.V[s],this.V[s]=t,{evicted:!1,key:r,value:e}):(this.size<this.capacity?s=this.size++:(s=this.tail,this.tail=this.backward[s],e=this.V[s],n=this.K[s],this.items.delete(this.K[s])),this.items.set(r,s),this.K[s]=r,this.V[s]=t,this.forward[s]=this.head,this.backward[this.head]=s,this.head=s,n?{evicted:!0,key:n,value:e}:null)};qt.prototype.has=function(r){return this.items.has(r)};qt.prototype.get=function(r){var t=this.items.get(r);if(typeof t!="undefined")return this.splayOnTop(t),this.V[t]};qt.prototype.peek=function(r){var t=this.items.get(r);if(typeof t!="undefined")return this.V[t]};qt.prototype.splayOnTop=Wi.prototype.splayOnTop;qt.prototype.forEach=Wi.prototype.forEach;qt.prototype.keys=Wi.prototype.keys;qt.prototype.values=Wi.prototype.values;qt.prototype.entries=Wi.prototype.entries;typeof Symbol!="undefined"&&(qt.prototype[Symbol.iterator]=qt.prototype.entries);qt.prototype.inspect=Wi.prototype.inspect;qt.from=function(r,t,e,n){if(arguments.length<2){if(n=Vx.guessLength(r),typeof n!="number")throw new Error("mnemonist/lru-cache.from: could not guess iterable length. Please provide desired capacity as last argument.")}else arguments.length===2&&(n=t,t=null,e=null);var s=new qt(t,e,n);return zx(r,function(a,h){s.set(h,a)}),s};ud.exports=qt});var cd=N((RO,hd)=>{var qi=Yu(),Gx=dt(),Ux=oe(),jx=de();function pr(r,t,e){arguments.length<2?qi.call(this,r):qi.call(this,r,t,e);var n=Ux.getPointerArray(this.capacity);this.deleted=new n(this.capacity),this.deletedSize=0}for(Ku in qi.prototype)pr.prototype[Ku]=qi.prototype[Ku];var Ku;typeof Symbol!="undefined"&&(pr.prototype[Symbol.iterator]=qi.prototype[Symbol.iterator]);pr.prototype.clear=function(){qi.prototype.clear.call(this),this.deletedSize=0};pr.prototype.set=function(r,t){var e=this.items.get(r);if(typeof e!="undefined"){this.splayOnTop(e),this.V[e]=t;return}this.size<this.capacity?(this.deletedSize>0?e=this.deleted[--this.deletedSize]:e=this.size,this.size++):(e=this.tail,this.tail=this.backward[e],this.items.delete(this.K[e])),this.items.set(r,e),this.K[e]=r,this.V[e]=t,this.forward[e]=this.head,this.backward[this.head]=e,this.head=e};pr.prototype.setpop=function(r,t){var e=null,n=null,s=this.items.get(r);return typeof s!="undefined"?(this.splayOnTop(s),e=this.V[s],this.V[s]=t,{evicted:!1,key:r,value:e}):(this.size<this.capacity?(this.deletedSize>0?s=this.deleted[--this.deletedSize]:s=this.size,this.size++):(s=this.tail,this.tail=this.backward[s],e=this.V[s],n=this.K[s],this.items.delete(this.K[s])),this.items.set(r,s),this.K[s]=r,this.V[s]=t,this.forward[s]=this.head,this.backward[this.head]=s,this.head=s,n?{evicted:!0,key:n,value:e}:null)};pr.prototype.delete=function(r){var t=this.items.get(r);if(typeof t=="undefined")return!1;if(this.items.delete(r),this.size===1)return this.size=0,this.head=0,this.tail=0,this.deletedSize=0,!0;var e=this.backward[t],n=this.forward[t];return this.head===t&&(this.head=n),this.tail===t&&(this.tail=e),this.forward[e]=n,this.backward[n]=e,this.size--,this.deleted[this.deletedSize++]=t,!0};pr.prototype.remove=function(r,t=void 0){var e=this.items.get(r);if(typeof e=="undefined")return t;var n=this.V[e];if(this.items.delete(r),this.size===1)return this.size=0,this.head=0,this.tail=0,this.deletedSize=0,n;var s=this.backward[e],a=this.forward[e];return this.head===e&&(this.head=a),this.tail===e&&(this.tail=s),this.forward[s]=a,this.backward[a]=s,this.size--,this.deleted[this.deletedSize++]=e,n};pr.from=function(r,t,e,n){if(arguments.length<2){if(n=jx.guessLength(r),typeof n!="number")throw new Error("mnemonist/lru-map.from: could not guess iterable length. Please provide desired capacity as last argument.")}else arguments.length===2&&(n=t,t=null,e=null);var s=new pr(t,e,n);return Gx(r,function(a,h){s.set(h,a)}),s};hd.exports=pr});var fd=N((zO,ld)=>{var Bx=Vt(),Hx=dt(),Wx=xs(),qx=function(r,t){return r[1]>t[1]?-1:r[1]<t[1]?1:0};function et(){this.items=new Map,Object.defineProperty(this.items,"constructor",{value:et,enumerable:!1}),this.clear()}et.prototype.clear=function(){this.size=0,this.dimension=0,this.items.clear()};et.prototype.add=function(r,t){if(t===0)return this;if(t<0)return this.remove(r,-t);if(t=t||1,typeof t!="number")throw new Error("mnemonist/multi-set.add: given count should be a number.");this.size+=t;let e=this.items.get(r);return e===void 0?this.dimension++:t+=e,this.items.set(r,t),this};et.prototype.set=function(r,t){var e;if(typeof t!="number")throw new Error("mnemonist/multi-set.set: given count should be a number.");return t<=0?(e=this.items.get(r),typeof e!="undefined"&&(this.size-=e,this.dimension--),this.items.delete(r),this):(t=t||1,e=this.items.get(r),typeof e=="number"?this.items.set(r,e+t):(this.dimension++,this.items.set(r,t)),this.size+=t,this)};et.prototype.has=function(r){return this.items.has(r)};et.prototype.delete=function(r){var t=this.items.get(r);return t===0?!1:(this.size-=t,this.dimension--,this.items.delete(r),!0)};et.prototype.remove=function(r,t){if(t!==0){if(t<0)return this.add(r,-t);if(t=t||1,typeof t!="number")throw new Error("mnemonist/multi-set.remove: given count should be a number.");var e=this.items.get(r);if(typeof e!="undefined"){var n=Math.max(0,e-t);n===0?(this.items.delete(r),this.size-=e,this.dimension--):(this.items.set(r,n),this.size-=t)}}};et.prototype.edit=function(r,t){var e=this.multiplicity(r);if(e!==0){var n=this.multiplicity(t);return this.items.set(t,e+n),this.items.delete(r),this}};et.prototype.multiplicity=function(r){var t=this.items.get(r);return typeof t=="undefined"?0:t};et.prototype.get=et.prototype.multiplicity;et.prototype.count=et.prototype.multiplicity;et.prototype.frequency=function(r){if(this.size===0)return 0;var t=this.multiplicity(r);return t/this.size};et.prototype.top=function(r){if(typeof r!="number"||r<=0)throw new Error("mnemonist/multi-set.top: n must be a number > 0.");for(var t=new Wx(Array,qx,r),e=this.items.entries(),n;n=e.next(),!n.done;)t.push(n.value);return t.consume()};et.prototype.forEach=function(r,t){t=arguments.length>1?t:this;var e;this.items.forEach(function(n,s){for(e=0;e<n;e++)r.call(t,s,s)})};et.prototype.forEachMultiplicity=function(r,t){t=arguments.length>1?t:this,this.items.forEach(r,t)};et.prototype.keys=function(){return this.items.keys()};et.prototype.values=function(){var r=this.items.entries(),t=!1,e,n,s,a;return new Bx(function h(){if(!t){if(e=r.next(),e.done)return{done:!0};t=!0,n=e.value[0],s=e.value[1],a=0}return a>=s?(t=!1,h()):(a++,{done:!1,value:n})})};et.prototype.multiplicities=function(){return this.items.entries()};typeof Symbol!="undefined"&&(et.prototype[Symbol.iterator]=et.prototype.values);et.prototype.inspect=function(){return this.items};typeof Symbol!="undefined"&&(et.prototype[Symbol.for("nodejs.util.inspect.custom")]=et.prototype.inspect);et.prototype.toJSON=function(){return this.items};et.from=function(r){var t=new et;return Hx(r,function(e){t.add(e)}),t};et.isSubset=function(r,t){var e=r.multiplicities(),n,s,a;if(r===t)return!0;if(r.dimension>t.dimension)return!1;for(;n=e.next(),!n.done;)if(s=n.value[0],a=n.value[1],t.multiplicity(s)<a)return!1;return!0};et.isSuperset=function(r,t){return et.isSubset(t,r)};ld.exports=et});var vd=N((NO,yd)=>{var $x=Vt(),Qx=dt();function Yx(r,t,e){return((Math.pow(r,2)-Math.pow(Math.abs(t-e),2))/2|0)+r+1}function Kx(r,t){for(var e=0,n=0,s=t+1;n<s;n++)e+=Yx(r,t,n);return e}function Xx(r,t){return r.length>t.length?-1:r.length<t.length?1:r<t?-1:r>t?1:0}function pd(r,t){var e=r+1,n=t/e|0,s=n+1,a,h,l=t-n*e,f=e-l,d=new Array(r+1);for(a=0;a<f;a++)d[a]=[a*n,n];var y=(a-1)*n+n;for(h=0;h<l;h++)d[a+h]=[y+h*s,s];return d}function dd(r,t){var e=t.length,n=r+1,s=e/n|0,a=s+1,h,l,f,d=e-s*n,y=n-d,b=new Array(r+1);for(l=0;l<y;l++)h=l*s,b[l]=t.slice(h,h+s);var S=(l-1)*s+s;for(f=0;f<d;f++)h=S+f*a,b[l+f]=t.slice(h,h+a);return b}function Jx(r,t,e){if(t===0)return 0;var n=e.length,s=r+1,a=n/s|0,h=a+1,l=n-a*s,f=s-l;if(t<=f-1)return t*a;var d=t-f;return f*a+d*h}function md(r,t,e,n,s,a){var h=s-e,l=s+e,f=r-e,d=s+t-f,y=s+t+f,b=n-a;return[Math.max(0,h,d),Math.min(l,y,b)]}function gd(r,t,e,n,s,a){var h=t.length,l=h-e,f=md(r,l,n,h,s,a),d=f[0],y=f[1],b="",S=[],C,A,I;for(A=d,I=y+1;A<I;A++)C=t.slice(A,A+a),C!==b&&(S.push(C),b=C);return S}function Ct(r,t){if(typeof r!="function")throw new Error("mnemonist/passjoin-index: `levenshtein` should be a function returning edit distance between two strings.");if(typeof t!="number"||t<1)throw new Error("mnemonist/passjoin-index: `k` should be a number > 0");this.levenshtein=r,this.k=t,this.clear()}Ct.prototype.clear=function(){this.size=0,this.strings=[],this.invertedIndices={}};Ct.prototype.add=function(r){var t=r.length,e=this.size;this.strings.push(r),this.size++;var n=dd(this.k,r),s=this.invertedIndices[t];typeof s=="undefined"&&(s={},this.invertedIndices[t]=s);var a,h,l,f,d;for(f=0,d=n.length;f<d;f++)a=n[f],l=a+f,h=s[l],typeof h=="undefined"?(h=[e],s[l]=h):h.push(e);return this};Ct.prototype.search=function(r){var t=r.length,e=this.k,n=new Set,s,a,h,l,f,d,y,b,S,C,A,I,F,B,j;for(b=Math.max(0,t-e),S=t+e+1;b<S;b++){var Z=this.invertedIndices[b];if(typeof Z!="undefined"){for(y=pd(e,b),C=0,A=y.length;C<A;C++)for(h=y[C][0],l=y[C][1],d=gd(e,r,b,C,h,l),d.length||(d=[""]),I=0,F=d.length;I<F;I++)if(f=d[I]+C,s=Z[f],typeof s!="undefined")for(B=0,j=s.length;B<j;B++)a=this.strings[s[B]],(t<=e&&b<=e||!n.has(a)&&this.levenshtein(r,a)<=e)&&n.add(a)}}return n};Ct.prototype.forEach=function(r,t){t=arguments.length>1?t:this;for(var e=0,n=this.strings.length;e<n;e++)r.call(t,this.strings[e],e,this)};Ct.prototype.values=function(){var r=this.strings,t=r.length,e=0;return new $x(function(){if(e>=t)return{done:!0};var n=r[e];return e++,{value:n,done:!1}})};typeof Symbol!="undefined"&&(Ct.prototype[Symbol.iterator]=Ct.prototype.values);Ct.prototype.inspect=function(){var r=this.strings.slice();return Object.defineProperty(r,"constructor",{value:Ct,enumerable:!1}),r};typeof Symbol!="undefined"&&(Ct.prototype[Symbol.for("nodejs.util.inspect.custom")]=Ct.prototype.inspect);Ct.from=function(r,t,e){var n=new Ct(t,e);return Qx(r,function(s){n.add(s)}),n};Ct.countKeys=Kx;Ct.comparator=Xx;Ct.partition=pd;Ct.segments=dd;Ct.segmentPos=Jx;Ct.multiMatchAwareInterval=md;Ct.multiMatchAwareSubstrings=gd;yd.exports=Ct});var Pd=N((VO,Td)=>{var bd=Vt(),Zx=dt();function _t(){this.clear()}_t.prototype.clear=function(){this.items=[],this.offset=0,this.size=0};_t.prototype.enqueue=function(r){return this.items.push(r),++this.size};_t.prototype.dequeue=function(){if(this.size){var r=this.items[this.offset];return++this.offset*2>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,r}};_t.prototype.peek=function(){if(this.size)return this.items[this.offset]};_t.prototype.forEach=function(r,t){t=arguments.length>1?t:this;for(var e=this.offset,n=0,s=this.items.length;e<s;e++,n++)r.call(t,this.items[e],n,this)};_t.prototype.toArray=function(){return this.items.slice(this.offset)};_t.prototype.values=function(){var r=this.items,t=this.offset;return new bd(function(){if(t>=r.length)return{done:!0};var e=r[t];return t++,{value:e,done:!1}})};_t.prototype.entries=function(){var r=this.items,t=this.offset,e=0;return new bd(function(){if(t>=r.length)return{done:!0};var n=r[t];return t++,{value:[e++,n],done:!1}})};typeof Symbol!="undefined"&&(_t.prototype[Symbol.iterator]=_t.prototype.values);_t.prototype.toString=function(){return this.toArray().join(",")};_t.prototype.toJSON=function(){return this.toArray()};_t.prototype.inspect=function(){var r=this.toArray();return Object.defineProperty(r,"constructor",{value:_t,enumerable:!1}),r};typeof Symbol!="undefined"&&(_t.prototype[Symbol.for("nodejs.util.inspect.custom")]=_t.prototype.inspect);_t.from=function(r){var t=new _t;return Zx(r,function(e){t.enqueue(e)}),t};_t.of=function(){return _t.from(arguments)};Td.exports=_t});var Sd=N((GO,xd)=>{var wd=Vt(),tS=dt();function Lt(){this.clear()}Lt.prototype.clear=function(){this.items=[],this.size=0};Lt.prototype.push=function(r){return this.items.push(r),++this.size};Lt.prototype.pop=function(){if(this.size!==0)return this.size--,this.items.pop()};Lt.prototype.peek=function(){return this.items[this.size-1]};Lt.prototype.forEach=function(r,t){t=arguments.length>1?t:this;for(var e=0,n=this.items.length;e<n;e++)r.call(t,this.items[n-e-1],e,this)};Lt.prototype.toArray=function(){for(var r=new Array(this.size),t=this.size-1,e=this.size;e--;)r[e]=this.items[t-e];return r};Lt.prototype.values=function(){var r=this.items,t=r.length,e=0;return new wd(function(){if(e>=t)return{done:!0};var n=r[t-e-1];return e++,{value:n,done:!1}})};Lt.prototype.entries=function(){var r=this.items,t=r.length,e=0;return new wd(function(){if(e>=t)return{done:!0};var n=r[t-e-1];return{value:[e++,n],done:!1}})};typeof Symbol!="undefined"&&(Lt.prototype[Symbol.iterator]=Lt.prototype.values);Lt.prototype.toString=function(){return this.toArray().join(",")};Lt.prototype.toJSON=function(){return this.toArray()};Lt.prototype.inspect=function(){var r=this.toArray();return Object.defineProperty(r,"constructor",{value:Lt,enumerable:!1}),r};typeof Symbol!="undefined"&&(Lt.prototype[Symbol.for("nodejs.util.inspect.custom")]=Lt.prototype.inspect);Lt.from=function(r){var t=new Lt;return tS(r,function(e){t.push(e)}),t};Lt.of=function(){return Lt.from(arguments)};xd.exports=Lt});var Cd=N(Ft=>{Ft.intersection=function(){if(arguments.length<2)throw new Error("mnemonist/Set.intersection: needs at least two arguments.");var r=new Set,t=1/0,e=null,n,s,a=arguments.length;for(s=0;s<a;s++){if(n=arguments[s],n.size===0)return r;n.size<t&&(t=n.size,e=n)}for(var h=e.values(),l,f,d,y;l=h.next(),!l.done;){for(f=l.value,d=!0,s=0;s<a;s++)if(y=arguments[s],y!==e&&!y.has(f)){d=!1;break}d&&r.add(f)}return r};Ft.union=function(){if(arguments.length<2)throw new Error("mnemonist/Set.union: needs at least two arguments.");var r=new Set,t,e=arguments.length,n,s;for(t=0;t<e;t++)for(n=arguments[t].values();s=n.next(),!s.done;)r.add(s.value);return r};Ft.difference=function(r,t){if(!r.size)return new Set;if(!t.size)return new Set(r);for(var e=new Set,n=r.values(),s;s=n.next(),!s.done;)t.has(s.value)||e.add(s.value);return e};Ft.symmetricDifference=function(r,t){for(var e=new Set,n=r.values(),s;s=n.next(),!s.done;)t.has(s.value)||e.add(s.value);for(n=t.values();s=n.next(),!s.done;)r.has(s.value)||e.add(s.value);return e};Ft.isSubset=function(r,t){var e=r.values(),n;if(r===t)return!0;if(r.size>t.size)return!1;for(;n=e.next(),!n.done;)if(!t.has(n.value))return!1;return!0};Ft.isSuperset=function(r,t){return Ft.isSubset(t,r)};Ft.add=function(r,t){for(var e=t.values(),n;n=e.next(),!n.done;)r.add(n.value)};Ft.subtract=function(r,t){for(var e=t.values(),n;n=e.next(),!n.done;)r.delete(n.value)};Ft.intersect=function(r,t){for(var e=r.values(),n;n=e.next(),!n.done;)t.has(n.value)||r.delete(n.value)};Ft.disjunct=function(r,t){for(var e=r.values(),n,s=[];n=e.next(),!n.done;)t.has(n.value)&&s.push(n.value);for(e=t.values();n=e.next(),!n.done;)r.has(n.value)||r.add(n.value);for(var a=0,h=s.length;a<h;a++)r.delete(s[a])};Ft.intersectionSize=function(r,t){var e;if(r.size>t.size&&(e=r,r=t,t=e),r.size===0)return 0;if(r===t)return r.size;for(var n=r.values(),s,a=0;s=n.next(),!s.done;)t.has(s.value)&&a++;return a};Ft.unionSize=function(r,t){var e=Ft.intersectionSize(r,t);return r.size+t.size-e};Ft.jaccard=function(r,t){var e=Ft.intersectionSize(r,t);if(e===0)return 0;var n=r.size+t.size-e;return e/n};Ft.overlap=function(r,t){var e=Ft.intersectionSize(r,t);return e===0?0:e/Math.min(r.size,t.size)}});var Ld=N((jO,_d)=>{var eS=Vt(),rS=oe().getPointerArray;function Se(r){var t=rS(r);this.start=0,this.size=0,this.capacity=r,this.dense=new t(r),this.sparse=new t(r)}Se.prototype.clear=function(){this.start=0,this.size=0};Se.prototype.has=function(r){if(this.size===0)return!1;var t=this.sparse[r],e=t<this.capacity&&t>=this.start&&t<this.start+this.size||t<(this.start+this.size)%this.capacity;return e&&this.dense[t]===r};Se.prototype.enqueue=function(r){var t=this.sparse[r];if(this.size!==0){var e=t<this.capacity&&t>=this.start&&t<this.start+this.size||t<(this.start+this.size)%this.capacity;if(e&&this.dense[t]===r)return this}return t=(this.start+this.size)%this.capacity,this.dense[t]=r,this.sparse[r]=t,this.size++,this};Se.prototype.dequeue=function(){if(this.size!==0){var r=this.start;this.size--,this.start++,this.start===this.capacity&&(this.start=0);var t=this.dense[r];return this.sparse[t]=this.capacity,t}};Se.prototype.forEach=function(r,t){t=arguments.length>1?t:this;for(var e=this.capacity,n=this.size,s=this.start,a=0;a<n;)r.call(t,this.dense[s],a,this),s++,a++,s===e&&(s=0)};Se.prototype.values=function(){var r=this.dense,t=this.capacity,e=this.size,n=this.start,s=0;return new eS(function(){if(s>=e)return{done:!0};var a=r[n];return n++,s++,n===t&&(n=0),{value:a,done:!1}})};typeof Symbol!="undefined"&&(Se.prototype[Symbol.iterator]=Se.prototype.values);Se.prototype.inspect=function(){var r=[];return this.forEach(function(t){r.push(t)}),Object.defineProperty(r,"constructor",{value:Se,enumerable:!1}),r.capacity=this.capacity,r};typeof Symbol!="undefined"&&(Se.prototype[Symbol.for("nodejs.util.inspect.custom")]=Se.prototype.inspect);_d.exports=Se});var Od=N((BO,Ed)=>{var Xu=Vt(),iS=oe().getPointerArray;function Jt(r,t){arguments.length<2&&(t=r,r=Array);var e=iS(t);this.size=0,this.length=t,this.dense=new e(t),this.sparse=new e(t),this.vals=new r(t)}Jt.prototype.clear=function(){this.size=0};Jt.prototype.has=function(r){var t=this.sparse[r];return t<this.size&&this.dense[t]===r};Jt.prototype.get=function(r){var t=this.sparse[r];if(t<this.size&&this.dense[t]===r)return this.vals[t]};Jt.prototype.set=function(r,t){var e=this.sparse[r];return e<this.size&&this.dense[e]===r?(this.vals[e]=t,this):(this.dense[this.size]=r,this.sparse[r]=this.size,this.vals[this.size]=t,this.size++,this)};Jt.prototype.delete=function(r){var t=this.sparse[r];return t>=this.size||this.dense[t]!==r?!1:(t=this.dense[this.size-1],this.dense[this.sparse[r]]=t,this.sparse[t]=this.sparse[r],this.size--,!0)};Jt.prototype.forEach=function(r,t){t=arguments.length>1?t:this;for(var e=0;e<this.size;e++)r.call(t,this.vals[e],this.dense[e])};Jt.prototype.keys=function(){var r=this.size,t=this.dense,e=0;return new Xu(function(){if(e<r){var n=t[e];return e++,{value:n}}return{done:!0}})};Jt.prototype.values=function(){var r=this.size,t=this.vals,e=0;return new Xu(function(){if(e<r){var n=t[e];return e++,{value:n}}return{done:!0}})};Jt.prototype.entries=function(){var r=this.size,t=this.dense,e=this.vals,n=0;return new Xu(function(){if(n<r){var s=[t[n],e[n]];return n++,{value:s}}return{done:!0}})};typeof Symbol!="undefined"&&(Jt.prototype[Symbol.iterator]=Jt.prototype.entries);Jt.prototype.inspect=function(){for(var r=new Map,t=0;t<this.size;t++)r.set(this.dense[t],this.vals[t]);return Object.defineProperty(r,"constructor",{value:Jt,enumerable:!1}),r.length=this.length,this.vals.constructor!==Array&&(r.type=this.vals.constructor.name),r};typeof Symbol!="undefined"&&(Jt.prototype[Symbol.for("nodejs.util.inspect.custom")]=Jt.prototype.inspect);Ed.exports=Jt});var Id=N((HO,Ad)=>{var nS=Vt(),oS=oe().getPointerArray;function Ce(r){var t=oS(r);this.size=0,this.length=r,this.dense=new t(r),this.sparse=new t(r)}Ce.prototype.clear=function(){this.size=0};Ce.prototype.has=function(r){var t=this.sparse[r];return t<this.size&&this.dense[t]===r};Ce.prototype.add=function(r){var t=this.sparse[r];return t<this.size&&this.dense[t]===r?this:(this.dense[this.size]=r,this.sparse[r]=this.size,this.size++,this)};Ce.prototype.delete=function(r){var t=this.sparse[r];return t>=this.size||this.dense[t]!==r?!1:(t=this.dense[this.size-1],this.dense[this.sparse[r]]=t,this.sparse[t]=this.sparse[r],this.size--,!0)};Ce.prototype.forEach=function(r,t){t=arguments.length>1?t:this;for(var e,n=0;n<this.size;n++)e=this.dense[n],r.call(t,e,e)};Ce.prototype.values=function(){var r=this.size,t=this.dense,e=0;return new nS(function(){if(e<r){var n=t[e];return e++,{value:n}}return{done:!0}})};typeof Symbol!="undefined"&&(Ce.prototype[Symbol.iterator]=Ce.prototype.values);Ce.prototype.inspect=function(){for(var r=new Set,t=0;t<this.size;t++)r.add(this.dense[t]);return Object.defineProperty(r,"constructor",{value:Ce,enumerable:!1}),r.length=this.length,r};typeof Symbol!="undefined"&&(Ce.prototype[Symbol.for("nodejs.util.inspect.custom")]=Ce.prototype.inspect);Ad.exports=Ce});var Rd=N((WO,Fd)=>{var sS=dt(),aS=2,uS=2,hS=new Set([0,1,2]),cS={0:"Returns only the top suggestion",1:"Returns suggestions with the smallest edit distance",2:"Returns every suggestion (no early termination)"};function Ls(r){var t=new Set;return typeof r=="number"&&t.add(r),{suggestions:t,count:0}}function Dd(r,t,e){return{term:r||"",distance:t||0,count:e||0}}function kd(r,t,e,n){n=n||new Set,t++;var s,a=r.length,h;if(a>1)for(h=0;h<a;h++)s=r.substring(0,h)+r.substring(h+1),n.has(s)||(n.add(s),t<e&&kd(s,t,e,n));return n}function lS(r,t,e,n,s,a){var h=e.suggestions.values().next().value;t<2&&e.suggestions.size>0&&r[h].length-a.length>n.length-a.length&&(e.suggestions=new Set,e.count=0),(t===2||!e.suggestions.size||r[h].length-a.length>=n.length-a.length)&&e.suggestions.add(s)}function Md(r,t){var e=r.length,n=t.length,s=[[]],a=e+n,h=new Map,l,f,d;for(s[0][0]=a,l=0;l<=e;l++)s[l+1]||(s[l+1]=[]),s[l+1][1]=l,s[l+1][0]=a;for(d=0;d<=n;d++)s[1][d+1]=d,s[0][d+1]=a;var y=r+t,b;for(l=0,f=y.length;l<f;l++)b=y[l],h.has(b)||h.set(b,0);for(l=1;l<=e;l++){var S=0;for(d=1;d<=n;d++){var C=h.get(t[d-1]),A=S;r[l-1]===t[d-1]?(s[l+1][d+1]=s[l][d],S=d):s[l+1][d+1]=Math.min(s[l][d],s[l+1][d],s[l][d+1])+1,s[l+1][d+1]=Math.min(s[l+1][d+1],s[C][A]+(l-C-1)+1+(d-A-1))}h.set(r[l-1],l)}return s[e+1][n+1]}function fS(r,t,e,n,s,a){var h=a.length;if(h-n>s)return[];for(var l=[a],f=new Set,d=new Set,y=[],b,S;l.length>0&&(b=l.shift(),!(e<2&&y.length>0&&h-b.length>y[0].distance));){if(S=r[b],S!==void 0){if(typeof S=="number"&&(S=Ls(S)),S.count>0&&!d.has(b)){d.add(b);var C=Dd(b,h-b.length,S.count);if(y.push(C),e<2&&h-b.length===0)break}S.suggestions.forEach(B=>{var j=t[B];if(!d.has(j)){d.add(j);var Z=0;if(a!==j)if(j.length===b.length)Z=h-b.length;else if(h===b.length)Z=j.length-b.length;else{for(var ht=0,Ot=0,Ne=j.length;ht<Ne&&ht<h&&j[ht]===a[ht];)ht++;for(;Ot<Ne-ht&&Ot<h&&j[Ne-Ot-1]===a[h-Ot-1];)Ot++;ht>0||Ot>0?Z=Md(j.substr(ht,Ne-ht-Ot),a.substr(ht,h-ht-Ot)):Z=Md(j,a)}if(e<2&&y.length>0&&y[0].distance>Z&&(y=[]),!(e<2&&y.length>0&&Z>y[0].distance)&&Z<=n){var _e=r[j];_e!==void 0&&y.push(Dd(j,Z,_e.count))}}})}if(h-b.length<n){if(e<2&&y.length>0&&h-b.length>=y[0].distance)continue;for(var A=0,I=b.length;A<I;A++){var F=b.substring(0,A)+b.substring(A+1);f.has(F)||(f.add(F),l.push(F))}}}return e===0?y.slice(0,1):y}function dr(r){if(r=r||{},this.clear(),this.maxDistance=typeof r.maxDistance=="number"?r.maxDistance:aS,this.verbosity=typeof r.verbosity=="number"?r.verbosity:uS,typeof this.maxDistance!="number"||this.maxDistance<=0)throw Error("mnemonist/SymSpell.constructor: invalid `maxDistance` option. Should be a integer greater than 0.");if(!hS.has(this.verbosity))throw Error("mnemonist/SymSpell.constructor: invalid `verbosity` option. Should be either 0, 1 or 2.")}dr.prototype.clear=function(){this.size=0,this.dictionary=Object.create(null),this.maxLength=0,this.words=[]};dr.prototype.add=function(r){var t=this.dictionary[r];if(t!==void 0?(typeof t=="number"&&(t=Ls(t),this.dictionary[r]=t),t.count++):(t=Ls(),t.count++,this.dictionary[r]=t,r.length>this.maxLength&&(this.maxLength=r.length)),t.count===1){var e=this.words.length;this.words.push(r);var n=kd(r,0,this.maxDistance);n.forEach(s=>{var a=this.dictionary[s];a!==void 0?(typeof a=="number"&&(a=Ls(a),this.dictionary[s]=a),a.suggestions.has(e)||lS(this.words,this.verbosity,a,r,e,s)):this.dictionary[s]=e})}return this.size++,this};dr.prototype.search=function(r){return fS(this.dictionary,this.words,this.verbosity,this.maxDistance,this.maxLength,r)};dr.prototype.inspect=function(){var r=[];r.size=this.size,r.maxDistance=this.maxDistance,r.verbosity=this.verbosity,r.behavior=cS[this.verbosity];for(var t in this.dictionary)typeof this.dictionary[t]=="object"&&this.dictionary[t].count&&r.push([t,this.dictionary[t].count]);return Object.defineProperty(r,"constructor",{value:dr,enumerable:!1}),r};typeof Symbol!="undefined"&&(dr.prototype[Symbol.for("nodejs.util.inspect.custom")]=dr.prototype.inspect);dr.from=function(r,t){var e=new dr(t);return sS(r,function(n){e.add(n)}),e};Fd.exports=dr});var Ju=N((qO,zd)=>{var pS=dt(),$i=Vt(),Ut=String.fromCharCode(0);function vt(r){this.mode=r===Array?"array":"string",this.clear()}vt.prototype.clear=function(){this.root={},this.size=0};vt.prototype.set=function(r,t){for(var e=this.root,n,s=0,a=r.length;s<a;s++)n=r[s],e=e[n]||(e[n]={});return Ut in e||this.size++,e[Ut]=t,this};vt.prototype.update=function(r,t){for(var e=this.root,n,s=0,a=r.length;s<a;s++)n=r[s],e=e[n]||(e[n]={});return Ut in e||this.size++,e[Ut]=t(e[Ut]),this};vt.prototype.get=function(r){var t=this.root,e,n,s;for(n=0,s=r.length;n<s;n++)if(e=r[n],t=t[e],typeof t=="undefined")return;if(Ut in t)return t[Ut]};vt.prototype.delete=function(r){var t=this.root,e=null,n=null,s,a,h,l;for(h=0,l=r.length;h<l;h++){if(a=r[h],s=t,t=t[a],typeof t=="undefined")return!1;e!==null?Object.keys(t).length>1&&(e=null,n=null):Object.keys(t).length<2&&(e=s,n=a)}return Ut in t?(this.size--,e?delete e[n]:delete t[Ut],!0):!1};vt.prototype.has=function(r){for(var t=this.root,e,n=0,s=r.length;n<s;n++)if(e=r[n],t=t[e],typeof t=="undefined")return!1;return Ut in t};vt.prototype.find=function(r){var t=typeof r=="string",e=this.root,n=[],s,a,h;for(a=0,h=r.length;a<h;a++)if(s=r[a],e=e[s],typeof e=="undefined")return n;for(var l=[e],f=[r],d;l.length;){r=f.pop(),e=l.pop();for(d in e){if(d===Ut){n.push([r,e[Ut]]);continue}l.push(e[d]),f.push(t?r+d:r.concat(d))}}return n};vt.prototype.values=function(r){var t=this.root,e=[],n,s,a;if(r){for(s=0,a=r.length;s<a;s++)if(n=r[s],t=t[n],typeof t=="undefined")return $i.empty()}return e.push(t),new $i(function(){for(var h,l=!1,f;e.length;){h=e.pop();for(f in h){if(f===Ut){l=!0;continue}e.push(h[f])}if(l)return{done:!1,value:h[Ut]}}return{done:!0}})};vt.prototype.prefixes=function(r){var t=this.root,e=[],n=[],s,a,h,l=this.mode==="string";if(r){for(a=0,h=r.length;a<h;a++)if(s=r[a],t=t[s],typeof t=="undefined")return $i.empty()}else r=l?"":[];return e.push(t),n.push(r),new $i(function(){for(var f,d,y=!1,b;e.length;){f=e.pop(),d=n.pop();for(b in f){if(b===Ut){y=!0;continue}e.push(f[b]),n.push(l?d+b:d.concat(b))}if(y)return{done:!1,value:d}}return{done:!0}})};vt.prototype.keys=vt.prototype.prefixes;vt.prototype.entries=function(r){var t=this.root,e=[],n=[],s,a,h,l=this.mode==="string";if(r){for(a=0,h=r.length;a<h;a++)if(s=r[a],t=t[s],typeof t=="undefined")return $i.empty()}else r=l?"":[];return e.push(t),n.push(r),new $i(function(){for(var f,d,y=!1,b;e.length;){f=e.pop(),d=n.pop();for(b in f){if(b===Ut){y=!0;continue}e.push(f[b]),n.push(l?d+b:d.concat(b))}if(y)return{done:!1,value:[d,f[Ut]]}}return{done:!0}})};typeof Symbol!="undefined"&&(vt.prototype[Symbol.iterator]=vt.prototype.entries);vt.prototype.inspect=function(){for(var r=new Array(this.size),t=this.entries(),e,n=0;e=t.next(),!e.done;)r[n++]=e.value;return Object.defineProperty(r,"constructor",{value:vt,enumerable:!1}),r};typeof Symbol!="undefined"&&(vt.prototype[Symbol.for("nodejs.util.inspect.custom")]=vt.prototype.inspect);vt.prototype.toJSON=function(){return this.root};vt.from=function(r){var t=new vt;return pS(r,function(e,n){t.set(n,e)}),t};vt.SENTINEL=Ut;zd.exports=vt});var Gd=N(($O,Vd)=>{var dS=dt(),Nd=Ju(),Es=String.fromCharCode(0);function jt(r){this.mode=r===Array?"array":"string",this.clear()}for(Zu in Nd.prototype)jt.prototype[Zu]=Nd.prototype[Zu];var Zu;delete jt.prototype.set;delete jt.prototype.get;delete jt.prototype.values;delete jt.prototype.entries;jt.prototype.add=function(r){for(var t=this.root,e,n=0,s=r.length;n<s;n++)e=r[n],t=t[e]||(t[e]={});return Es in t||this.size++,t[Es]=!0,this};jt.prototype.find=function(r){var t=typeof r=="string",e=this.root,n=[],s,a,h;for(a=0,h=r.length;a<h;a++)if(s=r[a],e=e[s],typeof e=="undefined")return n;for(var l=[e],f=[r],d;l.length;){r=f.pop(),e=l.pop();for(d in e){if(d===Es){n.push(r);continue}l.push(e[d]),f.push(t?r+d:r.concat(d))}}return n};typeof Symbol!="undefined"&&(jt.prototype[Symbol.iterator]=jt.prototype.keys);jt.prototype.inspect=function(){for(var r=new Set,t=this.keys(),e;e=t.next(),!e.done;)r.add(e.value);return Object.defineProperty(r,"constructor",{value:jt,enumerable:!1}),r};typeof Symbol!="undefined"&&(jt.prototype[Symbol.for("nodejs.util.inspect.custom")]=jt.prototype.inspect);jt.prototype.toJSON=function(){return this.root};jt.from=function(r){var t=new jt;return dS(r,function(e){t.add(e)}),t};jt.SENTINEL=Es;Vd.exports=jt});var Hd=N((QO,Bd)=>{var Ud=Vt(),mS=dt(),gS=de(),jd=oe(),yS=function(r){return Math.max(1,Math.ceil(r*1.5))},vS=function(r){var t=jd.getPointerArray(r);return new t(r)};function J(r,t){if(arguments.length<1)throw new Error("mnemonist/vector: expecting at least a byte array constructor.");var e=t||0,n=yS,s=0,a=!1;typeof t=="object"&&(e=t.initialCapacity||0,s=t.initialLength||0,n=t.policy||n,a=t.factory===!0),this.factory=a?r:null,this.ArrayClass=r,this.length=s,this.capacity=Math.max(s,e),this.policy=n,this.array=new r(this.capacity)}J.prototype.set=function(r,t){if(this.length<r)throw new Error("Vector("+this.ArrayClass.name+").set: index out of bounds.");return this.array[r]=t,this};J.prototype.get=function(r){if(!(this.length<r))return this.array[r]};J.prototype.applyPolicy=function(r){var t=this.policy(r||this.capacity);if(typeof t!="number"||t<0)throw new Error("mnemonist/vector.applyPolicy: policy returned an invalid value (expecting a positive integer).");if(t<=this.capacity)throw new Error("mnemonist/vector.applyPolicy: policy returned a less or equal capacity to allocate.");return t};J.prototype.reallocate=function(r){if(r===this.capacity)return this;var t=this.array;if(r<this.length&&(this.length=r),r>this.capacity)if(this.factory===null?this.array=new this.ArrayClass(r):this.array=this.factory(r),jd.isTypedArray(this.array))this.array.set(t,0);else for(var e=0,n=this.length;e<n;e++)this.array[e]=t[e];else this.array=t.slice(0,r);return this.capacity=r,this};J.prototype.grow=function(r){var t;if(typeof r=="number"){if(this.capacity>=r)return this;for(t=this.capacity;t<r;)t=this.applyPolicy(t);return this.reallocate(t),this}return t=this.applyPolicy(),this.reallocate(t),this};J.prototype.resize=function(r){return r===this.length?this:r<this.length?(this.length=r,this):(this.length=r,this.reallocate(r),this)};J.prototype.push=function(r){return this.capacity===this.length&&this.grow(),this.array[this.length++]=r,this.length};J.prototype.pop=function(){if(this.length!==0)return this.array[--this.length]};J.prototype.values=function(){var r=this.array,t=this.length,e=0;return new Ud(function(){if(e>=t)return{done:!0};var n=r[e];return e++,{value:n,done:!1}})};J.prototype.entries=function(){var r=this.array,t=this.length,e=0;return new Ud(function(){if(e>=t)return{done:!0};var n=r[e];return{value:[e++,n],done:!1}})};typeof Symbol!="undefined"&&(J.prototype[Symbol.iterator]=J.prototype.values);J.prototype.inspect=function(){var r=this.array.slice(0,this.length);return r.type=this.array.constructor.name,r.items=this.length,r.capacity=this.capacity,Object.defineProperty(r,"constructor",{value:J,enumerable:!1}),r};typeof Symbol!="undefined"&&(J.prototype[Symbol.for("nodejs.util.inspect.custom")]=J.prototype.inspect);J.from=function(r,t,e){if(arguments.length<3&&(e=gS.guessLength(r),typeof e!="number"))throw new Error("mnemonist/vector.from: could not guess iterable length. Please provide desired capacity as last argument.");var n=new J(t,e);return mS(r,function(s){n.push(s)}),n};function mr(r){var t=function(n){J.call(this,r,n)};for(var e in J.prototype)J.prototype.hasOwnProperty(e)&&(t.prototype[e]=J.prototype[e]);return t.from=function(n,s){return J.from(n,r,s)},typeof Symbol!="undefined"&&(t.prototype[Symbol.iterator]=t.prototype.values),t}J.Int8Vector=mr(Int8Array);J.Uint8Vector=mr(Uint8Array);J.Uint8ClampedVector=mr(Uint8ClampedArray);J.Int16Vector=mr(Int16Array);J.Uint16Vector=mr(Uint16Array);J.Int32Vector=mr(Int32Array);J.Uint32Vector=mr(Uint32Array);J.Float32Vector=mr(Float32Array);J.Float64Vector=mr(Float64Array);J.PointerVector=mr(vS);Bd.exports=J});var qd=N((YO,Wd)=>{var bS=de(),TS=oe(),PS=Wu().inplaceQuickSortIndices,wS=Bu().lowerBoundIndices,xS=ws(),SS=TS.getPointerArray;function CS(r,t){return r.distance<t.distance?1:r.distance>t.distance?-1:0}function _S(r,t,e){for(var n=e.length,s=SS(n),a=0,h=new s(n),l=new s(n),f=new s(n),d=new Float64Array(n),y=[0,0,n],b=new Float64Array(n),S,C,A,I,F,B,j,Z,ht;y.length;)if(F=y.pop(),I=y.pop(),S=y.pop(),C=e[F-1],F--,ht=F-I,h[S]=C,ht!==0){if(ht===1){j=r(t[C],t[e[I]]),d[S]=j,a++,f[S]=a,h[a]=e[I];continue}for(Z=I;Z<F;Z++)b[e[Z]]=r(t[C],t[e[Z]]);PS(b,e,I,F),A=I+ht/2-1,A===(A|0)?j=(b[e[A]]+b[e[A+1]])/2:j=b[e[Math.ceil(A)]],d[S]=j,B=wS(b,e,j,I,F),F-B>0&&(a++,f[S]=a,y.push(a,B,F)),B-I>0&&(a++,l[S]=a,y.push(a,I,B))}return{nodes:h,lefts:l,rights:f,mus:d}}function Er(r,t){if(typeof r!="function")throw new Error("mnemonist/VPTree.constructor: given `distance` must be a function.");if(!t)throw new Error("mnemonist/VPTree.constructor: you must provide items to the tree. A VPTree cannot be updated after its creation.");this.distance=r,this.heap=new xS(CS),this.D=0;var e=bS.toArrayWithIndices(t);this.items=e[0];var n=e[1];this.size=n.length;var s=_S(r,this.items,n);this.nodes=s.nodes,this.lefts=s.lefts,this.rights=s.rights,this.mus=s.mus}Er.prototype.nearestNeighbors=function(r,t){var e=this.heap,n=[0],s=1/0,a,h,l,f,d,y,b;for(this.D=0;n.length;)a=n.pop(),h=this.nodes[a],l=this.items[h],b=this.distance(l,t),this.D++,b<s&&(e.push({distance:b,item:l}),e.size>r&&e.pop(),e.size>=r&&(s=e.peek().distance)),f=this.lefts[a],d=this.rights[a],!(!f&&!d)&&(y=this.mus[a],b<y?(f&&b<y+s&&n.push(f),d&&b>=y-s&&n.push(d)):(d&&b>=y-s&&n.push(d),f&&b<y+s&&n.push(f)));for(var S=new Array(e.size),C=e.size-1;C>=0;C--)S[C]=e.pop();return S};Er.prototype.neighbors=function(r,t){var e=[],n=[0],s,a,h,l,f,d,y;for(this.D=0;n.length;)s=n.pop(),a=this.nodes[s],h=this.items[a],y=this.distance(h,t),this.D++,y<=r&&e.push({distance:y,item:h}),l=this.lefts[s],f=this.rights[s],!(!l&&!f)&&(d=this.mus[s],y<d?(l&&y<d+r&&n.push(l),f&&y>=d-r&&n.push(f)):(f&&y>=d-r&&n.push(f),l&&y<d+r&&n.push(l)));return e};Er.prototype.inspect=function(){var r=this.items.slice();return Object.defineProperty(r,"constructor",{value:Er,enumerable:!1}),r};typeof Symbol!="undefined"&&(Er.prototype[Symbol.for("nodejs.util.inspect.custom")]=Er.prototype.inspect);Er.from=function(r,t){return new Er(t,r)};Wd.exports=Er});var Yd=N((KO,Qd)=>{var th=ws(),eh=ds(),$d=Wf();Qd.exports={BiMap:Kf(),BitSet:ip(),BitVector:ap(),BloomFilter:pp(),BKTree:mp(),CircularBuffer:Tp(),DefaultMap:wp(),DefaultWeakMap:Sp(),FixedDeque:ku(),StaticDisjointSet:_p(),FibonacciHeap:eh,MinFibonacciHeap:eh.MinFibonacciHeap,MaxFibonacciHeap:eh.MaxFibonacciHeap,FixedReverseHeap:xs(),FuzzyMap:Dp(),FuzzyMultiMap:Rp(),HashedArrayTree:Vp(),Heap:th,MinHeap:th.MinHeap,MaxHeap:th.MaxHeap,StaticIntervalTree:Bp(),InvertedIndex:Kp(),KDTree:ed(),LinkedList:nd(),LRUCache:_s(),LRUCacheWithDelete:ad(),LRUMap:Yu(),LRUMapWithDelete:cd(),MultiMap:Vu(),MultiSet:fd(),PassjoinIndex:vd(),Queue:Pd(),FixedStack:Uu(),Stack:Sd(),SuffixArray:$d,GeneralizedSuffixArray:$d.GeneralizedSuffixArray,Set:Cd(),SparseQueueSet:Ld(),SparseMap:Od(),SparseSet:Id(),SymSpell:Rd(),Trie:Gd(),TrieMap:Ju(),Vector:Hd(),VPTree:qd()}});var D=class r{static get ZERO(){return new r(0,0)}static get ONE(){return new r(1,1)}static get UP(){return new r(0,-1)}static get DOWN(){return new r(0,1)}static get LEFT(){return new r(-1,0)}static get RIGHT(){return new r(1,0)}static get UP_LEFT(){return new r(-1,-1)}static get UP_RIGHT(){return new r(1,-1)}static get DOWN_RIGHT(){return new r(1,1)}static get DOWN_LEFT(){return new r(-1,1)}constructor(t,e){typeof t=="number"?(this.x=t,this.y=e||0):(this.x=t.x,this.y=t.y)}clone(){return new r(this.x,this.y)}add(t){return new r(this.x+t.x,this.y+t.y)}multiply(t){return new r(this.x*t.x,this.y*t.y)}divide(t){return new r(this.x/t.x,this.y/t.y)}subtract(t){return new r(this.x-t.x,this.y-t.y)}equals(t){return this.x===t.x&&this.y===t.y}abs(){return new r(Math.abs(this.x),Math.abs(this.y))}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}modulo(t){return new r(this.x%t.x,this.y%t.y)}scalarModulo(t){return new r(this.x%t,this.y%t)}scalarMult(t){return new r(this.x*t,this.y*t)}toPosition(){return{x:this.x,y:this.y}}toString(){return`${this.x}#${this.y}`}};var z=class{static equal(t,e){return t.position.x===e.position.x&&t.position.y===e.position.y&&t.layer===e.layer}static copyOver(t,e){e.position.x=t.position.x,e.position.y=t.position.y,e.layer=t.layer}static clone(t){return{position:t.position.clone(),layer:t.layer}}static toString(t){return`${t.position.toString()}#${t.layer}`}static toInternal(t){return{position:new D(t.position.x,t.position.y),layer:t.charLayer}}static fromInternal(t){return{position:t.position.toPosition(),charLayer:t.layer}}};var le=(d=>(d.NONE="none",d.LEFT="left",d.UP_LEFT="up-left",d.UP="up",d.UP_RIGHT="up-right",d.RIGHT="right",d.DOWN_RIGHT="down-right",d.DOWN="down",d.DOWN_LEFT="down-left",d))(le||{}),uw={up:"down",down:"up",left:"right",right:"left",none:"none","up-left":"down-right","up-right":"down-left","down-right":"up-left","down-left":"up-right"},hw={up:D.UP,down:D.DOWN,left:D.LEFT,right:D.RIGHT,none:D.ZERO,"up-left":D.UP_LEFT,"up-right":D.UP_RIGHT,"down-right":D.DOWN_RIGHT,"down-left":D.DOWN_LEFT},wn={up:0,"up-right":1,right:2,"down-right":3,down:4,"down-left":5,left:6,"up-left":7,none:NaN},Kl=["up","up-right","right","down-right","down","down-left","left","up-left"],cw=["down-left","down-right","up-right","up-left"];function xn(){return["up","down","left","right","none","up-left","up-right","down-right","down-left"]}function oi(r){return cw.includes(r)}function lu(r){return["left","right"].includes(r)}function fu(r){return["up","down"].includes(r)}function Xl(r,t=1){return r==="none"?"none":Kl[(wn[r]+8-Math.abs(t)%8)%8]}function Di(r,t=1){return r==="none"?"none":Kl[(wn[r]+t)%8]}function We(r){return hw[r]}function Jl(r){return uw[r]}function re(r,t){if(r.x===t.x){if(r.y>t.y)return"up";if(r.y<t.y)return"down"}else if(r.y===t.y){if(r.x>t.x)return"left";if(r.x<t.x)return"right"}else if(r.x>t.x){if(r.y<t.y)return"down-left";if(r.y>t.y)return"up-left"}else if(r.x<t.x){if(r.y<t.y)return"down-right";if(r.y>t.y)return"up-right"}return"none"}var Gr=(e=>(e[e.FOUR=4]="FOUR",e[e.EIGHT=8]="EIGHT",e))(Gr||{});function Ur(r){return typeof r=="string"&&xn().includes(r)}var pu=function(r,t){return pu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])},pu(r,t)};function jr(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");pu(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function Zl(r,t,e,n){function s(a){return a instanceof e?a:new e(function(h){h(a)})}return new(e||(e=Promise))(function(a,h){function l(y){try{d(n.next(y))}catch(b){h(b)}}function f(y){try{d(n.throw(y))}catch(b){h(b)}}function d(y){y.done?a(y.value):s(y.value).then(l,f)}d((n=n.apply(r,t||[])).next())})}function zo(r,t){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,s,a,h;return h={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function l(d){return function(y){return f([d,y])}}function f(d){if(n)throw new TypeError("Generator is already executing.");for(;h&&(h=0,d[0]&&(e=0)),e;)try{if(n=1,s&&(a=d[0]&2?s.return:d[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,d[1])).done)return a;switch(s=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return e.label++,{value:d[1],done:!1};case 5:e.label++,s=d[1],d=[0];continue;case 7:d=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){e=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){e.label=d[1];break}if(d[0]===6&&e.label<a[1]){e.label=a[1],a=d;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(d);break}a[2]&&e.ops.pop(),e.trys.pop();continue}d=t.call(r,e)}catch(y){d=[6,y],s=0}finally{n=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function _r(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function er(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),s,a=[],h;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)a.push(s.value)}catch(l){h={error:l}}finally{try{s&&!s.done&&(e=n.return)&&e.call(n)}finally{if(h)throw h.error}}return a}function rr(r,t,e){if(e||arguments.length===2)for(var n=0,s=t.length,a;n<s;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return r.concat(a||Array.prototype.slice.call(t))}function si(r){return this instanceof si?(this.v=r,this):new si(r)}function tf(r,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(r,t||[]),s,a=[];return s={},h("next"),h("throw"),h("return"),s[Symbol.asyncIterator]=function(){return this},s;function h(S){n[S]&&(s[S]=function(C){return new Promise(function(A,I){a.push([S,C,A,I])>1||l(S,C)})})}function l(S,C){try{f(n[S](C))}catch(A){b(a[0][3],A)}}function f(S){S.value instanceof si?Promise.resolve(S.value.v).then(d,y):b(a[0][2],S)}function d(S){l("next",S)}function y(S){l("throw",S)}function b(S,C){S(C),a.shift(),a.length&&l(a[0][0],a[0][1])}}function ef(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=r[Symbol.asyncIterator],e;return t?t.call(r):(r=typeof _r=="function"?_r(r):r[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(a){e[a]=r[a]&&function(h){return new Promise(function(l,f){h=r[a](h),s(l,f,h.done,h.value)})}}function s(a,h,l,f){Promise.resolve(f).then(function(d){a({value:d,done:l})},h)}}function tt(r){return typeof r=="function"}function No(r){var t=function(n){Error.call(n),n.stack=new Error().stack},e=r(t);return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var Vo=No(function(r){return function(e){r(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(n,s){return s+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e}});function Sn(r,t){if(r){var e=r.indexOf(t);0<=e&&r.splice(e,1)}}var Mi=function(){function r(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return r.prototype.unsubscribe=function(){var t,e,n,s,a;if(!this.closed){this.closed=!0;var h=this._parentage;if(h)if(this._parentage=null,Array.isArray(h))try{for(var l=_r(h),f=l.next();!f.done;f=l.next()){var d=f.value;d.remove(this)}}catch(I){t={error:I}}finally{try{f&&!f.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}else h.remove(this);var y=this.initialTeardown;if(tt(y))try{y()}catch(I){a=I instanceof Vo?I.errors:[I]}var b=this._finalizers;if(b){this._finalizers=null;try{for(var S=_r(b),C=S.next();!C.done;C=S.next()){var A=C.value;try{rf(A)}catch(I){a=a!=null?a:[],I instanceof Vo?a=rr(rr([],er(a)),er(I.errors)):a.push(I)}}}catch(I){n={error:I}}finally{try{C&&!C.done&&(s=S.return)&&s.call(S)}finally{if(n)throw n.error}}}if(a)throw new Vo(a)}},r.prototype.add=function(t){var e;if(t&&t!==this)if(this.closed)rf(t);else{if(t instanceof r){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(e=this._finalizers)!==null&&e!==void 0?e:[]).push(t)}},r.prototype._hasParent=function(t){var e=this._parentage;return e===t||Array.isArray(e)&&e.includes(t)},r.prototype._addParent=function(t){var e=this._parentage;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t},r.prototype._removeParent=function(t){var e=this._parentage;e===t?this._parentage=null:Array.isArray(e)&&Sn(e,t)},r.prototype.remove=function(t){var e=this._finalizers;e&&Sn(e,t),t instanceof r&&t._removeParent(this)},r.EMPTY=function(){var t=new r;return t.closed=!0,t}(),r}();var du=Mi.EMPTY;function Go(r){return r instanceof Mi||r&&"closed"in r&&tt(r.remove)&&tt(r.add)&&tt(r.unsubscribe)}function rf(r){tt(r)?r():r.unsubscribe()}var qe={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var ki={setTimeout:function(r,t){for(var e=[],n=2;n<arguments.length;n++)e[n-2]=arguments[n];var s=ki.delegate;return s!=null&&s.setTimeout?s.setTimeout.apply(s,rr([r,t],er(e))):setTimeout.apply(void 0,rr([r,t],er(e)))},clearTimeout:function(r){var t=ki.delegate;return((t==null?void 0:t.clearTimeout)||clearTimeout)(r)},delegate:void 0};function Uo(r){ki.setTimeout(function(){var t=qe.onUnhandledError;if(t)t(r);else throw r})}function Cn(){}var nf=function(){return mu("C",void 0,void 0)}();function of(r){return mu("E",void 0,r)}function sf(r){return mu("N",r,void 0)}function mu(r,t,e){return{kind:r,value:t,error:e}}var ai=null;function Fi(r){if(qe.useDeprecatedSynchronousErrorHandling){var t=!ai;if(t&&(ai={errorThrown:!1,error:null}),r(),t){var e=ai,n=e.errorThrown,s=e.error;if(ai=null,n)throw s}}else r()}function af(r){qe.useDeprecatedSynchronousErrorHandling&&ai&&(ai.errorThrown=!0,ai.error=r)}var _n=function(r){jr(t,r);function t(e){var n=r.call(this)||this;return n.isStopped=!1,e?(n.destination=e,Go(e)&&e.add(n)):n.destination=dw,n}return t.create=function(e,n,s){return new Bo(e,n,s)},t.prototype.next=function(e){this.isStopped?yu(sf(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?yu(of(e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?yu(nf,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Mi);var lw=Function.prototype.bind;function gu(r,t){return lw.call(r,t)}var fw=function(){function r(t){this.partialObserver=t}return r.prototype.next=function(t){var e=this.partialObserver;if(e.next)try{e.next(t)}catch(n){jo(n)}},r.prototype.error=function(t){var e=this.partialObserver;if(e.error)try{e.error(t)}catch(n){jo(n)}else jo(t)},r.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(e){jo(e)}},r}(),Bo=function(r){jr(t,r);function t(e,n,s){var a=r.call(this)||this,h;if(tt(e)||!e)h={next:e!=null?e:void 0,error:n!=null?n:void 0,complete:s!=null?s:void 0};else{var l;a&&qe.useDeprecatedNextContext?(l=Object.create(e),l.unsubscribe=function(){return a.unsubscribe()},h={next:e.next&&gu(e.next,l),error:e.error&&gu(e.error,l),complete:e.complete&&gu(e.complete,l)}):h=e}return a.destination=new fw(h),a}return t}(_n);function jo(r){qe.useDeprecatedSynchronousErrorHandling?af(r):Uo(r)}function pw(r){throw r}function yu(r,t){var e=qe.onStoppedNotification;e&&ki.setTimeout(function(){return e(r,t)})}var dw={closed:!0,next:Cn,error:pw,complete:Cn};var Ri=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Ho(r){return r}function vu(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return bu(r)}function bu(r){return r.length===0?Ho:r.length===1?r[0]:function(e){return r.reduce(function(n,s){return s(n)},e)}}var Nt=function(){function r(t){t&&(this._subscribe=t)}return r.prototype.lift=function(t){var e=new r;return e.source=this,e.operator=t,e},r.prototype.subscribe=function(t,e,n){var s=this,a=gw(t)?t:new Bo(t,e,n);return Fi(function(){var h=s,l=h.operator,f=h.source;a.add(l?l.call(a,f):f?s._subscribe(a):s._trySubscribe(a))}),a},r.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.error(e)}},r.prototype.forEach=function(t,e){var n=this;return e=uf(e),new e(function(s,a){var h=new Bo({next:function(l){try{t(l)}catch(f){a(f),h.unsubscribe()}},error:a,complete:s});n.subscribe(h)})},r.prototype._subscribe=function(t){var e;return(e=this.source)===null||e===void 0?void 0:e.subscribe(t)},r.prototype[Ri]=function(){return this},r.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return bu(t)(this)},r.prototype.toPromise=function(t){var e=this;return t=uf(t),new t(function(n,s){var a;e.subscribe(function(h){return a=h},function(h){return s(h)},function(){return n(a)})})},r.create=function(t){return new r(t)},r}();function uf(r){var t;return(t=r!=null?r:qe.Promise)!==null&&t!==void 0?t:Promise}function mw(r){return r&&tt(r.next)&&tt(r.error)&&tt(r.complete)}function gw(r){return r&&r instanceof _n||mw(r)&&Go(r)}function yw(r){return tt(r==null?void 0:r.lift)}function Yt(r){return function(t){if(yw(t))return t.lift(function(e){try{return r(e,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function we(r,t,e,n,s){return new vw(r,t,e,n,s)}var vw=function(r){jr(t,r);function t(e,n,s,a,h,l){var f=r.call(this,e)||this;return f.onFinalize=h,f.shouldUnsubscribe=l,f._next=n?function(d){try{n(d)}catch(y){e.error(y)}}:r.prototype._next,f._error=a?function(d){try{a(d)}catch(y){e.error(y)}finally{this.unsubscribe()}}:r.prototype._error,f._complete=s?function(){try{s()}catch(d){e.error(d)}finally{this.unsubscribe()}}:r.prototype._complete,f}return t.prototype.unsubscribe=function(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;r.prototype.unsubscribe.call(this),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}},t}(_n);var hf=No(function(r){return function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}});var nt=function(r){jr(t,r);function t(){var e=r.call(this)||this;return e.closed=!1,e.currentObservers=null,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return t.prototype.lift=function(e){var n=new cf(this,this);return n.operator=e,n},t.prototype._throwIfClosed=function(){if(this.closed)throw new hf},t.prototype.next=function(e){var n=this;Fi(function(){var s,a;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var h=_r(n.currentObservers),l=h.next();!l.done;l=h.next()){var f=l.value;f.next(e)}}catch(d){s={error:d}}finally{try{l&&!l.done&&(a=h.return)&&a.call(h)}finally{if(s)throw s.error}}}})},t.prototype.error=function(e){var n=this;Fi(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=e;for(var s=n.observers;s.length;)s.shift().error(e)}})},t.prototype.complete=function(){var e=this;Fi(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var n=e.observers;n.length;)n.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(e){return this._throwIfClosed(),r.prototype._trySubscribe.call(this,e)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var n=this,s=this,a=s.hasError,h=s.isStopped,l=s.observers;return a||h?du:(this.currentObservers=null,l.push(e),new Mi(function(){n.currentObservers=null,Sn(l,e)}))},t.prototype._checkFinalizedStatuses=function(e){var n=this,s=n.hasError,a=n.thrownError,h=n.isStopped;s?e.error(a):h&&e.complete()},t.prototype.asObservable=function(){var e=new Nt;return e.source=this,e},t.create=function(e,n){return new cf(e,n)},t}(Nt);var cf=function(r){jr(t,r);function t(e,n){var s=r.call(this)||this;return s.destination=e,s.source=n,s}return t.prototype.next=function(e){var n,s;(s=(n=this.destination)===null||n===void 0?void 0:n.next)===null||s===void 0||s.call(n,e)},t.prototype.error=function(e){var n,s;(s=(n=this.destination)===null||n===void 0?void 0:n.error)===null||s===void 0||s.call(n,e)},t.prototype.complete=function(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)},t.prototype._subscribe=function(e){var n,s;return(s=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&s!==void 0?s:du},t}(nt);var Wo=new Nt(function(r){return r.complete()});function lf(r){return r&&tt(r.schedule)}function ff(r){return r[r.length-1]}function qo(r){return lf(ff(r))?r.pop():void 0}function $o(r,t){return typeof ff(r)=="number"?r.pop():t}var Qo=function(r){return r&&typeof r.length=="number"&&typeof r!="function"};function Yo(r){return tt(r==null?void 0:r.then)}function Ko(r){return tt(r[Ri])}function Xo(r){return Symbol.asyncIterator&&tt(r==null?void 0:r[Symbol.asyncIterator])}function Jo(r){return new TypeError("You provided "+(r!==null&&typeof r=="object"?"an invalid object":"'"+r+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function bw(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Zo=bw();function ts(r){return tt(r==null?void 0:r[Zo])}function es(r){return tf(this,arguments,function(){var e,n,s,a;return zo(this,function(h){switch(h.label){case 0:e=r.getReader(),h.label=1;case 1:h.trys.push([1,,9,10]),h.label=2;case 2:return[4,si(e.read())];case 3:return n=h.sent(),s=n.value,a=n.done,a?[4,si(void 0)]:[3,5];case 4:return[2,h.sent()];case 5:return[4,si(s)];case 6:return[4,h.sent()];case 7:return h.sent(),[3,2];case 8:return[3,10];case 9:return e.releaseLock(),[7];case 10:return[2]}})})}function rs(r){return tt(r==null?void 0:r.getReader)}function fe(r){if(r instanceof Nt)return r;if(r!=null){if(Ko(r))return Tw(r);if(Qo(r))return Pw(r);if(Yo(r))return ww(r);if(Xo(r))return pf(r);if(ts(r))return xw(r);if(rs(r))return Sw(r)}throw Jo(r)}function Tw(r){return new Nt(function(t){var e=r[Ri]();if(tt(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Pw(r){return new Nt(function(t){for(var e=0;e<r.length&&!t.closed;e++)t.next(r[e]);t.complete()})}function ww(r){return new Nt(function(t){r.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,Uo)})}function xw(r){return new Nt(function(t){var e,n;try{for(var s=_r(r),a=s.next();!a.done;a=s.next()){var h=a.value;if(t.next(h),t.closed)return}}catch(l){e={error:l}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}t.complete()})}function pf(r){return new Nt(function(t){Cw(r,t).catch(function(e){return t.error(e)})})}function Sw(r){return pf(es(r))}function Cw(r,t){var e,n,s,a;return Zl(this,void 0,void 0,function(){var h,l;return zo(this,function(f){switch(f.label){case 0:f.trys.push([0,5,6,11]),e=ef(r),f.label=1;case 1:return[4,e.next()];case 2:if(n=f.sent(),!!n.done)return[3,4];if(h=n.value,t.next(h),t.closed)return[2];f.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return l=f.sent(),s={error:l},[3,11];case 6:return f.trys.push([6,,9,10]),n&&!n.done&&(a=e.return)?[4,a.call(e)]:[3,8];case 7:f.sent(),f.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function Fe(r,t,e,n,s){n===void 0&&(n=0),s===void 0&&(s=!1);var a=t.schedule(function(){e(),s?r.add(this.schedule(null,n)):this.unsubscribe()},n);if(r.add(a),!s)return a}function is(r,t){return t===void 0&&(t=0),Yt(function(e,n){e.subscribe(we(n,function(s){return Fe(n,r,function(){return n.next(s)},t)},function(){return Fe(n,r,function(){return n.complete()},t)},function(s){return Fe(n,r,function(){return n.error(s)},t)}))})}function ns(r,t){return t===void 0&&(t=0),Yt(function(e,n){n.add(r.schedule(function(){return e.subscribe(n)},t))})}function df(r,t){return fe(r).pipe(ns(t),is(t))}function mf(r,t){return fe(r).pipe(ns(t),is(t))}function gf(r,t){return new Nt(function(e){var n=0;return t.schedule(function(){n===r.length?e.complete():(e.next(r[n++]),e.closed||this.schedule())})})}function yf(r,t){return new Nt(function(e){var n;return Fe(e,t,function(){n=r[Zo](),Fe(e,t,function(){var s,a,h;try{s=n.next(),a=s.value,h=s.done}catch(l){e.error(l);return}h?e.complete():e.next(a)},0,!0)}),function(){return tt(n==null?void 0:n.return)&&n.return()}})}function os(r,t){if(!r)throw new Error("Iterable cannot be null");return new Nt(function(e){Fe(e,t,function(){var n=r[Symbol.asyncIterator]();Fe(e,t,function(){n.next().then(function(s){s.done?e.complete():e.next(s.value)})},0,!0)})})}function vf(r,t){return os(es(r),t)}function bf(r,t){if(r!=null){if(Ko(r))return df(r,t);if(Qo(r))return gf(r,t);if(Yo(r))return mf(r,t);if(Xo(r))return os(r,t);if(ts(r))return yf(r,t);if(rs(r))return vf(r,t)}throw Jo(r)}function ss(r,t){return t?bf(r,t):fe(r)}function ir(r,t){return Yt(function(e,n){var s=0;e.subscribe(we(n,function(a){n.next(r.call(t,a,s++))}))})}function Tf(r,t,e,n,s,a,h,l){var f=[],d=0,y=0,b=!1,S=function(){b&&!f.length&&!d&&t.complete()},C=function(I){return d<n?A(I):f.push(I)},A=function(I){a&&t.next(I),d++;var F=!1;fe(e(I,y++)).subscribe(we(t,function(B){s==null||s(B),a?C(B):t.next(B)},function(){F=!0},void 0,function(){if(F)try{d--;for(var B=function(){var j=f.shift();h?Fe(t,h,function(){return A(j)}):A(j)};f.length&&d<n;)B();S()}catch(j){t.error(j)}}))};return r.subscribe(we(t,C,function(){b=!0,S()})),function(){l==null||l()}}function Tu(r,t,e){return e===void 0&&(e=1/0),tt(t)?Tu(function(n,s){return ir(function(a,h){return t(n,a,s,h)})(fe(r(n,s)))},e):(typeof t=="number"&&(e=t),Yt(function(n,s){return Tf(n,s,r,e)}))}function as(r){return r===void 0&&(r=1/0),Tu(Ho,r)}function Pu(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=qo(r),n=$o(r,1/0),s=r;return s.length?s.length===1?fe(s[0]):as(n)(ss(s,e)):Wo}var _w=Array.isArray;function Pf(r){return r.length===1&&_w(r[0])?r[0]:r}function Ht(r,t){return Yt(function(e,n){var s=0;e.subscribe(we(n,function(a){return r.call(t,a,s++)&&n.next(a)}))})}function pe(r){return r<=0?function(){return Wo}:Yt(function(t,e){var n=0;t.subscribe(we(e,function(s){++n<=r&&(e.next(s),r<=n&&e.complete())}))})}function wf(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=qo(r),n=$o(r,1/0);return r=Pf(r),Yt(function(s,a){as(n)(ss(rr([s],er(r)),e)).subscribe(a)})}function wu(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return wf.apply(void 0,rr([],er(r)))}function Dt(r){return Yt(function(t,e){fe(r).subscribe(we(e,function(){return e.complete()},Cn)),!e.closed&&t.subscribe(e)})}var Br=1e3,us=class{constructor(t,e){this.id=t;this.movementDirection="none";this._tilePos={position:new D(0,0),layer:void 0};this.movementStarted$=new nt;this.movementStopped$=new nt;this.directionChanged$=new nt;this.positionChangeStarted$=new nt;this.positionChangeFinished$=new nt;this.tilePositionSet$=new nt;this.autoMovementSet$=new nt;this.lastMovementImpulse="none";this.facingDirection="down";this.depthChanged$=new nt;this.movementProgress=0;var n,s,a;this.tilemap=e.tilemap,this.speed=e.speed,this.collidesWithTilesInternal=e.collidesWithTiles,this._tilePos.layer=e.charLayer,this.ignoreMissingTiles=(n=e.ignoreMissingTiles)!=null?n:!1,this.collisionGroups=new Set(e.collisionGroups||[]),this.ignoreCollisionGroups=new Set(e.ignoreCollisionGroups||[]),this.labels=new Set(e.labels||[]),this.numberOfDirections=e.numberOfDirections,e.facingDirection&&this.turnTowards(e.facingDirection),this.tileWidth=(s=e.tileWidth)!=null?s:1,this.tileHeight=(a=e.tileHeight)!=null?a:1}getId(){return this.id}getSpeed(){return this.speed}setSpeed(t){this.speed=t}setMovement(t){this.autoMovementSet$.next(t),this.movement=t}getMovement(){return this.movement}collidesWithTiles(){return this.collidesWithTilesInternal}setCollidesWithTiles(t){this.collidesWithTilesInternal=t}getIgnoreMissingTiles(){return this.ignoreMissingTiles}setIgnoreMissingTiles(t){this.ignoreMissingTiles=t}setTilePosition(t){this.isMoving()&&this.movementStopped$.next(this.movementDirection),this.tilePositionSet$.next(it({},t)),this.fire(this.positionChangeStarted$,this.tilePos,t),this.fire(this.positionChangeFinished$,this.tilePos,t),this.movementDirection="none",this.lastMovementImpulse="none",this.tilePos=t,this.movementProgress=0}getTilePos(){return this.tilePos}getNextTilePos(){if(!this.isMoving())return this.tilePos;let t=this.tilePos.layer,e=this.tilePosInDirection(this.tilePos.position,this.movementDirection),n=this.tilemap.getTransition(e,this.tilePos.layer);return n&&(t=n),{position:this.tilePosInDirection(this.tilePos.position,this.movementDirection),layer:t}}getTileWidth(){return this.tileWidth}getTileHeight(){return this.tileHeight}move(t){this.lastMovementImpulse=t,t!="none"&&(this.isMoving()||(this.isBlockingDirection(t)?this.changeFacingDirection(t):this.startMoving(t)))}update(t){var e;(e=this.movement)==null||e.update(t),this.isMoving()&&this.updateCharacterPosition(t),this.lastMovementImpulse="none"}getMovementDirection(){return this.movementDirection}isBlockingDirection(t){if(t=="none")return!1;let e=this.tilePosInDirection(this.getNextTilePos().position,t),n=this.tilemap.getTransition(e,this.getNextTilePos().layer)||this.getNextTilePos().layer;return this.collidesWithTilesInternal&&this.isTileBlocking(t,n)?!0:this.isCharBlocking(t,n)}isTileBlocking(t,e){return this.someCharTile((n,s)=>{let a=this.tilePosInDirection(new D(n,s),t);return this.tilemap.hasBlockingTile(a,e,Jl(t),this.ignoreMissingTiles)})}isCharBlocking(t,e){return this.someCharTile((n,s)=>{let a=this.tilePosInDirection(new D(n,s),t);return this.tilemap.hasBlockingChar(a,e,this.getCollisionGroups(),new Set([this.getId()]),this.ignoreCollisionGroups)})}isMoving(){return this.movementDirection!="none"}turnTowards(t){this.isMoving()||t!="none"&&this.changeFacingDirection(t)}changeFacingDirection(t){this.facingDirection!==t&&(this.facingDirection=t,this.directionChanged$.next(t))}getFacingDirection(){return this.facingDirection}getFacingPosition(){return this._tilePos.position.add(We(this.facingDirection))}addCollisionGroup(t){this.collisionGroups.add(t)}setCollisionGroups(t){this.collisionGroups=new Set(t)}setIgnoreCollisionGroups(t){this.ignoreCollisionGroups=new Set(t)}getCollisionGroups(){return Array.from(this.collisionGroups)}getIgnoreCollisionGroups(){return Array.from(this.ignoreCollisionGroups)}hasCollisionGroup(t){return this.collisionGroups.has(t)}removeCollisionGroup(t){this.collisionGroups.delete(t)}removeAllCollisionGroups(){this.collisionGroups.clear()}addLabels(t){for(let e of t)this.labels.add(e)}getLabels(){return[...this.labels.values()]}hasLabel(t){return this.labels.has(t)}clearLabels(){this.labels.clear()}removeLabels(t){for(let e of t)this.labels.delete(e)}getNumberOfDirections(){return this.numberOfDirections}movementStarted(){return this.movementStarted$}movementStopped(){return this.movementStopped$}directionChanged(){return this.directionChanged$}tilePositionSet(){return this.tilePositionSet$}positionChangeStarted(){return this.positionChangeStarted$}positionChangeFinished(){return this.positionChangeFinished$}autoMovementSet(){return this.autoMovementSet$}depthChanged(){return this.depthChanged$}getMovementProgress(){return this.movementProgress}setMovementProgress(t){let e=Math.max(0,Math.min(Br,t));this.movementProgress=e}hasWalkedHalfATile(){return this.movementProgress>Br/2}willCrossTileBorderThisUpdate(t){return this.movementProgress+this.maxProgressForDelta(t)>=Br}updateCharacterPosition(t){let e=this.willCrossTileBorderThisUpdate(t),s=1-(e?Br-this.movementProgress:this.maxProgressForDelta(t))/this.maxProgressForDelta(t);this.movementProgress=Math.min(this.movementProgress+this.maxProgressForDelta(t),Br),e&&(this.movementProgress=0,this.shouldContinueMoving()?(this.fire(this.positionChangeFinished$,this.tilePos,this.getNextTilePos()),this.tilePos=this.getNextTilePos(),this.startMoving(this.lastMovementImpulse),s>0&&this.updateCharacterPosition(t*s)):this.stopMoving())}maxProgressForDelta(t){let n=t/1e3;return Math.floor(n*this.speed*Br)}get tilePos(){return z.clone(this._tilePos)}set tilePos(t){z.copyOver(t,this._tilePos)}startMoving(t){t!=="none"&&(t!=this.movementDirection&&this.movementStarted$.next(t),this.movementDirection=t,this.facingDirection=t,this.fire(this.positionChangeStarted$,this.tilePos,this.getNextTilePos()))}tilePosInDirection(t,e){return t.add(We(this.tilemap.toMapDirection(e)))}shouldContinueMoving(){return this.lastMovementImpulse!=="none"&&!this.isBlockingDirection(this.lastMovementImpulse)}stopMoving(){if(this.movementDirection==="none")return;let t=this.tilePos,e=this.getNextTilePos(),n=this.movementDirection;this.tilePos=this.getNextTilePos(),this.movementDirection="none",this.movementStopped$.next(n),this.fire(this.positionChangeFinished$,t,e)}fire(t,{position:e,layer:n},{position:s,layer:a}){t.next({exitTile:e,enterTile:s,exitLayer:n,enterLayer:a})}someCharTile(t){let e=this.getNextTilePos().position;for(let n=e.x;n<e.x+this.getTileWidth();n++)for(let s=e.y;s<e.y+this.getTileHeight();s++)if(t(n,s))return!0;return!1}};var ui=class ui{constructor(t,e){this.walkingAnimationMapping=t;this.charsInRow=e;this.lastFootLeft=!1;this.directionToFrameRow={down:0,"down-left":1,"down-right":2,left:1,right:2,up:3,"up-left":1,"up-right":2};this._isEnabled=!0;this.frameChange$=new nt;this.setWalkingAnimationMapping(t)}frameChange(){return this.frameChange$}setIsEnabled(t){this._isEnabled=t}isEnabled(){return this._isEnabled}updateCharacterFrame(t,e,n){this._isEnabled&&(e?this.setStandingFrameDuringWalk(t,n):this.setWalkingFrame(t))}setStandingFrame(t){this._isEnabled&&this._setStandingFrame(t)}setWalkingAnimationMapping(t){this.walkingAnimationMapping=t,this._isEnabled=this.walkingAnimationMapping!==void 0}getWalkingAnimationMapping(){return this.walkingAnimationMapping}getCharsInRow(){return this.charsInRow}setStandingFrameDuringWalk(t,e){this.isCurrentFrameStanding(t,e)||(this.lastFootLeft=!this.lastFootLeft),this._setStandingFrame(t)}setWalkingFrame(t){let e=this.framesOfDirection(t);e&&this.frameChange$.next(this.lastFootLeft?e.rightFoot:e.leftFoot)}_setStandingFrame(t){let e=this.framesOfDirection(t);e&&this.frameChange$.next(e.standing)}isCurrentFrameStanding(t,e){var n;return e===((n=this.framesOfDirection(t))==null?void 0:n.standing)}framesOfDirection(t){return typeof this.walkingAnimationMapping=="number"?this.getFramesForCharIndex(t,this.walkingAnimationMapping):this.getFramesForAnimationMapping(t)}getFramesForAnimationMapping(t){if(this.walkingAnimationMapping)return this.walkingAnimationMapping[t]||this.walkingAnimationMapping[this.fallbackDirection(t)]}fallbackDirection(t){switch(t){case"down-left":return"left";case"down-right":return"right";case"up-left":return"left";case"up-right":return"right"}return t}getFramesForCharIndex(t,e){var d;let n=Math.floor(e/this.charsInRow),s=e%this.charsInRow,a=this.charsInRow*ui.FRAMES_CHAR_ROW,h=ui.FRAMES_CHAR_ROW*s,l=((d=this.directionToFrameRow[t])!=null?d:0)+n*ui.FRAMES_CHAR_COL,f=h+l*a;return{rightFoot:f,standing:f+1,leftFoot:f+2}}};ui.FRAMES_CHAR_ROW=3,ui.FRAMES_CHAR_COL=4;var Ln=ui;var hi=class{static shiftPad(t,e){let n=Math.floor(t),a=`${n}`.padStart(e,"0").length;return n/Math.pow(10,a)}};var xt=class r{static vec2str(t){return`${t.x}#${t.y}`}static equal(t,e){return r.vec2str(t)==r.vec2str(e)}static manhattanDistance(t,e){let n=Math.abs(t.x-e.x),s=Math.abs(t.y-e.y);return n+s}static chebyshevDistance(t,e){let n=Math.abs(t.x-e.x),s=Math.abs(t.y-e.y);return Math.max(n,s)}static scalarMult(t,e){return t.clone().multiply(new D(e,e))}};var Re=class Re{constructor(t){this.tilemap=t;this.charLayerDepths=new Map;this.setLayerDepths()}getTileWidth(){var e,n;let t=(n=(e=this.tilemap.layers[0])==null?void 0:e.tilemapLayer.scale)!=null?n:1;return this.tilemap.tileWidth*t}getTileHeight(){var e,n;let t=(n=(e=this.tilemap.layers[0])==null?void 0:e.tilemapLayer.scale)!=null?n:1;return this.tilemap.tileHeight*t}getDepthOfCharLayer(t){var e;return(e=this.charLayerDepths.get(t))!=null?e:0}tilePosToPixelPos(t){return this.isIsometric()?xt.scalarMult(this.getTileSize(),.5).multiply(new D(t.x-t.y,t.x+t.y)):t.clone().multiply(this.getTileSize())}getTileDistance(t){if(this.isIsometric())switch(t){case"down-left":case"down-right":case"up-left":case"up-right":return xt.scalarMult(this.getTileSize(),.5);default:return this.getTileSize()}return this.getTileSize()}getTileSize(){return new D(this.getTileWidth(),this.getTileHeight())}isIsometric(){return this.tilemap.orientation==Phaser.Tilemaps.Orientation.ISOMETRIC.toString()}isLayerAlwaysOnTop(t){return this.hasLayerProp(t,Re.ALWAYS_TOP_PROP_NAME)}isCharLayer(t){return this.hasLayerProp(t,Re.CHAR_LAYER_PROP_NAME)}setLayerDepths(){let t=[],e=-1,n=this.tilemap.layers.filter(a=>this.isLayerAlwaysOnTop(a));this.tilemap.layers.filter(a=>!this.isLayerAlwaysOnTop(a)).forEach(a=>{this.hasLayerProp(a,Re.HEIGHT_SHIFT_PROP_NAME)?(this.createHeightShiftLayers(a,e),t.push(a.tilemapLayer)):this.setDepth(a,++e)}),this.charLayerDepths.set(void 0,e),n.forEach((a,h)=>{a.tilemapLayer.setDepth(h+1+e)}),t.forEach(a=>a.destroy())}setDepth(t,e){t.tilemapLayer.setDepth(e),this.isCharLayer(t)&&this.charLayerDepths.set(this.getLayerProp(t,Re.CHAR_LAYER_PROP_NAME),e)}createHeightShiftLayers(t,e){let n=this.getLayerProp(t,Re.HEIGHT_SHIFT_PROP_NAME);isNaN(n)&&(n=0);let s=1;for(let a=0;a<t.height;a++){let h=this.copyLayer(t,a);if(h){h.scale=t.tilemapLayer.scale;let l=this.isIsometric()?this.getTileHeight()/2:this.getTileHeight();h.setDepth(e+hi.shiftPad((a+n)*l+s,Re.Z_INDEX_PADDING))}}}getLayerProp(t,e){let s=t.properties.find(a=>a.name==e);return s==null?void 0:s.value}hasLayerProp(t,e){return this.getLayerProp(t,e)!=null}copyLayer(t,e){let n=`${t.name}#${e}`,s=this.tilemap.createBlankLayer(n,t.tilemapLayer.tileset);if(s){if(s.name=n,this.isIsometric())for(let a=e;a>=0;a--){let h=e-a;s.putTileAt(t.data[a][h],h,a)}else for(let a=0;a<t.width;a++)s.putTileAt(t.data[e][a],a,e);return s}}};Re.ALWAYS_TOP_PROP_NAME="ge_alwaysTop",Re.CHAR_LAYER_PROP_NAME="ge_charLayer",Re.HEIGHT_SHIFT_PROP_NAME="ge_heightShift",Re.Z_INDEX_PADDING=7;var ci=Re;var hs=class{constructor(t,e,n,s,a){this.charData=t;this.scene=e;this.tilemap=n;this.geHeadless=a;this.customOffset=new D(0,0);this.cachedContainerHeight=0;this.newSpriteSet$=new nt;this.destroy$=new nt;var h,l;this.layerOverlaySprite=s&&t.sprite?this.scene.add.sprite(0,0,t.sprite.texture):void 0,this.walkingAnimationMapping=t.walkingAnimationMapping,this.customOffset=new D(t.offsetX||0,t.offsetY||0),this.sprite=t.sprite,this.container=t.container,this.cachedContainerHeight=(l=(h=t.container)==null?void 0:h.getBounds().height)!=null?l:0,this.geHeadless.directionChanged().pipe(Ht(({charId:f})=>f===this.charData.id)).subscribe(({direction:f})=>{var d;(d=this.animation)==null||d.setStandingFrame(f)}),this.sprite&&(this.sprite.setOrigin(0,0),this.resetAnimation(this.sprite),this.updateOverlaySprite(),this.updateGridChar())}destroy(){this.destroy$.next(),this.destroy$.complete(),this.newSpriteSet$.complete()}setSprite(t){t?(this.sprite&&(t.x=this.sprite.x,t.y=this.sprite.y),this.sprite=t,this.newSpriteSet$.next(),this.layerOverlaySprite=this.layerOverlaySprite?this.scene.add.sprite(0,0,this.sprite.texture):void 0,this.updateOverlaySprite(),this.resetAnimation(this.sprite),this.updateDepth()):(this.layerOverlaySprite=void 0,this.sprite=void 0)}getSprite(){return this.sprite}getLayerOverlaySprite(){return this.layerOverlaySprite}setContainer(t){var e;this.container=t,this.cachedContainerHeight=(e=t==null?void 0:t.getBounds().height)!=null?e:0}getContainer(){return this.container}getOffsetX(){return this.customOffset.x}setOffsetX(t){this.customOffset.x=t}getOffsetY(){return this.customOffset.y}setOffsetY(t){this.customOffset.y=t}getWalkingAnimationMapping(){return this.walkingAnimationMapping}turnTowards(t){var e;this.geHeadless.isMoving(this.charData.id)||t!="none"&&(this.geHeadless.turnTowards(this.charData.id,t),(e=this.animation)==null||e.setStandingFrame(t))}getAnimation(){return this.animation}setAnimation(t){this.animation=t}update(t){this.updateGridChar()}getEngineOffset(){var n,s,a,h;if(!this.sprite)return D.ZERO;let t=this.tilemap.getTileWidth()/2-Math.floor(((s=(n=this.sprite)==null?void 0:n.displayWidth)!=null?s:0)/2),e=-((h=(a=this.sprite)==null?void 0:a.displayHeight)!=null?h:0)+this.tilemap.getTileHeight();return new D(t,e)}updatePixelPos(){let t=new D(this.geHeadless.getPosition(this.charData.id)),e=this.geHeadless.getMovementProgress(this.charData.id)/1e3,s=this.tilemap.tilePosToPixelPos(t).add(this.getEngineOffset()).add(this.customOffset).add(We(this.geHeadless.getFacingDirection(this.charData.id)).multiply(this.tilemap.getTileDistance(this.geHeadless.getFacingDirection(this.charData.id)).scalarMult(e))),a=this.getGameObj();a&&(a.x=Math.floor(s.x),a.y=Math.floor(s.y))}getGameObj(){return this.container||this.sprite}updateGridChar(){var t;if(this.updatePixelPos(),this.sprite&&this.geHeadless.isMoving(this.charData.id)){let e=this.geHeadless.getMovementProgress(this.charData.id)>Br/2;(t=this.getAnimation())==null||t.updateCharacterFrame(this.geHeadless.getFacingDirection(this.charData.id),e,Number(this.sprite.frame.name))}this.updateDepth()}resetAnimation(t){let e=new Ln(this.walkingAnimationMapping,t.texture.source[0].width/t.width/Ln.FRAMES_CHAR_ROW);this.setAnimation(e),e.frameChange().pipe(Dt(this.newSpriteSet$)).subscribe(n=>{t==null||t.setFrame(n)}),e.setIsEnabled(this.walkingAnimationMapping!==void 0),e.setStandingFrame(this.geHeadless.getFacingDirection(this.charData.id))}updateOverlaySprite(){if(!this.layerOverlaySprite||!this.sprite)return;this.layerOverlaySprite.scale=this.sprite.scale;let t=this.tilemap.getTileHeight()/this.layerOverlaySprite.scale;this.layerOverlaySprite.setCrop(0,0,this.layerOverlaySprite.displayWidth,this.sprite.height-t),this.layerOverlaySprite.setOrigin(0,0)}updateDepth(){if(!this.getGameObj())return;let e=new D(this.geHeadless.getPosition(this.charData.id)),n=this.geHeadless.getCharLayer(this.charData.id);this.container?this.setContainerDepth(this.container,{position:e,layer:n}):this.sprite&&this.setSpriteDepth(this.sprite,{position:e,layer:n});let s=this.getLayerOverlaySprite();if(s){let a=new D(Pe(it({},e),{y:e.y-1}));this.setSpriteDepth(s,{position:a,layer:n})}}setSpriteDepth(t,e){t.setDepth(this.tilemap.getDepthOfCharLayer(this.getTransitionLayer(e))+this.getPaddedPixelDepthSprite(t))}setContainerDepth(t,e){t.setDepth(this.tilemap.getDepthOfCharLayer(this.getTransitionLayer(e))+this.getPaddedPixelDepthContainer(t))}getPaddedPixelDepthContainer(t){return hi.shiftPad(t.y+this.cachedContainerHeight,ci.Z_INDEX_PADDING)}getPaddedPixelDepthSprite(t){return hi.shiftPad(t.y+t.displayHeight,ci.Z_INDEX_PADDING)}getTransitionLayer(t){if(t.layer)return this.geHeadless.getTransition(t.position,t.layer)||t.layer}};var cs=(s=>(s.DONT_BLOCK="DONT_BLOCK",s.BLOCK_TWO_TILES="BLOCK_TWO_TILES",s.BLOCK_ONE_TILE_AHEAD="BLOCK_ONE_TILE_AHEAD",s.BLOCK_ONE_TILE_BEHIND="BLOCK_ONE_TILE_BEHIND",s))(cs||{});var zi=(s=>(s.STOP="STOP",s.CLOSEST_REACHABLE="CLOSEST_REACHABLE",s.RETRY="RETRY",s.ALTERNATIVE_TARGETS="ALTERNATIVE_TARGETS",s))(zi||{});var ls=class{distance(t,e){return xt.manhattanDistance(t,e)}direction(t,e){if(xt.equal(t,e))return"none";let n=t.clone().subtract(e);return Math.abs(n.x)>Math.abs(n.y)?n.x>0?"left":"right":n.y>0?"up":"down"}neighbors(t){return[new D(t.x,t.y+1),new D(t.x+1,t.y),new D(t.x-1,t.y),new D(t.x,t.y-1)]}getDirections(){return["up","right","down","left"]}};var fs=class{distance(t,e){return xt.chebyshevDistance(t,e)}neighbors(t){let e=[new D(t.x,t.y+1),new D(t.x+1,t.y),new D(t.x-1,t.y),new D(t.x,t.y-1)],n=[new D(t.x+1,t.y+1),new D(t.x+1,t.y-1),new D(t.x-1,t.y+1),new D(t.x-1,t.y-1)];return[...e,...n]}direction(t,e){return e.x>t.x?e.y>t.y?"down-right":e.y<t.y?"up-right":"right":e.x<t.x?e.y>t.y?"down-left":e.y<t.y?"up-left":"left":e.y<t.y?"up":e.y>t.y?"down":"none"}getDirections(){return["up","right","down","left","down-left","down-right","up-right","up-left"]}};var ie=class{static create(t){switch(t){case 4:return new ls;case 8:return new fs}}};var En=class{constructor(t,e,n){this.backoffMs=t;this.maxRetries=e;this.onFinished=n;this.retries=0;this.elapsed=0}retry(t,e){this.shouldRetry()?(this.elapsed+=t,this.elapsed>=this.backoffMs&&(this.elapsed=0,this.retries++,e())):this.onFinished()}reset(){this.retries=0,this.elapsed=0}getMaxRetries(){return this.maxRetries}getBackoffMs(){return this.backoffMs}shouldRetry(){return this.maxRetries===-1||this.retries<this.maxRetries}};var On=(n=>(n.WAIT="WAIT",n.RETRY="RETRY",n.STOP="STOP",n))(On||{});var nr=class{constructor(t,{shortestPathAlgorithm:e="BFS",pathWidth:n=1,pathHeight:s=1,numberOfDirections:a=4,isPositionAllowed:h=(F,B)=>!0,collisionGroups:l=[],ignoredChars:f=[],ignoreTiles:d=!1,ignoreMapBounds:y=!1,ignoreBlockedTarget:b=!1,maxPathLength:S=1/0,ignoreLayers:C=!1,considerCosts:A=!1,calculateClosestToTarget:I=!0}={}){this.gridTilemap=t;this.options={shortestPathAlgorithm:e,pathWidth:n,pathHeight:s,numberOfDirections:a,isPositionAllowed:h,collisionGroups:l,ignoredChars:f,ignoreTiles:d,ignoreMapBounds:y,ignoreBlockedTarget:b,maxPathLength:S,ignoreLayers:C,considerCosts:A,calculateClosestToTarget:I}}findShortestPath(t,e){this.options.ignoreLayers&&(this.gridTilemap.fixCacheLayer(t.layer),e.layer=t.layer);let n=this.findShortestPathImpl(t,e);return this.gridTilemap.unfixCacheLayers(),n}getNeighbors(t,e){var h;return ie.create((h=this.options.numberOfDirections)!=null?h:4).neighbors(t.position).map(l=>{let f=t.layer;return this.options.ignoreLayers||(f=this.gridTilemap.getTransition(l,t.layer)),{position:l,layer:f||t.layer}}).filter(l=>!this.isBlocking(t,l)||this.options.ignoreBlockedTarget&&z.equal(l,e))}getTransition(t,e){if(!this.options.ignoreLayers)return this.gridTilemap.getTransition(t,e)}getCosts(t,e){if(!this.options.considerCosts)return 1;let n=re(e.position,t);return this.gridTilemap.getTileCosts(e,n)}isBlocking(t,e){return!(this.options.ignoreMapBounds||this.gridTilemap.isInRange(e.position))||!this.options.isPositionAllowed(e.position,e.layer)||!this.options.ignoreTiles&&this.hasBlockingTileFrom(t,e,this.options.pathWidth,this.options.pathHeight,this.options.ignoreMapBounds,this.gridTilemap)?!0:this.hasBlockingCharFrom(e,this.options.pathWidth,this.options.pathHeight,this.options.collisionGroups,this.options.ignoredChars,this.gridTilemap)}distance(t,e){return(this.options.numberOfDirections===4?xt.manhattanDistance:xt.chebyshevDistance)(t,e)}getTilePosInDir(t,e){return this.gridTilemap.getTilePosInDirection(t,e)}getReverseNeighbors(t,e){var l;let s=ie.create((l=this.options.numberOfDirections)!=null?l:4).neighbors(t.position),a;if(!this.options.ignoreLayers){let f=this.gridTilemap.getReverseTransitions(t.position,t.layer);a=f?[...f]:void 0}return s.map(f=>a?a.map(d=>({position:f,layer:d||t.layer})):[{position:f,layer:t.layer}]).flat().filter(f=>!this.isBlocking(f,t)||this.options.ignoreBlockedTarget&&z.equal(t,e))}hasBlockingCharFrom(t,e,n,s,a,h){for(let l=t.position.x;l<t.position.x+e;l++)for(let f=t.position.y;f<t.position.y+n;f++)if(h.hasBlockingChar(new D(l,f),t.layer,s,new Set(a)))return!0;return!1}hasBlockingTileFrom(t,e,n,s,a,h){for(let l=e.position.x;l<e.position.x+n;l++)for(let f=e.position.y;f<e.position.y+s;f++)if(h.hasBlockingTile(new D(l,f),e.layer,re(e.position,t.position),a))return!0;return!1}};var kf=Yl(ds(),1);var ms=class extends nr{findShortestPathImpl(t,e){let n=this.shortestPathBfs(t,e);return{path:this.returnPath(n.previous,t,e),closestToTarget:n.closestToTarget,steps:n.steps,maxPathLengthReached:n.maxPathLengthReached,algorithmUsed:"A_STAR"}}shortestPathBfs(t,e){let n=new Map,s=new Map,a=new Map,h=new kf.MinFibonacciHeap((y,b)=>Dn(a,y)-Dn(a,b)),l=t,f=this.distance(t.position,e.position),d=0;for(h.push(t),s.set(z.toString(t),0),a.set(z.toString(t),this.distance(t.position,e.position));h.size>0;){let y=h.pop();if(!y)break;d++;let b=this.distance(y.position,e.position);if(b<f&&(f=b,l=y),Mf(y,e))return{previous:n,closestToTarget:l,steps:d,maxPathLengthReached:!1};if(Dn(s,y)+1>this.options.maxPathLength)return{previous:new Map,closestToTarget:l,steps:d,maxPathLengthReached:!0};for(let S of this.getNeighbors(y,e)){let C=Dn(s,y)+this.getCosts(y.position,S),A=z.toString(S);(!s.has(A)||C<Dn(s,S))&&(n.set(A,y),s.set(A,C),a.set(A,C+this.distance(S.position,e.position)),h.push(S))}}return{previous:n,closestToTarget:l,steps:d,maxPathLengthReached:!1}}returnPath(t,e,n){let s=[],a=n;for(s.push(a);!Mf(a,e);){if(a=t.get(z.toString(a)),!a)return[];s.push(a)}return s.reverse()}};function Dn(r,t){var e;return(e=r.get(z.toString(t)))!=null?e:Number.MAX_VALUE}function Mf(r,t){return xt.equal(r.position,t.position)?r.layer===t.layer:!1}var gs=class{constructor(t){this.data=t}},Lr=class{constructor(){this.sizeInternal=0}dequeue(){if(this.tail===void 0)return;this.sizeInternal--;let t=this.tail.data;return this.tail.prev===void 0?(this.tail=void 0,this.head=void 0,t):(this.tail.prev.next=void 0,this.tail=this.tail.prev,t)}enqueue(t){if(this.sizeInternal++,this.head===void 0){this.head=new gs(t),this.tail=this.head;return}let e=new gs(t);e.next=this.head,this.head.prev=e,this.head=e}peek(){return this.tail?this.tail.data:void 0}peekAll(){let t=[],e=this.tail;for(;e;)t.push(e.data),e=e.prev;return t}clear(){this.head=void 0,this.tail=void 0,this.sizeInternal=0}peekEnd(){var t;return(t=this.head)==null?void 0:t.data}size(){return this.sizeInternal}};var Ni=class extends nr{findShortestPathImpl(t,e){let n=this.shortestPathBfs(t,e);return{path:this.returnPath(n.previous,t,e),closestToTarget:n.closestToTarget,steps:n.steps,maxPathLengthReached:n.maxPathLengthReached,algorithmUsed:"BFS"}}equal(t,e){return xt.equal(t.position,e.position)?t.layer===e.layer:!1}shortestPathBfs(t,e){let n=new Map,s=new Set,a=new Lr,h=t,l=this.distance(t.position,e.position),f=0;for(a.enqueue({node:t,dist:0}),s.add(z.toString(t));a.size()>0;){let d=a.dequeue();if(f++,!d)break;let{node:y,dist:b}=d;if(b>this.options.maxPathLength)return{previous:new Map,closestToTarget:h,steps:f,maxPathLengthReached:!0};let S=this.distance(y.position,e.position);if(S<l&&(l=S,h=y),this.equal(y,e))return{previous:n,closestToTarget:h,steps:f,maxPathLengthReached:!1};for(let C of this.getNeighbors(y,e))s.has(z.toString(C))||(n.set(z.toString(C),y),a.enqueue({node:C,dist:b+1}),s.add(z.toString(C)))}return{previous:n,closestToTarget:h,steps:f,maxPathLengthReached:!1}}returnPath(t,e,n){let s=[],a=n;for(s.push(a);!this.equal(a,e);){if(a=t.get(z.toString(a)),!a)return[];s.push(a)}return s.reverse()}};var ys=class{constructor(){this.previous=new Map;this.visited=new Map;this.queue=new Lr;this.minMatching=1/0;this.lastDist=0}isNewFrontier(){let t=this.queue.peek();return!!(t&&t.dist>this.lastDist)}step(t,e,n){var s;this.lastDist=n;for(let a of t){let h=z.toString(a);if(!this.visited.has(h)){this.previous.set(h,e),this.queue.enqueue({node:a,dist:n+1}),this.visited.set(h,n+1);let l=(s=this.otherBfs)==null?void 0:s.visited.get(h);l!==void 0&&l<this.minMatching&&(this.minMatching=l,this.minMatchingNode=a)}}}},vs=class extends nr{findShortestPathImpl(t,e){let n=this.shortestPathBfs(t,e);return{path:this.returnPath(n.previous,n.previous2,n.matchingPos,t,e),closestToTarget:n.closestToTarget,steps:n.steps,maxPathLengthReached:n.maxPathLengthReached,algorithmUsed:"BIDIRECTIONAL_SEARCH"}}equal(t,e){return xt.equal(t.position,e.position)?t.layer===e.layer:!1}shortestPathBfs(t,e){var f;if(z.equal(t,e))return{previous:new Map,previous2:new Map,closestToTarget:t,steps:0,maxPathLengthReached:!1};let n=new ys,s=new ys,a=0;n.otherBfs=s,s.otherBfs=n;let h=t,l=this.distance(t.position,e.position);for(n.queue.enqueue({node:t,dist:0}),s.queue.enqueue({node:e,dist:0}),n.visited.set(z.toString(t),0),s.visited.set(z.toString(e),0);this.shouldStop(n.queue.size()>0,s.queue.size()>0);){let d=n.queue.dequeue();if(!d)break;let{node:y,dist:b}=d;if(b+1+(((f=s.queue.peek())==null?void 0:f.dist)||0)>this.options.maxPathLength)return{previous:n.previous,previous2:s.previous,closestToTarget:this.maybeClosestToTarget(h),steps:a,maxPathLengthReached:!0};let S=this.distance(y.position,e.position);if(S<l&&(l=S,h=y),a++,n.step(this.getNeighbors(y,e),y,b),n.isNewFrontier()&&n.minMatchingNode)return{previous:n.previous,previous2:s.previous,closestToTarget:this.maybeClosestToTarget(e),matchingPos:n.minMatchingNode,steps:a,maxPathLengthReached:!1};let C=s.queue.dequeue();if(!C)continue;let{node:A,dist:I}=C;if(a++,s.step(this.getReverseNeighbors(A,e),A,I),s.isNewFrontier()&&s.minMatchingNode)return{previous:n.previous,previous2:s.previous,closestToTarget:this.maybeClosestToTarget(e),matchingPos:s.minMatchingNode,steps:a,maxPathLengthReached:!1}}return{previous:n.previous,previous2:s.previous,closestToTarget:this.maybeClosestToTarget(h),steps:a,maxPathLengthReached:!1}}shouldStop(t,e){return this.options.calculateClosestToTarget?t||e:t&&e}maybeClosestToTarget(t){return this.options.calculateClosestToTarget?t:void 0}returnPath(t,e,n,s,a){if(n){let h=this.getPathFromPrev(t,s,n).reverse(),l=this.getPathFromPrev(e,a,n);return h.pop(),[...h,...l]}else return this.getPathFromPrev(t,s,a).reverse()}getPathFromPrev(t,e,n){let s=[],a=n;for(s.push(a);!this.equal(a,e);){if(a=t.get(z.toString(a)),!a)return[];s.push(a)}return s}};var rh=Yl(Yd(),1);var Qi=class extends nr{constructor(e,n={}){super(e,n);this.openSet=new rh.MinFibonacciHeap;this.g=new Map;this.f=new Map;this.closestToTarget={position:new D(0,0),layer:void 0};this.smallestDistToTarget=0;this.steps=0;this.maxFrontierSize=0;this.maxJumpSize=0;this.turnOrder={right:0,"down-right":1,down:2,"down-left":3,left:4,"up-left":5,up:6,"up-right":7};this.turnTimes=LS();this.distanceUtils=ie.create(4)}findShortestPathImpl(e,n){this.maxJumpSize=this.distance(e.position,n.position);let s=this.shortestPath(e,n);return{path:this.returnPath(s.previous,e,n),closestToTarget:s.closestToTarget,steps:s.steps,maxPathLengthReached:s.maxPathLengthReached,algorithmUsed:"JPS"}}shortestPath(e,n){this.steps=0;let s=new Map;this.g=new Map,this.f=new Map,this.closestToTarget=e,this.smallestDistToTarget=this.distance(e.position,n.position),this.openSet=new rh.MinFibonacciHeap((h,l)=>Rn(this.f,h)-Rn(this.f,l)),this.openSet.push(e);let a=z.toString(e);for(this.g.set(a,0),this.f.set(a,this.distance(e.position,n.position)),this.maxFrontierSize=Math.max(this.maxFrontierSize,this.openSet.size);this.openSet.size>0;){let h=this.openSet.pop();if(!h)break;if(this.steps++,z.equal(h,n))return{previous:s,closestToTarget:n,steps:this.steps,maxPathLengthReached:!1};if(Rn(this.g,h)+1>this.options.maxPathLength)return{previous:new Map,closestToTarget:this.closestToTarget,steps:this.steps,maxPathLengthReached:!0};this.updateClosestToTarget(h,n);for(let l of this.getNeighborsInternal(h,s.get(z.toString(h)),n)){let f=z.toString(l.p),d=Rn(this.g,h)+l.dist;(!this.g.has(f)||d<Rn(this.g,l.p))&&(s.set(f,h),this.g.set(f,d),this.f.set(f,d+this.distance(l.p.position,n.position)),this.openSet.push(l.p))}}return{previous:s,closestToTarget:this.closestToTarget,steps:this.steps,maxPathLengthReached:!1}}updateClosestToTarget(e,n){let s=this.distance(e.position,n.position);s<this.smallestDistToTarget&&(this.smallestDistToTarget=s,this.closestToTarget=e)}addIfNotBlocked(e,n,s){this.blockOrTrans(n,s)||e.add(s)}blockOrTrans(e,n){return this.isBlocking(e,n)||this.getTransition(n.position,n.layer)!==void 0}getNeighborsInternal(e,n,s){if(!n||e.layer!==n.layer)return this.getNeighbors(e,s).map(l=>({p:l,dist:1}));let a=this.prune(n,e).map(l=>{let f=this.getTransition(l.position,e.layer);return{position:l.position,layer:f||e.layer}}),h=[];for(let l of a){let f=this.jump(e,l,s,1);f&&h.push(f)}return h}jump(e,n,s,a){let h=this.distanceUtils.direction(e.position,n.position);if(!(this.isBlocking(e,n)&&!(z.equal(n,s)&&this.options.ignoreBlockedTarget)))return z.equal(n,s)?{p:n,dist:a}:a>=this.maxJumpSize?{p:n,dist:a}:this.getTransition(n.position,e.layer)!==void 0?{p:n,dist:a}:lu(h)?{p:n,dist:a}:this.hasForced(e,n)?{p:n,dist:a}:(this.updateClosestToTarget(n,s),this.jump(n,this.getTilePosInDir(n,re(e.position,n.position)),s,a+1))}getForced(e,n){let s=new Set,a=this.posInDir(n,this.distanceUtils.direction(n.position,e.position)),{topLeft:h,downLeft:l,top:f,bottom:d}=this.normalizedPositions(a,n),y=this.distanceUtils.direction(e.position,n.position);return fu(y)&&((this.blockOrTrans(a,l)||this.blockOrTrans(l,d))&&this.addIfNotBlocked(s,n,d),(this.blockOrTrans(a,h)||this.blockOrTrans(h,f))&&this.addIfNotBlocked(s,n,f)),s}hasForced(e,n){let s=this.posInDir(n,this.distanceUtils.direction(n.position,e.position)),{topLeft:a,downLeft:h,top:l,bottom:f}=this.normalizedPositions(s,n),d=this.distanceUtils.direction(e.position,n.position);return!!(fu(d)&&((this.blockOrTrans(s,h)||this.blockOrTrans(h,f))&&!this.blockOrTrans(n,f)||(this.blockOrTrans(s,a)||this.blockOrTrans(a,l))&&!this.blockOrTrans(n,l)))}prune(e,n){let{right:s,top:a,bottom:h}=this.normalizedPositions(e,n),l=this.getForced(e,n),f=re(e.position,n.position);return lu(f)?[s,a,h]:[s,...l]}normalizedPositions(e,n){var a,h,l,f,d,y,b;let s=re(e.position,n.position);return{topLeft:this.posInDir(n,((a=this.turnTimes.get("up-left"))==null?void 0:a.get(this.turnOrder[s]))||"up-left"),downLeft:this.posInDir(n,((h=this.turnTimes.get("down-left"))==null?void 0:h.get(this.turnOrder[s]))||"down-left"),downRight:this.posInDir(n,((l=this.turnTimes.get("down-right"))==null?void 0:l.get(this.turnOrder[s]))||"down-right"),topRight:this.posInDir(n,((f=this.turnTimes.get("up-right"))==null?void 0:f.get(this.turnOrder[s]))||"up-right"),top:this.posInDir(n,((d=this.turnTimes.get("up"))==null?void 0:d.get(this.turnOrder[s]))||"up"),bottom:this.posInDir(n,((y=this.turnTimes.get("down"))==null?void 0:y.get(this.turnOrder[s]))||"down"),right:this.posInDir(n,((b=this.turnTimes.get("right"))==null?void 0:b.get(this.turnOrder[s]))||"right")}}posInDir(e,n){return{position:e.position.add(We(n)),layer:e.layer}}returnPath(e,n,s){let a=[],h=s;for(a.push(h);!z.equal(h,n);){let l=e.get(z.toString(h));if(!l)return[];this.distance(l.position,h.position)>1?this.fillPath(h,l,a):a.push(l),h=l}return a.reverse()}fillPath(e,n,s){let a=e;do{let h=re(a.position,n.position);a=this.getTilePosInDir(a,h),s.push(a)}while(!xt.equal(a.position,n.position))}};function Rn(r,t){var e;return(e=r.get(z.toString(t)))!=null?e:Number.MAX_VALUE}function LS(){let r=["right","down-right","down","down-left","left","up-left","up","up-right"],t=new Map;for(let e=0;e<r.length;e++){let n=new Map,s=r[e];n.set(0,s);for(let a=1;a<=7;a++)s=Di(s),n.set(a,s);t.set(r[e],n)}return t}var Os=class{constructor(t,e,n,s={}){this.character=t;this.gridTilemap=e;this.charToFollow=n;let a={distance:0,noPathFoundStrategy:"STOP",maxPathLength:1/0,shortestPathAlgorithm:"BIDIRECTIONAL_SEARCH",ignoreLayers:!1,considerCosts:s.considerCosts||!1,facingDirection:"none"};this.options=it(it({},a),s),this.options.considerCosts&&this.options.shortestPathAlgorithm!=="A_STAR"&&console.warn(`GridEngine: Pathfinding option 'considerCosts' cannot be used with algorithm '${this.options.shortestPathAlgorithm}'. It can only be used with A* algorithm.`),this.character=t,this.updateTarget(this.charToFollow.getTilePos().position,this.charToFollow.getTilePos().layer),this.charToFollow.positionChangeStarted().pipe(Dt(this.character.autoMovementSet().pipe(Ht(h=>h!==this),pe(1)))).subscribe(({enterTile:h,enterLayer:l})=>{this.updateTarget(h,l)})}update(t){var e;(e=this.targetMovement)==null||e.update(t)}getInfo(){return{type:"Follow",config:{charToFollow:this.charToFollow.getId(),distance:this.options.distance,noPathFoundStrategy:this.options.noPathFoundStrategy,maxPathLength:this.options.maxPathLength,ignoreLayers:this.options.ignoreLayers,facingDirection:this.options.facingDirection,shortestPathAlgorithm:this.options.shortestPathAlgorithm}}}updateTarget(t,e){let n=this.options.facingDirection!=="none"&&this.options.distance===0;if(n){let s=wn[this.options.facingDirection]+wn[this.charToFollow.getFacingDirection()],a=Di("up",s);t=this.gridTilemap.getTilePosInDirection({position:new D(t),layer:e},a).position}this.targetMovement=new Yi(this.character,this.gridTilemap,{position:new D(t),layer:e},{distance:n?0:this.options.distance+1,config:{algorithm:this.options.shortestPathAlgorithm,noPathFoundStrategy:this.options.noPathFoundStrategy,maxPathLength:this.options.maxPathLength,ignoreLayers:this.options.ignoreLayers,considerCosts:this.options.considerCosts},ignoreBlockedTarget:!0})}};var zn=class{static getRandomInt(t){return Math.floor(Math.random()*Math.floor(t))}};var As=class{constructor(t,e=0,n=-1){this.character=t;this.delay=e;this.radius=n;this.stepSize=0;this.delayLeft=this.delay,this.initialRow=t.getNextTilePos().position.y,this.initialCol=t.getNextTilePos().position.x,this.randomizeStepSize(),this.stepsWalked=0,this.currentMovementDirection="none",this.character.positionChangeStarted().pipe(Dt(this.character.autoMovementSet().pipe(Ht(s=>s!==this),pe(1)))).subscribe(()=>{this.stepsWalked++}),this.distanceUtils=ie.create(t.getNumberOfDirections())}update(t){if(this.shouldContinueWalkingCurrentDirection())this.character.move(this.currentMovementDirection);else if(this.delayLeft-=t,this.delayLeft<=0){this.delayLeft=this.delay;let e=this.getFreeRandomDirection();this.stepsWalked=0,this.character.move(e),this.currentMovementDirection=e,this.randomizeStepSize()}}getInfo(){return{type:"Random",config:{delay:this.delay,radius:this.radius}}}shouldContinueWalkingCurrentDirection(){return this.stepsWalked<this.stepSize&&this.currentMovementDirection!=="none"&&!this.character.isBlockingDirection(this.currentMovementDirection)&&this.isWithinRadius(this.currentMovementDirection)}getFreeDirections(){return this.distanceUtils.getDirections().filter(e=>!this.character.isBlockingDirection(e)).filter(e=>this.isWithinRadius(e))}isWithinRadius(t){return this.radius==-1?!0:this.getDist(t)<=this.radius}getDist(t){return this.distanceUtils.distance(this.character.getNextTilePos().position.add(We(t)),new D(this.initialCol,this.initialRow))}getFreeRandomDirection(){let t=this.getFreeDirections();return t.length==0?"none":t[zn.getRandomInt(t.length)]}randomizeStepSize(){this.stepSize=zn.getRandomInt(this.radius)+1}};function Kd(r,t){return r.filter(e=>{var n,s,a,h,l,f;return(n=t.labels)!=null&&n.withAllLabels?(s=t.labels)==null?void 0:s.withAllLabels.every(d=>e.hasLabel(d)):(a=t.labels)!=null&&a.withOneOfLabels?(h=t.labels)==null?void 0:h.withOneOfLabels.some(d=>e.hasLabel(d)):(l=t.labels)!=null&&l.withNoneLabels?!((f=t.labels)!=null&&f.withNoneLabels.some(d=>e.hasLabel(d))):!0})}var Is="2.44.1";var Ds=class{constructor(t,e){this.collistionStrategy=t;this.collisionGroupRelation=e;this.tilePosToCharacters=new Map;this.charRemoved$=new nt}isCharBlockingAt(t,e,n,s=new Set,a=new Set){if(n.length===0)return!1;let h=this.posToString(t,e),l=this.tilePosToCharacters.get(h);return!!(l&&l.size>0&&[...l].filter(f=>!s.has(f.getId())).filter(f=>!this.doIntersect(f.getCollisionGroups(),a)).some(f=>n.some(d=>f.getCollisionGroups().some(y=>this.collidesWith(d,y)))))}doIntersect(t,e){for(let n of t)if(e.has(n))return!0;return!1}collidesWith(t,e){return this.collisionGroupRelation?(this.collisionGroupRelation.get(t)||new Set).has(e):t===e}getCharactersAt(t,e){let n=this.posToString(t,e),s=this.tilePosToCharacters.get(n);return new Set(s)}addCharacter(t){this.addTilePositions(t.getTilePos(),t),this.addTilePositions(t.getNextTilePos(),t),this.addPositionChangeSub(t),this.addPositionChangeFinishedSub(t),this.addTilePosSetSub(t)}removeCharacter(t){let e=t.getId();this.charRemoved$.next(e),this.deleteTilePositions(t.getTilePos(),t),this.deleteTilePositions(t.getNextTilePos(),t)}add(t,e){var n;this.tilePosToCharacters.has(t)||this.tilePosToCharacters.set(t,new Set),(n=this.tilePosToCharacters.get(t))==null||n.add(e)}addTilePosSetSub(t){t.tilePositionSet().pipe(Dt(this.charRemoved(t.getId()))).subscribe(e=>{this.deleteTilePositions(t.getNextTilePos(),t),this.addTilePositions(e,t)})}charRemoved(t){var e;return(e=this.charRemoved$)==null?void 0:e.pipe(pe(1),Ht(n=>n==t))}addPositionChangeSub(t){t.positionChangeStarted().pipe(Dt(this.charRemoved(t.getId())),this.posChangeToLayerPos()).subscribe(e=>{this.collistionStrategy==="BLOCK_ONE_TILE_AHEAD"&&this.deleteTilePositions(e.exit,t),this.addTilePositions(e.enter,t)})}addPositionChangeFinishedSub(t){t.positionChangeFinished().pipe(Dt(this.charRemoved(t.getId())),this.posChangeToLayerPos()).subscribe(e=>{this.deleteTilePositions(e.exit,t),this.addTilePositions(e.enter,t)})}addTilePositions(t,e){this.forEachCharTile(t,e,(n,s)=>{this.add(this.posToString(new D(n,s),t.layer),e)})}deleteTilePositions(t,e){this.forEachCharTile(t,e,(n,s)=>{var a;(a=this.tilePosToCharacters.get(this.posToString(new D(n,s),t.layer)))==null||a.delete(e)})}forEachCharTile(t,e,n){let s=t.position;for(let a=s.x;a<s.x+e.getTileWidth();a++)for(let h=s.y;h<s.y+e.getTileHeight();h++)n(a,h)}posChangeToLayerPos(){return vu(ir(t=>({enter:{position:new D(t.enterTile),layer:t.enterLayer},exit:{position:new D(t.exitTile),layer:t.exitLayer}})))}posToString(t,e){return`${t.x}#${t.y}#${e}`}};var Qr=class{constructor(t,e,n,s){this.x=t;this.y=e;this.width=n;this.height=s}getX(){return this.x}getY(){return this.y}getWidth(){return this.width}getHeight(){return this.height}isInRange(t){return t.x>=this.x&&t.x<this.x+this.width&&t.y>=this.y&&t.y<this.y+this.height}};var Ki="ge_charLayer";var Xd=0,OS=1,ih={none:1,left:2,"up-left":3,up:4,"up-right":5,right:6,"down-right":7,down:8,"down-left":9},ks=class{constructor(t,e){this.tilemap=t;this.gridTilemap=e;this.tileCollisionCache=new Map}fixLayer(t){this.fixedLayer=this.tileCollisionCache.get(t)}unfixLayers(){this.fixedLayer=void 0}rebuild(t){t||(t=new Qr(0,0,this.tilemap.getWidth(),this.tilemap.getHeight()));let e=this.tilemap.getLayers().filter(n=>n.isCharLayer());for(let n of[...e,void 0]){let s=this.tileCollisionCache.get(n==null?void 0:n.getName());if(s===void 0){s=new Array(this.tilemap.getWidth());for(let a=0;a<this.tilemap.getWidth();a++)s[a]=new Array(this.tilemap.getHeight());this.tileCollisionCache.set(n==null?void 0:n.getName(),s)}for(let a=t.getY();a<t.getY()+t.getHeight();a++)for(let h=t.getX();h<t.getX()+t.getWidth();h++){let l=0;!this.gridTilemap.hasNoTileUncached(new D(h,a),n==null?void 0:n.getName())&&(l=nh(l,0));for(let y of xn())this.gridTilemap.hasBlockingTileUncached(new D(h,a),n==null?void 0:n.getName(),y,!0)&&(l=nh(l,ih[y]));this.gridTilemap.hasBlockingTileUncached(new D(h,a),n==null?void 0:n.getName(),void 0,!0)&&(l=nh(l,ih[1])),s[h][a]=l}}}hasTileAt(t,e,n){var h;let s=this.fixedLayer||this.tileCollisionCache.get(n),a=(h=s==null?void 0:s[t])==null?void 0:h[e];if(a!==void 0)return Ms(a,Xd)}isBlockingFrom(t,e,n,s,a){var f;let h=this.fixedLayer||this.tileCollisionCache.get(n),l=(f=h==null?void 0:h[t])==null?void 0:f[e];if(l!==void 0)return!a&&!Ms(l,Xd)?!0:s===void 0?Ms(l,OS):Ms(l,ih[s])}};function nh(r,t){return r|1<<t}function Ms(r,t){return(r>>t&1)==1}var Jd="ge_cost",Rs=class Rs{constructor(t,e,n,s=void 0,a=!1){this.tilemap=t;this.collisionTilePropertyName=e;this.useTileCollisionCache=a;this.characters=new Map;this.transitions=new Map;this.reverseTransitions=new Map;this.collidesPropNames=new Map;this.tileCostPropNames=new Map;this.collisionRelevantLayersFrameCache=new Map;this.charBlockCache=new Ds(n,s);for(let h of xn())this.collidesPropNames.set(h,Rs.ONE_WAY_COLLIDE_PROP_PREFIX+h),this.tileCostPropNames.set(h,`${Jd}_${h}`);this.useTileCollisionCache&&(this.tileCollisionCache=new ks(t,this),this.tileCollisionCache.rebuild())}fixCacheLayer(t){var e;(e=this.tileCollisionCache)==null||e.fixLayer(t)}unfixCacheLayers(){var t;(t=this.tileCollisionCache)==null||t.unfixLayers()}addCharacter(t){this.characters.set(t.getId(),t);let e=t.getNextTilePos().layer;e===void 0?t.setTilePosition(Pe(it({},t.getNextTilePos()),{layer:this.getLowestCharLayer()})):this.getCharLayerNames().includes(e)||console.warn(`Char layer '${e}' of character '${t.getId()}' is unknown.`),this.charBlockCache.addCharacter(t)}removeCharacter(t){let e=this.characters.get(t);e&&(this.charBlockCache.removeCharacter(e),this.characters.delete(t))}getCharacters(){return[...this.characters.values()]}getCharactersAt(t,e){return this.charBlockCache.getCharactersAt(t,e)}rebuildTileCollisionCache(t){var e;(e=this.tileCollisionCache)==null||e.rebuild(t)}hasBlockingTileUncached(t,e,n,s){if(!s&&this.hasNoTileUncached(t,e))return!0;let a=this.getCollisionRelevantLayers(e);for(let h of a)if(this.isLayerBlockingAt(h.getName(),t,n))return!0;return!1}hasBlockingTile(t,e,n,s){var h;let a=(h=this.tileCollisionCache)==null?void 0:h.isBlockingFrom(t.x,t.y,e,n,s);return a!==void 0?a:this.hasBlockingTileUncached(t,e,n,s)}getTransition(t,e){let n=this.transitions.get(t.toString());if(n)return n.get(e)}getReverseTransitions(t,e){let n=this.reverseTransitions.get(t.toString());if(n)return n.get(e)}setTransition(t,e,n){var s,a,h,l,f;this.transitions.has(t.toString())||this.transitions.set(t.toString(),new Map),this.reverseTransitions.has(t.toString())||this.reverseTransitions.set(t.toString(),new Map),(s=this.transitions.get(t.toString()))==null||s.set(e,n),(a=this.reverseTransitions.get(t.toString()))!=null&&a.has(n)||(h=this.reverseTransitions.get(t.toString()))==null||h.set(n,new Set),(f=(l=this.reverseTransitions.get(t.toString()))==null?void 0:l.get(n))==null||f.add(e)}getTransitions(){return new Map([...this.transitions].map(([t,e])=>[t,new Map(e)]))}getTileCosts(t,e){let n=this.getCollisionRelevantLayers(t.layer),s=1;for(let a of n)s=Math.max(s,this.getTileCostsForLayer(Pe(it({},t),{layer:a.getName()}),e));return s}getTileCostsForLayer(t,e){let n=this.tilemap.getTileAt(t.position.x,t.position.y,t.layer);return e&&(n==null?void 0:n.getProperty(this.tileCostPropNames.get(e)||""))||(n==null?void 0:n.getProperty(Jd))||1}hasNoTileUncached(t,e){return!this.getCollisionRelevantLayers(e).some(s=>this.tilemap.hasTileAt(t.x,t.y,s.getName()))}hasNoTile(t,e){var s;let n=(s=this.tileCollisionCache)==null?void 0:s.hasTileAt(t.x,t.y,e);return n!==void 0?n:this.hasNoTileUncached(t,e)}hasBlockingChar(t,e,n,s=new Set,a=new Set){return this.charBlockCache.isCharBlockingAt(t,e,n,s,a)}isInRange(t){return new Qr(0,0,this.tilemap.getWidth(),this.tilemap.getHeight()).isInRange(t)}toMapDirection(t){return this.isIsometric()?Xl(t):t}fromMapDirection(t){return this.isIsometric()?Di(t):t}isIsometric(){return this.tilemap.getOrientation()==="isometric"}getTilePosInDirection(t,e){let n=t.position.add(We(this.toMapDirection(e))),s=this.getTransition(n,t.layer)||t.layer;return{position:n,layer:s}}invalidateFrameCache(){this.collisionRelevantLayersFrameCache.clear()}isLayerBlockingAt(t,e,n){let s=this.tilemap.getTileAt(e.x,e.y,t);return s?!!(s.getProperty(this.collisionTilePropertyName)||n&&s.getProperty(this.collidesPropNames.get(n)||"")):!1}getCharLayerIndexes(){return this.tilemap.getLayers().map((t,e)=>({layer:t,index:e})).filter(({layer:t})=>t.isCharLayer()).map(({index:t})=>t)}findPrevAndCharLayer(t){let e=this.getCharLayerIndexes(),n=this.tilemap.getLayers(),s=e.findIndex(a=>n[a].getProperty(Ki)==t);return s==0?{prevIndex:-1,charLayerIndex:e[s]}:{prevIndex:e[s-1],charLayerIndex:e[s]}}getCollisionRelevantLayers(t){if(!t)return this.tilemap.getLayers();let e=this.collisionRelevantLayersFrameCache.get(t);if(e)return e;let{prevIndex:n,charLayerIndex:s}=this.findPrevAndCharLayer(t),a=this.tilemap.getLayers().slice(n+1,s+1);return this.collisionRelevantLayersFrameCache.set(t,a),a}getLowestCharLayer(){for(let t of this.tilemap.getLayers())if(t.isCharLayer())return t.getProperty(Ki)}getCharLayerNames(){return this.tilemap.getLayers().filter(t=>t.isCharLayer()).map(t=>t.getProperty(Ki)).filter(AS)}};Rs.ONE_WAY_COLLIDE_PROP_PREFIX="ge_collide_";var Fs=Rs;function AS(r){return r!=null}var oh=(e=>(e.REMOVED="REMOVED",e.ADDED="ADDED",e))(oh||{});var Zd=(n=>(n.WAIT="WAIT",n.SKIP="SKIP",n.STOP="STOP",n))(Zd||{}),zs=class{constructor(t,e){this.character=t;this.tilemap=e;this.queue=new Lr;this.finished$=new nt;this.pathBlockedWaitElapsed=0;this.distanceUtils=ie.create(t.getNumberOfDirections()),this.character.autoMovementSet().pipe(Ht(n=>n!==this),pe(1)).subscribe(()=>{this.queue.size()>0&&this.finishMovementTerminated(),this.finished$.complete()})}update(t){(!this.character.isMoving()||this.character.willCrossTileBorderThisUpdate(t))&&this.queue.size()>0&&this.moveCharOnPath(t)}getInfo(){return{type:"Queue"}}enqueue(t,e={}){var s,a,h;let n={pathBlockedStrategy:(s=e.pathBlockedStrategy)!=null?s:"STOP",pathBlockedWaitTimeoutMs:(e==null?void 0:e.pathBlockedWaitTimeoutMs)||-1,ignoreInvalidPositions:(a=e.ignoreInvalidPositions)!=null?a:!1,skipInvalidPositions:(h=e.skipInvalidPositions)!=null?h:!1};for(let l of t){let f={command:l,config:n};if(Ur(l)){this.queue.enqueue(f);continue}let d=this.queue.peekEnd(),y=d==null?void 0:d.command;if(y||(y=this.character.getNextTilePos()),Ur(y)){this.queue.enqueue(f);continue}let b=this.distanceUtils.distance(y.position,l.position)===1;(!e.ignoreInvalidPositions||b)&&this.queue.enqueue(f)}}peekAll(){return this.queue.peekAll()}size(){return this.queue.size()}finished(){return this.finished$}clear(){this.queue.clear()}moveCharOnPath(t){let e=this.queue.peek();if(!e)return;let n=e.command,s=e.config;if(Ur(n)&&(n=this.tilemap.getTilePosInDirection(this.character.getNextTilePos(),n)),s.skipInvalidPositions){if(n=this.getNextValidPosition(),!n){this.finishInvalidNextPos(n);return}}else if(!this.isNeighborPos(n)){this.finishInvalidNextPos(n);return}if(this.character.isBlockingDirection(re(this.character.getNextTilePos().position,n.position))){if(s.pathBlockedStrategy==="STOP")this.finishPathBlocked(n);else if(s.pathBlockedStrategy==="SKIP"){this.queue.dequeue(),this.moveCharOnPath(t);return}else s.pathBlockedStrategy==="WAIT"&&s.pathBlockedWaitTimeoutMs>-1&&(this.pathBlockedWaitElapsed+=t,this.pathBlockedWaitElapsed>=s.pathBlockedWaitTimeoutMs&&this.finishBlockedWaitTimeout(n,s.pathBlockedWaitTimeoutMs));return}this.pathBlockedWaitElapsed=0,this.queue.dequeue(),this.character.move(this.getDir(this.character.getNextTilePos().position,n.position)),this.isLastMovement()&&this.finish("SUCCESS","",n)}getNextValidPosition(){var t;for(;this.queue.size()>0;){let e=(t=this.queue.peek())==null?void 0:t.command;if(Ur(e)&&(e=this.tilemap.getTilePosInDirection(this.character.getNextTilePos(),e)),e&&this.isNeighborPos(e))return e;this.queue.dequeue()}}isLastMovement(){return this.queue.size()===0}isNeighborPos(t){let e=this.distanceUtils.distance(this.character.getNextTilePos().position,t.position)===1,n=this.tilemap.getTransition(t.position,this.character.getNextTilePos().layer);if(this.character.getNextTilePos().layer!==t.layer)return e&&n===t.layer;let s=n!==void 0&&n!==t.layer;return e&&!s}finishMovementTerminated(){this.finish("MOVEMENT_TERMINATED","New automatic movement has been set to character.")}finishInvalidNextPos(t){t?this.finish("INVALID_NEXT_POS",`Position ${this.posToStr(t)} is not reachable from ${this.posToStr(this.character.getNextTilePos())}.`):this.finish("INVALID_NEXT_POS",`No enqueued position is reachable from ${this.posToStr(this.character.getNextTilePos())}.`)}finishPathBlocked(t){this.finish("PATH_BLOCKED",`Position ${this.posToStr(t)} is blocked.`)}finishBlockedWaitTimeout(t,e){this.finish("PATH_BLOCKED_WAIT_TIMEOUT",`Position ${this.posToStr(t)} is blocked and the wait timeout of ${e} ms has been exceeded.`)}finish(t,e="",n=this.character.getNextTilePos()){this.queue=new Lr,this.finished$.next({position:n.position,result:t,description:e,layer:n.layer})}getDir(t,e){return this.tilemap.fromMapDirection(re(t,e))}posToStr(t){return`(${t.position.x}, ${t.position.y}, ${t.layer})`}};var Ns=class{constructor(t=!0){this.isCreatedInternal=!1;t&&console.log(`Using GridEngine v${Is}`)}getCharLayer(t){var n;this.initGuard();let e=(n=this.gridCharacters)==null?void 0:n.get(t);if(!e)throw this.createCharUnknownErr(t);return e.getTilePos().layer}getTransition(t,e){var n;return this.initGuard(),(n=this.gridTilemap)==null?void 0:n.getTransition(new D(t),e)}setTransition(t,e,n){var s;return this.initGuard(),(s=this.gridTilemap)==null?void 0:s.setTransition(new D(t),e,n)}create(t,e){this.isCreatedInternal=!0,this.gridCharacters=new Map;let n=this.setConfigDefaults(e);this.config=n,this.movementStopped$=new nt,this.movementStarted$=new nt,this.directionChanged$=new nt,this.positionChangeStarted$=new nt,this.positionChangeFinished$=new nt,this.queueMovementFinished$=new nt,this.charRemoved$=new nt,this.charAdded$=new nt,this.gridTilemap=new Fs(t,this.config.collisionTilePropertyName,this.config.characterCollisionStrategy,this.recordToMap(this.config.collisionGroupRelation),this.config.cacheTileCollisions),this.addCharacters()}recordToMap(t){return t?new Map(Object.entries(t).map(([n,s])=>[n,new Set(s)])):void 0}getPosition(t){var n;this.initGuard();let e=(n=this.gridCharacters)==null?void 0:n.get(t);if(!e)throw this.createCharUnknownErr(t);return e.getTilePos().position}move(t,e){this.moveChar(t,e)}moveRandomly(t,e=0,n=-1){var h;this.initGuard();let s=(h=this.gridCharacters)==null?void 0:h.get(t);if(!s)throw this.createCharUnknownErr(t);let a=new As(s,e,n);s.setMovement(a)}getMovement(t){var s;this.initGuard();let e=(s=this.gridCharacters)==null?void 0:s.get(t);if(!e)throw this.createCharUnknownErr(t);let n=e.getMovement();return n?n.getInfo():{type:"None"}}moveTo(t,e,n){var l;let s=this.assembleMoveToConfig(n);this.initGuard();let a=(l=this.gridCharacters)==null?void 0:l.get(t);if(!a)throw this.createCharUnknownErr(t);if(!this.gridTilemap)throw this.createUninitializedErr();let h=new Yi(a,this.gridTilemap,{position:new D(e),layer:(n==null?void 0:n.targetLayer)||a.getNextTilePos().layer},{distance:0,config:s});return a.setMovement(h),h.finishedObs().pipe(ir(f=>({charId:t,position:f.position,result:f.result,description:f.description,layer:f.layer})))}stopMovement(t){var n;this.initGuard();let e=(n=this.gridCharacters)==null?void 0:n.get(t);if(!e)throw this.createCharUnknownErr(t);e.setMovement(void 0)}setSpeed(t,e){var s;this.initGuard();let n=(s=this.gridCharacters)==null?void 0:s.get(t);if(!n)throw this.createCharUnknownErr(t);n.setSpeed(e)}getSpeed(t){var n;this.initGuard();let e=(n=this.gridCharacters)==null?void 0:n.get(t);if(!e)throw this.createCharUnknownErr(t);return e.getSpeed()}collidesWithTiles(t){var n;this.initGuard();let e=(n=this.gridCharacters)==null?void 0:n.get(t);if(!e)throw this.createCharUnknownErr(t);return e.collidesWithTiles()}update(t,e){var n;if(this.isCreatedInternal&&this.gridCharacters)for(let[s,a]of this.gridCharacters)a.update(e);(n=this.gridTilemap)==null||n.invalidateFrameCache()}addCharacter(t){var a,h,l,f,d;if(!this.gridTilemap)throw this.createUninitializedErr();if(!this.config)throw this.createUninitializedErr();let e={speed:t.speed||4,tilemap:this.gridTilemap,collidesWithTiles:!0,collisionGroups:["geDefault"],ignoreCollisionGroups:[],charLayer:t.charLayer,facingDirection:t.facingDirection,labels:t.labels,numberOfDirections:(a=t.numberOfDirections)!=null?a:this.config.numberOfDirections,tileWidth:t.tileWidth,tileHeight:t.tileHeight};typeof t.collides=="boolean"?t.collides===!1&&(e.collidesWithTiles=!1,e.collisionGroups=[]):t.collides!==void 0&&(t.collides.collidesWithTiles===!1&&(e.collidesWithTiles=!1),t.collides.collisionGroups&&(e.collisionGroups=t.collides.collisionGroups),t.collides.ignoreCollisionGroups&&(e.ignoreCollisionGroups=t.collides.ignoreCollisionGroups),e.ignoreMissingTiles=(l=(h=t.collides)==null?void 0:h.ignoreMissingTiles)!=null?l:!1);let n=new us(t.id,e);t.startPosition&&n.setTilePosition({position:new D(t.startPosition),layer:n.getTilePos().layer}),(f=this.gridCharacters)==null||f.set(t.id,n),this.gridTilemap.addCharacter(n);let s=n.getId();n.movementStopped().pipe(Dt(this.charRemoved(s))).subscribe(y=>{var b;(b=this.movementStopped$)==null||b.next({charId:s,direction:y})}),n.movementStarted().pipe(Dt(this.charRemoved(s))).subscribe(y=>{var b;(b=this.movementStarted$)==null||b.next({charId:s,direction:y})}),n.directionChanged().pipe(Dt(this.charRemoved(s))).subscribe(y=>{var b;(b=this.directionChanged$)==null||b.next({charId:s,direction:y})}),n.positionChangeStarted().pipe(Dt(this.charRemoved(s))).subscribe(y=>{var b;(b=this.positionChangeStarted$)==null||b.next(it({charId:s},y))}),n.positionChangeFinished().pipe(Dt(this.charRemoved(s))).subscribe(y=>{var b;(b=this.positionChangeFinished$)==null||b.next(it({charId:s},y))}),(d=this.charAdded$)==null||d.next(s)}hasCharacter(t){var e;return this.initGuard(),!!((e=this.gridCharacters)!=null&&e.has(t))}removeCharacter(t){var n,s,a,h;if(this.initGuard(),!((n=this.gridCharacters)==null?void 0:n.get(t)))throw this.createCharUnknownErr(t);(s=this.gridTilemap)==null||s.removeCharacter(t),(a=this.gridCharacters)==null||a.delete(t),(h=this.charRemoved$)==null||h.next(t)}removeAllCharacters(){if(this.initGuard(),!!this.gridCharacters)for(let t of this.gridCharacters.keys())this.removeCharacter(t)}getAllCharacters(t){if(this.initGuard(),!this.gridCharacters)return[];let e=[...this.gridCharacters.values()];return(t?Kd(e,t):e).map(s=>s.getId())}getLabels(t){var n;this.initGuard();let e=(n=this.gridCharacters)==null?void 0:n.get(t);if(!e)throw this.createCharUnknownErr(t);return e.getLabels()}addLabels(t,e){var s;this.initGuard();let n=(s=this.gridCharacters)==null?void 0:s.get(t);if(!n)throw this.createCharUnknownErr(t);n.addLabels(e)}removeLabels(t,e){var s;this.initGuard();let n=(s=this.gridCharacters)==null?void 0:s.get(t);if(!n)throw this.createCharUnknownErr(t);n.removeLabels(e)}clearLabels(t){var n;this.initGuard();let e=(n=this.gridCharacters)==null?void 0:n.get(t);if(!e)throw this.createCharUnknownErr(t);e.clearLabels()}follow(t,e,n,s){var d,y,b,S,C,A;let a;n===void 0?a={distance:0,closestPointIfBlocked:!1}:typeof n=="number"?(a={distance:n,closestPointIfBlocked:!1},s&&(a.closestPointIfBlocked=!0)):a=n,this.initGuard();let h=(d=this.gridCharacters)==null?void 0:d.get(t),l=(y=this.gridCharacters)==null?void 0:y.get(e);if(!h)throw this.createCharUnknownErr(t);if(!l)throw this.createCharUnknownErr(e);if(!this.gridTilemap)throw this.createUninitializedErr();let f=new Os(h,this.gridTilemap,l,{distance:(b=a.distance)!=null?b:0,noPathFoundStrategy:a.closestPointIfBlocked?"CLOSEST_REACHABLE":"STOP",maxPathLength:(S=a.maxPathLength)!=null?S:1/0,shortestPathAlgorithm:(C=a.algorithm)!=null?C:"BIDIRECTIONAL_SEARCH",ignoreLayers:!!a.ignoreLayers,facingDirection:(A=a.facingDirection)!=null?A:"none"});h.setMovement(f)}isMoving(t){var n;this.initGuard();let e=(n=this.gridCharacters)==null?void 0:n.get(t);if(!e)throw this.createCharUnknownErr(t);return e.isMoving()}getFacingDirection(t){var n;this.initGuard();let e=(n=this.gridCharacters)==null?void 0:n.get(t);if(!e)throw this.createCharUnknownErr(t);return e.getFacingDirection()}getFacingPosition(t){var s;this.initGuard();let e=(s=this.gridCharacters)==null?void 0:s.get(t);if(!e)throw this.createCharUnknownErr(t);let n=e.getFacingPosition();return{x:n.x,y:n.y}}turnTowards(t,e){var s;this.initGuard();let n=(s=this.gridCharacters)==null?void 0:s.get(t);if(!n)throw this.createCharUnknownErr(t);return n.turnTowards(e)}getCharactersAt(t,e){if(this.initGuard(),!this.gridTilemap)return[];let n=this.gridTilemap.getCharactersAt(new D(t),e);return Array.from(n).map(s=>s.getId())}setPosition(t,e,n){var a;this.initGuard();let s=(a=this.gridCharacters)==null?void 0:a.get(t);if(!s)throw this.createCharUnknownErr(t);n||s.setTilePosition({position:new D(e),layer:s.getTilePos().layer}),s.setTilePosition({position:new D(e),layer:n})}isBlocked(t,e,n=["geDefault"]){var a,h;this.initGuard();let s=new D(t);return!!((a=this.gridTilemap)!=null&&a.hasBlockingTile(s,e)||(h=this.gridTilemap)!=null&&h.hasBlockingChar(s,e,n))}isTileBlocked(t,e){var n;return this.initGuard(),!!((n=this.gridTilemap)!=null&&n.hasBlockingTile(new D(t),e))}getCollisionGroups(t){var n;this.initGuard();let e=(n=this.gridCharacters)==null?void 0:n.get(t);if(!e)throw this.createCharUnknownErr(t);return e.getCollisionGroups()||[]}setCollisionGroups(t,e){var s;this.initGuard();let n=(s=this.gridCharacters)==null?void 0:s.get(t);if(!n)throw this.createCharUnknownErr(t);n.setCollisionGroups(e)}getIgnoreCollisionGroups(t){var n;this.initGuard();let e=(n=this.gridCharacters)==null?void 0:n.get(t);if(!e)throw this.createCharUnknownErr(t);return e.getIgnoreCollisionGroups()||[]}setIgnoreCollisionGroups(t,e){var s;this.initGuard();let n=(s=this.gridCharacters)==null?void 0:s.get(t);if(!n)throw this.createCharUnknownErr(t);n.setIgnoreCollisionGroups(e)}getTilePosInDirection(t,e,n){if(!this.gridTilemap)throw this.createUninitializedErr();let s=this.gridTilemap.getTilePosInDirection({position:new D(t),layer:e},n);return{position:s.position.toPosition(),charLayer:s.layer}}findShortestPath(t,e,n={}){if(!this.gridTilemap)throw this.createUninitializedErr();let s=n.shortestPathAlgorithm||"BFS";n.considerCosts&&s!=="A_STAR"&&console.warn(`GridEngine: Pathfinding option 'considerCosts' cannot be used with algorithm '${s}'. It can only be used with A* algorithm.`);let h=new Xi(this.gridTilemap).findShortestPath(z.toInternal(t),z.toInternal(e),Pe(it({},n),{shortestPathAlgorithm:s}));return{path:h.path.map(z.fromInternal),closestToTarget:h.closestToTarget?z.fromInternal(h.closestToTarget):void 0,reachedMaxPathLength:!1,steps:h.steps}}steppedOn(t,e,n){return this.positionChangeFinished().pipe(Ht(s=>t.includes(s.charId)&&e.some(a=>a.x===s.enterTile.x&&a.y===s.enterTile.y)&&(n===void 0||n.includes(s.enterLayer))))}characterShifted(){if(!this.charAdded$||!this.charRemoved$)throw this.createUninitializedErr();return this.charAdded$.pipe(ir(t=>({charId:t,action:"ADDED"})),wu(this.charRemoved$.pipe(ir(t=>({charId:t,action:"REMOVED"})))))}movementStarted(){if(!this.movementStarted$)throw this.createUninitializedErr();return this.movementStarted$}movementStopped(){if(!this.movementStopped$)throw this.createUninitializedErr();return this.movementStopped$}directionChanged(){if(!this.directionChanged$)throw this.createUninitializedErr();return this.directionChanged$}positionChangeStarted(){if(!this.positionChangeStarted$)throw this.createUninitializedErr();return this.positionChangeStarted$}positionChangeFinished(){if(!this.positionChangeFinished$)throw this.createUninitializedErr();return this.positionChangeFinished$}getMovementProgress(t){var n;this.initGuard();let e=(n=this.gridCharacters)==null?void 0:n.get(t);if(!e)throw this.createCharUnknownErr(t);return e.getMovementProgress()}rebuildTileCollisionCache(t,e,n,s){var a;(a=this.gridTilemap)==null||a.rebuildTileCollisionCache(new Qr(t,e,n,s))}addQueueMovements(t,e,n){var h,l;this.initGuard();let s=(h=this.gridCharacters)==null?void 0:h.get(t);if(!s)throw this.createCharUnknownErr(t);if(!this.gridTilemap)throw this.createUninitializedErr();let a;((l=s==null?void 0:s.getMovement())==null?void 0:l.getInfo().type)==="Queue"?a=s.getMovement():(a=new zs(s,this.gridTilemap),s.setMovement(a),a.finished().pipe(Dt(Pu(this.charRemoved(t),s.autoMovementSet()))).subscribe(f=>{var d;(d=this.queueMovementFinished$)==null||d.next(it({charId:t},f))})),a.enqueue(e.map(f=>Ur(f)?f:{position:new D(f.position),layer:f.charLayer}),n)}queueMovementFinished(){if(!this.queueMovementFinished$)throw this.createUninitializedErr();return this.queueMovementFinished$}getEnqueuedMovements(t){var n,s;this.initGuard();let e=(n=this.gridCharacters)==null?void 0:n.get(t);if(!e)throw this.createCharUnknownErr(t);return((s=e.getMovement())==null?void 0:s.getInfo().type)==="Queue"?e.getMovement().peekAll().map(h=>({command:Ur(h.command)?h.command:z.fromInternal(h.command),config:h.config})):[]}clearEnqueuedMovements(t){var n,s;this.initGuard();let e=(n=this.gridCharacters)==null?void 0:n.get(t);if(!e)throw this.createCharUnknownErr(t);((s=e.getMovement())==null?void 0:s.getInfo().type)==="Queue"&&e.getMovement().clear()}getTileCost(t,e,n){var s,a;return this.initGuard(),(a=(s=this.gridTilemap)==null?void 0:s.getTileCosts({position:new D(t),layer:e},n))!=null?a:1}getState(){let t=[];if(this.gridCharacters)for(let[e,n]of this.gridCharacters.entries())t.push({id:e,position:z.fromInternal(n.getTilePos()),facingDirection:n.getFacingDirection(),speed:n.getSpeed(),labels:n.getLabels(),movementProgress:n.getMovementProgress(),collisionConfig:{collisionGroups:n.getCollisionGroups(),ignoreCollisionGroups:n.getIgnoreCollisionGroups(),collidesWithTiles:n.collidesWithTiles(),ignoreMissingTiles:n.getIgnoreMissingTiles()}});return{characters:t}}setState(t){if(this.gridCharacters)for(let e of t.characters){let n=this.gridCharacters.get(e.id);if(n){let s=n.getTilePos();z.equal(s,z.toInternal(e.position))||n.setTilePosition(z.toInternal(e.position)),n.setSpeed(e.speed),n.turnTowards(e.facingDirection),e.collisionConfig.collisionGroups&&n.setCollisionGroups(e.collisionConfig.collisionGroups),e.collisionConfig.collidesWithTiles!==void 0&&n.setCollidesWithTiles(e.collisionConfig.collidesWithTiles),e.collisionConfig.ignoreMissingTiles!==void 0&&n.setIgnoreMissingTiles(e.collisionConfig.ignoreMissingTiles),n.setMovementProgress(e.movementProgress),n.clearLabels(),n.addLabels(e.labels)}}}charRemoved(t){var e;if(!this.charRemoved$)throw this.createUninitializedErr();return(e=this.charRemoved$)==null?void 0:e.pipe(pe(1),Ht(n=>n==t))}initGuard(){if(!this.isCreatedInternal)throw this.createUninitializedErr()}createUninitializedErr(){throw new Error("GridEngine not initialized. You need to call create() first.")}addCharacters(){var t;(t=this.config)==null||t.characters.forEach(e=>this.addCharacter(e))}moveChar(t,e){var s,a,h;this.initGuard();let n=(s=this.gridCharacters)==null?void 0:s.get(t);if(!n)throw this.createCharUnknownErr(t);if(n.getNumberOfDirections()===4){if(!((a=this.gridTilemap)!=null&&a.isIsometric())&&oi(e)){console.warn(`GridEngine: Character '${t}' can't be moved '${e}' in 4 direction mode.`);return}else if((h=this.gridTilemap)!=null&&h.isIsometric()&&!oi(e)){console.warn(`GridEngine: Character '${t}' can't be moved '${e}' in 4 direction isometric mode.`);return}}n.move(e)}createCharUnknownErr(t){return new Error(`Character unknown: ${t}`)}assembleMoveToConfig(t={}){let e=Pe(it({},t),{noPathFoundStrategy:"STOP",pathBlockedStrategy:"WAIT"});return t!=null&&t.noPathFoundStrategy&&(Object.values(zi).includes(t.noPathFoundStrategy)?e.noPathFoundStrategy=t.noPathFoundStrategy:console.warn(`GridEngine: Unknown NoPathFoundStrategy '${t.noPathFoundStrategy}'. Falling back to 'STOP'`)),t!=null&&t.pathBlockedStrategy&&(Object.values(On).includes(t.pathBlockedStrategy)?e.pathBlockedStrategy=t.pathBlockedStrategy:console.warn(`GridEngine: Unknown PathBlockedStrategy '${t.pathBlockedStrategy}'. Falling back to 'WAIT'`)),e}setConfigDefaults(t){return it({collisionTilePropertyName:"ge_collide",numberOfDirections:4,characterCollisionStrategy:"BLOCK_TWO_TILES",cacheTileCollisions:!1},t)}};var Vs=class extends Qi{constructor(t,e={}){super(t,e),this.distanceUtils=ie.create(8)}getForced(t,e){let n=new Set,s=this.posInDir(e,this.distanceUtils.direction(e.position,t.position)),{topLeft:a,downLeft:h,top:l,bottom:f,topRight:d,downRight:y}=this.normalizedPositions(s,e),b=this.distanceUtils.direction(t.position,e.position);return oi(b)?(this.blockOrTrans(s,a)&&(this.addIfNotBlocked(n,e,l),this.addIfNotBlocked(n,e,d),this.blockOrTrans(h,a)&&this.addIfNotBlocked(n,e,a)),this.blockOrTrans(s,h)&&(this.addIfNotBlocked(n,e,f),this.addIfNotBlocked(n,e,y),this.blockOrTrans(a,h)&&this.addIfNotBlocked(n,e,h)),this.blockOrTrans(a,l)&&this.addIfNotBlocked(n,e,l),this.blockOrTrans(h,f)&&this.addIfNotBlocked(n,e,f),this.blockOrTrans(a,d)&&this.addIfNotBlocked(n,e,d),this.blockOrTrans(h,y)&&this.addIfNotBlocked(n,e,y)):((this.blockOrTrans(s,l)||this.blockOrTrans(l,d))&&this.addIfNotBlocked(n,e,d),(this.blockOrTrans(s,f)||this.blockOrTrans(f,y))&&this.addIfNotBlocked(n,e,y),this.blockOrTrans(s,a)&&this.blockOrTrans(s,l)&&(this.addIfNotBlocked(n,e,l),this.addIfNotBlocked(n,e,a)),this.blockOrTrans(s,h)&&this.blockOrTrans(s,f)&&(this.addIfNotBlocked(n,e,f),this.addIfNotBlocked(n,e,h)),this.blockOrTrans(a,l)&&this.blockOrTrans(s,l)&&this.addIfNotBlocked(n,e,l),this.blockOrTrans(h,f)&&this.blockOrTrans(s,f)&&this.addIfNotBlocked(n,e,f)),n}hasForced(t,e){let n=this.posInDir(e,this.distanceUtils.direction(e.position,t.position)),{topLeft:s,downLeft:a,top:h,bottom:l,topRight:f,downRight:d}=this.normalizedPositions(n,e),y=this.distanceUtils.direction(t.position,e.position);if(oi(y)){if(this.blockOrTrans(n,s)&&(!this.blockOrTrans(e,h)||!this.blockOrTrans(e,f)||this.blockOrTrans(a,s)&&!this.blockOrTrans(e,s))||this.blockOrTrans(n,a)&&(!this.blockOrTrans(e,l)||!this.blockOrTrans(e,d)||this.blockOrTrans(s,a)&&!this.blockOrTrans(e,a))||this.blockOrTrans(s,h)&&!this.blockOrTrans(e,h)||this.blockOrTrans(a,l)&&!this.blockOrTrans(e,l)||this.blockOrTrans(s,f)&&!this.blockOrTrans(e,f)||this.blockOrTrans(a,d)&&!this.blockOrTrans(e,d))return!0}else if((this.blockOrTrans(n,h)||this.blockOrTrans(h,f))&&!this.blockOrTrans(e,f)||(this.blockOrTrans(n,l)||this.blockOrTrans(l,d))&&!this.blockOrTrans(e,d)||this.blockOrTrans(n,s)&&this.blockOrTrans(n,h)&&(!this.blockOrTrans(e,h)||!this.blockOrTrans(e,s))||this.blockOrTrans(n,a)&&this.blockOrTrans(n,l)&&(!this.blockOrTrans(e,l)||!this.blockOrTrans(e,a))||this.blockOrTrans(s,h)&&this.blockOrTrans(n,h)&&!this.blockOrTrans(e,h)||this.blockOrTrans(a,l)&&this.blockOrTrans(n,l)&&!this.blockOrTrans(e,l))return!0;return!1}prune(t,e){let{top:n,right:s,topRight:a,downRight:h,bottom:l}=this.normalizedPositions(t,e),f=this.getForced(t,e),d=re(t.position,e.position);return oi(d)?[n,s,a,h,l,...f]:[s,...f]}jump(t,e,n,s){let a=this.distanceUtils.direction(t.position,e.position),h=this.getTilePosInDir(e,this.distanceUtils.direction(e.position,t.position));if(!(this.isBlocking(h,e)&&!(z.equal(e,n)&&this.options.ignoreBlockedTarget))){if(z.equal(e,n))return{p:e,dist:s};if(s>=this.maxJumpSize)return{p:e,dist:s};if(this.getTransition(e.position,t.layer)!==void 0)return{p:e,dist:s};if(this.hasForced(t,e))return{p:e,dist:s};if(this.updateClosestToTarget(e,n),a==="up-left"){if(this.jump(e,this.getTilePosInDir(e,"up"),n,s+1)!==void 0)return{p:e,dist:s};if(this.jump(e,this.getTilePosInDir(e,"left"),n,s+1)!==void 0)return{p:e,dist:s}}else if(a==="down-left"){if(this.jump(e,this.getTilePosInDir(e,"down"),n,s+1)!==void 0)return{p:e,dist:s};if(this.jump(e,this.getTilePosInDir(e,"left"),n,s+1)!==void 0)return{p:e,dist:s}}else if(a==="up-right"){if(this.jump(e,this.getTilePosInDir(e,"up"),n,s+1)!==void 0)return{p:e,dist:s};if(this.jump(e,this.getTilePosInDir(e,"right"),n,s+1)!==void 0)return{p:e,dist:s}}else if(a==="down-right"){if(this.jump(e,this.getTilePosInDir(e,"down"),n,s+1)!==void 0)return{p:e,dist:s};if(this.jump(e,this.getTilePosInDir(e,"right"),n,s+1)!==void 0)return{p:e,dist:s}}return this.jump(e,this.getTilePosInDir(e,re(t.position,e.position)),n,s+1)}}};var Xi=class{constructor(t){this.gridTilemap=t}findShortestPath(t,e,n={}){return IS(n.shortestPathAlgorithm||"BIDIRECTIONAL_SEARCH",this.gridTilemap,n).findShortestPath(t,e)}};function IS(r,t,e){switch(r){case"BIDIRECTIONAL_SEARCH":return new vs(t,e);case"A_STAR":return new ms(t,e);case"JPS":return e.numberOfDirections===8?new Vs(t,e):new Qi(t,e)}return new Ni(t,e)}var sh=(f=>(f.SUCCESS="SUCCESS",f.NO_PATH_FOUND_MAX_RETRIES_EXCEEDED="NO_PATH_FOUND_MAX_RETRIES_EXCEEDED",f.PATH_BLOCKED_MAX_RETRIES_EXCEEDED="PATH_BLOCKED_MAX_RETRIES_EXCEEDED",f.PATH_BLOCKED="PATH_BLOCKED",f.NO_PATH_FOUND="NO_PATH_FOUND",f.PATH_BLOCKED_WAIT_TIMEOUT="PATH_BLOCKED_WAIT_TIMEOUT",f.MOVEMENT_TERMINATED="MOVEMENT_TERMINATED",f.MAX_PATH_LENGTH_REACHED="MAX_PATH_LENGTH_REACHED",f))(sh||{}),Yi=class{constructor(t,e,n,{config:s,ignoreBlockedTarget:a=!1,distance:h=0}={}){this.character=t;this.tilemap=e;this.targetPos=n;this.shortestPath=[];this.distOffset=0;this.posOnPath=0;this.stopped=!1;this.pathBlockedWaitElapsed=0;this.isPositionAllowed=()=>!0;this.shortestPathAlgorithm="BIDIRECTIONAL_SEARCH";this.maxPathLength=1/0;this.considerCosts=!1;this.isBlocking=(t,e)=>t?new Ni(this.tilemap,this.getPathfindingOptions()).isBlocking(this.character.getTilePos(),{position:t,layer:e}):!0;var l;this.shortestPathAlgorithm=(l=s==null?void 0:s.algorithm)!=null?l:this.shortestPathAlgorithm,this.ignoreBlockedTarget=a,this.distance=h,this.noPathFoundStrategy=(s==null?void 0:s.noPathFoundStrategy)||"STOP",this.pathBlockedStrategy=(s==null?void 0:s.pathBlockedStrategy)||"WAIT",this.noPathFoundRetryable=new En((s==null?void 0:s.noPathFoundRetryBackoffMs)||200,(s==null?void 0:s.noPathFoundMaxRetries)||-1,()=>{this.stop("NO_PATH_FOUND_MAX_RETRIES_EXCEEDED")}),this.pathBlockedRetryable=new En((s==null?void 0:s.pathBlockedRetryBackoffMs)||200,(s==null?void 0:s.pathBlockedMaxRetries)||-1,()=>{this.stop("PATH_BLOCKED_MAX_RETRIES_EXCEEDED")}),s!=null&&s.isPositionAllowedFn&&(this.isPositionAllowed=s.isPositionAllowedFn),s!=null&&s.maxPathLength&&(this.maxPathLength=s.maxPathLength),this.alternativeTargets=s==null?void 0:s.alternativeTargets,this.noPathFoundAlternativeTargetsFallbackStrategy=s==null?void 0:s.noPathFoundAlternativeTargetsFallbackStrategy,s!=null&&s.considerCosts&&this.shortestPathAlgorithm!=="A_STAR"&&console.warn(`GridEngine: Pathfinding option 'considerCosts' cannot be used with algorithm '${this.shortestPathAlgorithm}'. It can only be used with A* algorithm.`),this.considerCosts=(s==null?void 0:s.considerCosts)||!1,this.ignoreLayers=!!(s!=null&&s.ignoreLayers),this.distanceUtils=ie.create(t.getNumberOfDirections()),this.pathBlockedWaitTimeoutMs=(s==null?void 0:s.pathBlockedWaitTimeoutMs)||-1,this.finished$=new nt,this.setCharacter(t)}setPathBlockedStrategy(t){this.pathBlockedStrategy=t}getPathBlockedStrategy(){return this.pathBlockedStrategy}setCharacter(t){this.character=t,this.noPathFoundRetryable.reset(),this.pathBlockedRetryable.reset(),this.pathBlockedWaitElapsed=0,this.calcShortestPath(),this.character.autoMovementSet().pipe(Ht(e=>e!==this),pe(1)).subscribe(()=>{this.stop("MOVEMENT_TERMINATED")})}getPathfindingOptions(){return{shortestPathAlgorithm:this.shortestPathAlgorithm,pathWidth:this.character.getTileWidth(),pathHeight:this.character.getTileHeight(),numberOfDirections:this.character.getNumberOfDirections(),isPositionAllowed:this.isPositionAllowed,collisionGroups:this.character.getCollisionGroups(),ignoredChars:[this.character.getId()],ignoreTiles:!this.character.collidesWithTiles(),ignoreMapBounds:this.character.getIgnoreMissingTiles(),ignoreBlockedTarget:this.ignoreBlockedTarget,maxPathLength:this.maxPathLength,ignoreLayers:this.ignoreLayers,considerCosts:this.considerCosts,calculateClosestToTarget:!0}}update(t){var e,n,s,a;this.stopped||(this.noPathFound()&&(this.noPathFoundStrategy==="RETRY"?this.noPathFoundRetryable.retry(t,()=>this.calcShortestPath()):this.noPathFoundStrategy==="STOP"&&this.stop("NO_PATH_FOUND")),this.updatePosOnPath(),this.isBlocking((e=this.nextTileOnPath())==null?void 0:e.position,(n=this.character)==null?void 0:n.getNextTilePos().layer)?this.applyPathBlockedStrategy(t):this.pathBlockedWaitElapsed=0,this.hasArrived()?(this.stop("SUCCESS"),this.existsDistToTarget()&&this.turnTowardsTarget()):this.isBlocking((s=this.nextTileOnPath())==null?void 0:s.position,(a=this.character)==null?void 0:a.getNextTilePos().layer)||this.moveCharOnPath())}finishedObs(){return this.finished$}getInfo(){return{type:"Target",state:{pathAhead:this.shortestPath.slice(this.posOnPath).map(t=>z.fromInternal(t))},config:{algorithm:this.shortestPathAlgorithm,ignoreBlockedTarget:this.ignoreBlockedTarget,distance:this.distance,targetPos:z.fromInternal(this.targetPos),noPathFoundStrategy:this.noPathFoundStrategy,pathBlockedStrategy:this.pathBlockedStrategy,noPathFoundRetryBackoffMs:this.noPathFoundRetryable.getBackoffMs(),noPathFoundMaxRetries:this.noPathFoundRetryable.getMaxRetries()}}}resultToReason(t){switch(t){case"SUCCESS":return"Successfully arrived.";case"MOVEMENT_TERMINATED":return"Movement of character has been replaced before destination was reached.";case"PATH_BLOCKED":return"PathBlockedStrategy STOP: Path blocked.";case"NO_PATH_FOUND_MAX_RETRIES_EXCEEDED":return`NoPathFoundStrategy RETRY: Maximum retries of ${this.noPathFoundRetryable.getMaxRetries()} exceeded.`;case"NO_PATH_FOUND":return"NoPathFoundStrategy STOP: No path found.";case"PATH_BLOCKED_MAX_RETRIES_EXCEEDED":return`PathBlockedStrategy RETRY: Maximum retries of ${this.pathBlockedRetryable.getMaxRetries()} exceeded.`;case"PATH_BLOCKED_WAIT_TIMEOUT":return`PathBlockedStrategy WAIT: Wait timeout of ${this.pathBlockedWaitTimeoutMs}ms exceeded.`}}applyPathBlockedStrategy(t){this.pathBlockedStrategy==="RETRY"?this.pathBlockedRetryable.retry(t,()=>{let e=this.getShortestPath();e.path.length>0&&this.calcShortestPath(e)}):this.pathBlockedStrategy==="STOP"?this.stop("PATH_BLOCKED"):this.pathBlockedStrategy==="WAIT"&&this.pathBlockedWaitTimeoutMs>-1&&(this.pathBlockedWaitElapsed+=t,this.pathBlockedWaitElapsed>=this.pathBlockedWaitTimeoutMs&&this.stop("PATH_BLOCKED_WAIT_TIMEOUT"))}moveCharOnPath(){let t=this.nextTileOnPath();if(!t)return;let e=this.getDir(this.character.getNextTilePos().position,t.position);this.character.move(e)}nextTileOnPath(){return this.shortestPath[this.posOnPath+1]}stop(t){this.finished$.next({position:this.character.getTilePos().position,result:t,description:this.resultToReason(t),layer:this.character.getTilePos().layer}),this.finished$.complete(),this.stopped=!0}turnTowardsTarget(){let t=this.shortestPath[this.posOnPath+1],e=this.getDir(this.character.getNextTilePos().position,t.position);this.character.turnTowards(e)}existsDistToTarget(){return this.posOnPath<this.shortestPath.length-1}hasArrived(){return!this.noPathFound()&&this.posOnPath+Math.max(0,this.distance-this.distOffset)>=this.shortestPath.length-1}updatePosOnPath(){let t=this.shortestPath[this.posOnPath];for(;this.posOnPath<this.shortestPath.length-1&&(this.character.getNextTilePos().position.x!=t.position.x||this.character.getNextTilePos().position.y!=t.position.y);)this.posOnPath++,t=this.shortestPath[this.posOnPath]}noPathFound(){return this.shortestPath.length===0}calcShortestPath(t){t=t!=null?t:this.getShortestPath(),this.posOnPath=0,this.shortestPath=t.path,this.distOffset=t.distOffset}getShortestPath(){var a;let t=new Xi(this.tilemap),{path:e,closestToTarget:n}=t.findShortestPath(this.character.getNextTilePos(),this.targetPos,this.getPathfindingOptions());if(e.length==0){if(this.noPathFoundStrategy==="CLOSEST_REACHABLE"){if(!n)throw Error("ClosestToTarget should never be undefined in TargetMovement.");return this.pathToAlternativeTarget(n,t)}else if(this.noPathFoundStrategy==="ALTERNATIVE_TARGETS"){for(let h of(a=this.alternativeTargets)!=null?a:[]){let{path:l,distOffset:f}=this.pathToAlternativeTarget(z.toInternal(h),t);if(l.length>0)return{path:l,distOffset:f}}return this.noPathFoundStrategy=this.noPathFoundAlternativeTargetsFallbackStrategy||"STOP",this.getShortestPath()}}return{path:e,distOffset:0}}pathToAlternativeTarget(t,e){let n=e.findShortestPath(this.character.getNextTilePos(),t,this.getPathfindingOptions()).path,s=this.distanceUtils.distance(t.position,this.targetPos.position);return{path:n,distOffset:s}}getDir(t,e){return this.tilemap.fromMapDirection(this.distanceUtils.direction(t,e))}};var DS=Object.create,em=Object.defineProperty,MS=Object.getOwnPropertyDescriptor,kS=Object.getOwnPropertyNames,FS=Object.getPrototypeOf,RS=Object.prototype.hasOwnProperty,zS=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),NS=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of kS(t))!RS.call(r,s)&&s!==e&&em(r,s,{get:()=>t[s],enumerable:!(n=MS(t,s))||n.enumerable});return r},uh=(r,t,e)=>(e=r!=null?DS(FS(r)):{},NS(t||!r||!r.__esModule?em(e,"default",{value:r,enumerable:!0}):e,r)),hh=zS((r,t)=>{(function(){var e,n="4.17.21",s=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",l="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",d=500,y="__lodash_placeholder__",b=1,S=2,C=4,A=1,I=2,F=1,B=2,j=4,Z=8,ht=16,Ot=32,Ne=64,_e=128,Ji=256,js=512,om=30,sm="...",am=800,um=16,dh=1,hm=2,cm=3,Yr=1/0,Or=9007199254740991,lm=17976931348623157e292,Bn=0/0,Xe=4294967295,fm=Xe-1,pm=Xe>>>1,dm=[["ary",_e],["bind",F],["bindKey",B],["curry",Z],["curryRight",ht],["flip",js],["partial",Ot],["partialRight",Ne],["rearg",Ji]],yi="[object Arguments]",Hn="[object Array]",mm="[object AsyncFunction]",Zi="[object Boolean]",tn="[object Date]",gm="[object DOMException]",Wn="[object Error]",qn="[object Function]",mh="[object GeneratorFunction]",Ve="[object Map]",en="[object Number]",ym="[object Null]",gr="[object Object]",gh="[object Promise]",vm="[object Proxy]",rn="[object RegExp]",Ge="[object Set]",nn="[object String]",$n="[object Symbol]",bm="[object Undefined]",on="[object WeakMap]",Tm="[object WeakSet]",sn="[object ArrayBuffer]",vi="[object DataView]",Bs="[object Float32Array]",Hs="[object Float64Array]",Ws="[object Int8Array]",qs="[object Int16Array]",$s="[object Int32Array]",Qs="[object Uint8Array]",Ys="[object Uint8ClampedArray]",Ks="[object Uint16Array]",Xs="[object Uint32Array]",Pm=/\b__p \+= '';/g,wm=/\b(__p \+=) '' \+/g,xm=/(__e\(.*?\)|\b__t\)) \+\n'';/g,yh=/&(?:amp|lt|gt|quot|#39);/g,vh=/[&<>"']/g,Sm=RegExp(yh.source),Cm=RegExp(vh.source),_m=/<%-([\s\S]+?)%>/g,Lm=/<%([\s\S]+?)%>/g,bh=/<%=([\s\S]+?)%>/g,Em=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Om=/^\w*$/,Am=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Js=/[\\^$.*+?()[\]{}|]/g,Im=RegExp(Js.source),Zs=/^\s+/,Dm=/\s/,Mm=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,km=/\{\n\/\* \[wrapped with (.+)\] \*/,Fm=/,? & /,Rm=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,zm=/[()=,{}\[\]\/\s]/,Nm=/\\(\\)?/g,Vm=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Th=/\w*$/,Gm=/^[-+]0x[0-9a-f]+$/i,Um=/^0b[01]+$/i,jm=/^\[object .+?Constructor\]$/,Bm=/^0o[0-7]+$/i,Hm=/^(?:0|[1-9]\d*)$/,Wm=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Qn=/($^)/,qm=/['\n\r\u2028\u2029\\]/g,Yn="\\ud800-\\udfff",$m="\\u0300-\\u036f",Qm="\\ufe20-\\ufe2f",Ym="\\u20d0-\\u20ff",Ph=$m+Qm+Ym,wh="\\u2700-\\u27bf",xh="a-z\\xdf-\\xf6\\xf8-\\xff",Km="\\xac\\xb1\\xd7\\xf7",Xm="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Jm="\\u2000-\\u206f",Zm=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Sh="A-Z\\xc0-\\xd6\\xd8-\\xde",Ch="\\ufe0e\\ufe0f",_h=Km+Xm+Jm+Zm,ta="['\u2019]",tg="["+Yn+"]",Lh="["+_h+"]",Kn="["+Ph+"]",Eh="\\d+",eg="["+wh+"]",Oh="["+xh+"]",Ah="[^"+Yn+_h+Eh+wh+xh+Sh+"]",ea="\\ud83c[\\udffb-\\udfff]",rg="(?:"+Kn+"|"+ea+")",Ih="[^"+Yn+"]",ra="(?:\\ud83c[\\udde6-\\uddff]){2}",ia="[\\ud800-\\udbff][\\udc00-\\udfff]",bi="["+Sh+"]",Dh="\\u200d",Mh="(?:"+Oh+"|"+Ah+")",ig="(?:"+bi+"|"+Ah+")",kh="(?:"+ta+"(?:d|ll|m|re|s|t|ve))?",Fh="(?:"+ta+"(?:D|LL|M|RE|S|T|VE))?",Rh=rg+"?",zh="["+Ch+"]?",ng="(?:"+Dh+"(?:"+[Ih,ra,ia].join("|")+")"+zh+Rh+")*",og="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",sg="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Nh=zh+Rh+ng,ag="(?:"+[eg,ra,ia].join("|")+")"+Nh,ug="(?:"+[Ih+Kn+"?",Kn,ra,ia,tg].join("|")+")",hg=RegExp(ta,"g"),cg=RegExp(Kn,"g"),na=RegExp(ea+"(?="+ea+")|"+ug+Nh,"g"),lg=RegExp([bi+"?"+Oh+"+"+kh+"(?="+[Lh,bi,"$"].join("|")+")",ig+"+"+Fh+"(?="+[Lh,bi+Mh,"$"].join("|")+")",bi+"?"+Mh+"+"+kh,bi+"+"+Fh,sg,og,Eh,ag].join("|"),"g"),fg=RegExp("["+Dh+Yn+Ph+Ch+"]"),pg=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,dg=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],mg=-1,ft={};ft[Bs]=ft[Hs]=ft[Ws]=ft[qs]=ft[$s]=ft[Qs]=ft[Ys]=ft[Ks]=ft[Xs]=!0,ft[yi]=ft[Hn]=ft[sn]=ft[Zi]=ft[vi]=ft[tn]=ft[Wn]=ft[qn]=ft[Ve]=ft[en]=ft[gr]=ft[rn]=ft[Ge]=ft[nn]=ft[on]=!1;var ct={};ct[yi]=ct[Hn]=ct[sn]=ct[vi]=ct[Zi]=ct[tn]=ct[Bs]=ct[Hs]=ct[Ws]=ct[qs]=ct[$s]=ct[Ve]=ct[en]=ct[gr]=ct[rn]=ct[Ge]=ct[nn]=ct[$n]=ct[Qs]=ct[Ys]=ct[Ks]=ct[Xs]=!0,ct[Wn]=ct[qn]=ct[on]=!1;var gg={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},yg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},vg={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},bg={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Tg=parseFloat,Pg=parseInt,Vh=typeof global=="object"&&global&&global.Object===Object&&global,wg=typeof self=="object"&&self&&self.Object===Object&&self,Rt=Vh||wg||Function("return this")(),oa=typeof r=="object"&&r&&!r.nodeType&&r,Kr=oa&&typeof t=="object"&&t&&!t.nodeType&&t,Gh=Kr&&Kr.exports===oa,sa=Gh&&Vh.process,Le=function(){try{var P=Kr&&Kr.require&&Kr.require("util").types;return P||sa&&sa.binding&&sa.binding("util")}catch(_){}}(),Uh=Le&&Le.isArrayBuffer,jh=Le&&Le.isDate,Bh=Le&&Le.isMap,Hh=Le&&Le.isRegExp,Wh=Le&&Le.isSet,qh=Le&&Le.isTypedArray;function me(P,_,x){switch(x.length){case 0:return P.call(_);case 1:return P.call(_,x[0]);case 2:return P.call(_,x[0],x[1]);case 3:return P.call(_,x[0],x[1],x[2])}return P.apply(_,x)}function xg(P,_,x,k){for(var H=-1,rt=P==null?0:P.length;++H<rt;){var At=P[H];_(k,At,x(At),P)}return k}function Ee(P,_){for(var x=-1,k=P==null?0:P.length;++x<k&&_(P[x],x,P)!==!1;);return P}function Sg(P,_){for(var x=P==null?0:P.length;x--&&_(P[x],x,P)!==!1;);return P}function $h(P,_){for(var x=-1,k=P==null?0:P.length;++x<k;)if(!_(P[x],x,P))return!1;return!0}function Ar(P,_){for(var x=-1,k=P==null?0:P.length,H=0,rt=[];++x<k;){var At=P[x];_(At,x,P)&&(rt[H++]=At)}return rt}function Xn(P,_){var x=P==null?0:P.length;return!!x&&Ti(P,_,0)>-1}function aa(P,_,x){for(var k=-1,H=P==null?0:P.length;++k<H;)if(x(_,P[k]))return!0;return!1}function pt(P,_){for(var x=-1,k=P==null?0:P.length,H=Array(k);++x<k;)H[x]=_(P[x],x,P);return H}function Ir(P,_){for(var x=-1,k=_.length,H=P.length;++x<k;)P[H+x]=_[x];return P}function ua(P,_,x,k){var H=-1,rt=P==null?0:P.length;for(k&&rt&&(x=P[++H]);++H<rt;)x=_(x,P[H],H,P);return x}function Cg(P,_,x,k){var H=P==null?0:P.length;for(k&&H&&(x=P[--H]);H--;)x=_(x,P[H],H,P);return x}function ha(P,_){for(var x=-1,k=P==null?0:P.length;++x<k;)if(_(P[x],x,P))return!0;return!1}var _g=ca("length");function Lg(P){return P.split("")}function Eg(P){return P.match(Rm)||[]}function Qh(P,_,x){var k;return x(P,function(H,rt,At){if(_(H,rt,At))return k=rt,!1}),k}function Jn(P,_,x,k){for(var H=P.length,rt=x+(k?1:-1);k?rt--:++rt<H;)if(_(P[rt],rt,P))return rt;return-1}function Ti(P,_,x){return _===_?Gg(P,_,x):Jn(P,Yh,x)}function Og(P,_,x,k){for(var H=x-1,rt=P.length;++H<rt;)if(k(P[H],_))return H;return-1}function Yh(P){return P!==P}function Kh(P,_){var x=P==null?0:P.length;return x?fa(P,_)/x:Bn}function ca(P){return function(_){return _==null?e:_[P]}}function la(P){return function(_){return P==null?e:P[_]}}function Xh(P,_,x,k,H){return H(P,function(rt,At,ut){x=k?(k=!1,rt):_(x,rt,At,ut)}),x}function Ag(P,_){var x=P.length;for(P.sort(_);x--;)P[x]=P[x].value;return P}function fa(P,_){for(var x,k=-1,H=P.length;++k<H;){var rt=_(P[k]);rt!==e&&(x=x===e?rt:x+rt)}return x}function pa(P,_){for(var x=-1,k=Array(P);++x<P;)k[x]=_(x);return k}function Ig(P,_){return pt(_,function(x){return[x,P[x]]})}function Jh(P){return P&&P.slice(0,rc(P)+1).replace(Zs,"")}function ge(P){return function(_){return P(_)}}function da(P,_){return pt(_,function(x){return P[x]})}function an(P,_){return P.has(_)}function Zh(P,_){for(var x=-1,k=P.length;++x<k&&Ti(_,P[x],0)>-1;);return x}function tc(P,_){for(var x=P.length;x--&&Ti(_,P[x],0)>-1;);return x}function Dg(P,_){for(var x=P.length,k=0;x--;)P[x]===_&&++k;return k}var Mg=la(gg),kg=la(yg);function Fg(P){return"\\"+bg[P]}function Rg(P,_){return P==null?e:P[_]}function Pi(P){return fg.test(P)}function zg(P){return pg.test(P)}function Ng(P){for(var _,x=[];!(_=P.next()).done;)x.push(_.value);return x}function ma(P){var _=-1,x=Array(P.size);return P.forEach(function(k,H){x[++_]=[H,k]}),x}function ec(P,_){return function(x){return P(_(x))}}function Dr(P,_){for(var x=-1,k=P.length,H=0,rt=[];++x<k;){var At=P[x];(At===_||At===y)&&(P[x]=y,rt[H++]=x)}return rt}function Zn(P){var _=-1,x=Array(P.size);return P.forEach(function(k){x[++_]=k}),x}function Vg(P){var _=-1,x=Array(P.size);return P.forEach(function(k){x[++_]=[k,k]}),x}function Gg(P,_,x){for(var k=x-1,H=P.length;++k<H;)if(P[k]===_)return k;return-1}function Ug(P,_,x){for(var k=x+1;k--;)if(P[k]===_)return k;return k}function wi(P){return Pi(P)?Bg(P):_g(P)}function Ue(P){return Pi(P)?Hg(P):Lg(P)}function rc(P){for(var _=P.length;_--&&Dm.test(P.charAt(_)););return _}var jg=la(vg);function Bg(P){for(var _=na.lastIndex=0;na.test(P);)++_;return _}function Hg(P){return P.match(na)||[]}function Wg(P){return P.match(lg)||[]}var qg=function P(_){_=_==null?Rt:Mr.defaults(Rt.Object(),_,Mr.pick(Rt,dg));var x=_.Array,k=_.Date,H=_.Error,rt=_.Function,At=_.Math,ut=_.Object,ga=_.RegExp,$g=_.String,Oe=_.TypeError,to=x.prototype,Qg=rt.prototype,xi=ut.prototype,eo=_["__core-js_shared__"],ro=Qg.toString,st=xi.hasOwnProperty,Yg=0,ic=function(){var i=/[^.]+$/.exec(eo&&eo.keys&&eo.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}(),io=xi.toString,Kg=ro.call(ut),Xg=Rt._,Jg=ga("^"+ro.call(st).replace(Js,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),no=Gh?_.Buffer:e,kr=_.Symbol,oo=_.Uint8Array,nc=no?no.allocUnsafe:e,so=ec(ut.getPrototypeOf,ut),oc=ut.create,sc=xi.propertyIsEnumerable,ao=to.splice,ac=kr?kr.isConcatSpreadable:e,un=kr?kr.iterator:e,Xr=kr?kr.toStringTag:e,uo=function(){try{var i=ri(ut,"defineProperty");return i({},"",{}),i}catch(o){}}(),Zg=_.clearTimeout!==Rt.clearTimeout&&_.clearTimeout,ty=k&&k.now!==Rt.Date.now&&k.now,ey=_.setTimeout!==Rt.setTimeout&&_.setTimeout,ho=At.ceil,co=At.floor,ya=ut.getOwnPropertySymbols,ry=no?no.isBuffer:e,uc=_.isFinite,iy=to.join,ny=ec(ut.keys,ut),It=At.max,$t=At.min,oy=k.now,sy=_.parseInt,hc=At.random,ay=to.reverse,va=ri(_,"DataView"),hn=ri(_,"Map"),ba=ri(_,"Promise"),Si=ri(_,"Set"),cn=ri(_,"WeakMap"),ln=ri(ut,"create"),lo=cn&&new cn,Ci={},uy=ii(va),hy=ii(hn),cy=ii(ba),ly=ii(Si),fy=ii(cn),fo=kr?kr.prototype:e,fn=fo?fo.valueOf:e,cc=fo?fo.toString:e;function m(i){if(bt(i)&&!W(i)&&!(i instanceof K)){if(i instanceof Ae)return i;if(st.call(i,"__wrapped__"))return ll(i)}return new Ae(i)}var _i=function(){function i(){}return function(o){if(!gt(o))return{};if(oc)return oc(o);i.prototype=o;var u=new i;return i.prototype=e,u}}();function po(){}function Ae(i,o){this.__wrapped__=i,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=e}m.templateSettings={escape:_m,evaluate:Lm,interpolate:bh,variable:"",imports:{_:m}},m.prototype=po.prototype,m.prototype.constructor=m,Ae.prototype=_i(po.prototype),Ae.prototype.constructor=Ae;function K(i){this.__wrapped__=i,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Xe,this.__views__=[]}function py(){var i=new K(this.__wrapped__);return i.__actions__=ae(this.__actions__),i.__dir__=this.__dir__,i.__filtered__=this.__filtered__,i.__iteratees__=ae(this.__iteratees__),i.__takeCount__=this.__takeCount__,i.__views__=ae(this.__views__),i}function dy(){if(this.__filtered__){var i=new K(this);i.__dir__=-1,i.__filtered__=!0}else i=this.clone(),i.__dir__*=-1;return i}function my(){var i=this.__wrapped__.value(),o=this.__dir__,u=W(i),c=o<0,p=u?i.length:0,g=Lv(0,p,this.__views__),v=g.start,T=g.end,w=T-v,L=c?T:v-1,E=this.__iteratees__,O=E.length,M=0,R=$t(w,this.__takeCount__);if(!u||!c&&p==w&&R==w)return kc(i,this.__actions__);var G=[];t:for(;w--&&M<R;){L+=o;for(var $=-1,U=i[L];++$<O;){var Y=E[$],X=Y.iteratee,be=Y.type,ee=X(U);if(be==hm)U=ee;else if(!ee){if(be==dh)continue t;break t}}G[M++]=U}return G}K.prototype=_i(po.prototype),K.prototype.constructor=K;function Jr(i){var o=-1,u=i==null?0:i.length;for(this.clear();++o<u;){var c=i[o];this.set(c[0],c[1])}}function gy(){this.__data__=ln?ln(null):{},this.size=0}function yy(i){var o=this.has(i)&&delete this.__data__[i];return this.size-=o?1:0,o}function vy(i){var o=this.__data__;if(ln){var u=o[i];return u===f?e:u}return st.call(o,i)?o[i]:e}function by(i){var o=this.__data__;return ln?o[i]!==e:st.call(o,i)}function Ty(i,o){var u=this.__data__;return this.size+=this.has(i)?0:1,u[i]=ln&&o===e?f:o,this}Jr.prototype.clear=gy,Jr.prototype.delete=yy,Jr.prototype.get=vy,Jr.prototype.has=by,Jr.prototype.set=Ty;function yr(i){var o=-1,u=i==null?0:i.length;for(this.clear();++o<u;){var c=i[o];this.set(c[0],c[1])}}function Py(){this.__data__=[],this.size=0}function wy(i){var o=this.__data__,u=mo(o,i);if(u<0)return!1;var c=o.length-1;return u==c?o.pop():ao.call(o,u,1),--this.size,!0}function xy(i){var o=this.__data__,u=mo(o,i);return u<0?e:o[u][1]}function Sy(i){return mo(this.__data__,i)>-1}function Cy(i,o){var u=this.__data__,c=mo(u,i);return c<0?(++this.size,u.push([i,o])):u[c][1]=o,this}yr.prototype.clear=Py,yr.prototype.delete=wy,yr.prototype.get=xy,yr.prototype.has=Sy,yr.prototype.set=Cy;function vr(i){var o=-1,u=i==null?0:i.length;for(this.clear();++o<u;){var c=i[o];this.set(c[0],c[1])}}function _y(){this.size=0,this.__data__={hash:new Jr,map:new(hn||yr),string:new Jr}}function Ly(i){var o=Lo(this,i).delete(i);return this.size-=o?1:0,o}function Ey(i){return Lo(this,i).get(i)}function Oy(i){return Lo(this,i).has(i)}function Ay(i,o){var u=Lo(this,i),c=u.size;return u.set(i,o),this.size+=u.size==c?0:1,this}vr.prototype.clear=_y,vr.prototype.delete=Ly,vr.prototype.get=Ey,vr.prototype.has=Oy,vr.prototype.set=Ay;function Zr(i){var o=-1,u=i==null?0:i.length;for(this.__data__=new vr;++o<u;)this.add(i[o])}function Iy(i){return this.__data__.set(i,f),this}function Dy(i){return this.__data__.has(i)}Zr.prototype.add=Zr.prototype.push=Iy,Zr.prototype.has=Dy;function je(i){var o=this.__data__=new yr(i);this.size=o.size}function My(){this.__data__=new yr,this.size=0}function ky(i){var o=this.__data__,u=o.delete(i);return this.size=o.size,u}function Fy(i){return this.__data__.get(i)}function Ry(i){return this.__data__.has(i)}function zy(i,o){var u=this.__data__;if(u instanceof yr){var c=u.__data__;if(!hn||c.length<s-1)return c.push([i,o]),this.size=++u.size,this;u=this.__data__=new vr(c)}return u.set(i,o),this.size=u.size,this}je.prototype.clear=My,je.prototype.delete=ky,je.prototype.get=Fy,je.prototype.has=Ry,je.prototype.set=zy;function lc(i,o){var u=W(i),c=!u&&ni(i),p=!u&&!c&&Vr(i),g=!u&&!c&&!p&&Ai(i),v=u||c||p||g,T=v?pa(i.length,$g):[],w=T.length;for(var L in i)(o||st.call(i,L))&&!(v&&(L=="length"||p&&(L=="offset"||L=="parent")||g&&(L=="buffer"||L=="byteLength"||L=="byteOffset")||wr(L,w)))&&T.push(L);return T}function fc(i){var o=i.length;return o?i[Aa(0,o-1)]:e}function Ny(i,o){return Eo(ae(i),ti(o,0,i.length))}function Vy(i){return Eo(ae(i))}function Ta(i,o,u){(u!==e&&!Be(i[o],u)||u===e&&!(o in i))&&br(i,o,u)}function pn(i,o,u){var c=i[o];(!(st.call(i,o)&&Be(c,u))||u===e&&!(o in i))&&br(i,o,u)}function mo(i,o){for(var u=i.length;u--;)if(Be(i[u][0],o))return u;return-1}function Gy(i,o,u,c){return Fr(i,function(p,g,v){o(c,p,u(p),v)}),c}function pc(i,o){return i&&Ze(o,zt(o),i)}function Uy(i,o){return i&&Ze(o,he(o),i)}function br(i,o,u){o=="__proto__"&&uo?uo(i,o,{configurable:!0,enumerable:!0,value:u,writable:!0}):i[o]=u}function Pa(i,o){for(var u=-1,c=o.length,p=x(c),g=i==null;++u<c;)p[u]=g?e:eu(i,o[u]);return p}function ti(i,o,u){return i===i&&(u!==e&&(i=i<=u?i:u),o!==e&&(i=i>=o?i:o)),i}function Ie(i,o,u,c,p,g){var v,T=o&b,w=o&S,L=o&C;if(u&&(v=p?u(i,c,p,g):u(i)),v!==e)return v;if(!gt(i))return i;var E=W(i);if(E){if(v=Ov(i),!T)return ae(i,v)}else{var O=Qt(i),M=O==qn||O==mh;if(Vr(i))return zc(i,T);if(O==gr||O==yi||M&&!p){if(v=w||M?{}:rl(i),!T)return w?vv(i,Uy(v,i)):yv(i,pc(v,i))}else{if(!ct[O])return p?i:{};v=Av(i,O,T)}}g||(g=new je);var R=g.get(i);if(R)return R;g.set(i,v),Il(i)?i.forEach(function(U){v.add(Ie(U,o,u,U,i,g))}):Ol(i)&&i.forEach(function(U,Y){v.set(Y,Ie(U,o,u,Y,i,g))});var G=L?w?Ua:Ga:w?he:zt,$=E?e:G(i);return Ee($||i,function(U,Y){$&&(Y=U,U=i[Y]),pn(v,Y,Ie(U,o,u,Y,i,g))}),v}function jy(i){var o=zt(i);return function(u){return dc(u,i,o)}}function dc(i,o,u){var c=u.length;if(i==null)return!c;for(i=ut(i);c--;){var p=u[c],g=o[p],v=i[p];if(v===e&&!(p in i)||!g(v))return!1}return!0}function mc(i,o,u){if(typeof i!="function")throw new Oe(h);return Tn(function(){i.apply(e,u)},o)}function dn(i,o,u,c){var p=-1,g=Xn,v=!0,T=i.length,w=[],L=o.length;if(!T)return w;u&&(o=pt(o,ge(u))),c?(g=aa,v=!1):o.length>=s&&(g=an,v=!1,o=new Zr(o));t:for(;++p<T;){var E=i[p],O=u==null?E:u(E);if(E=c||E!==0?E:0,v&&O===O){for(var M=L;M--;)if(o[M]===O)continue t;w.push(E)}else g(o,O,c)||w.push(E)}return w}var Fr=jc(Je),gc=jc(xa,!0);function By(i,o){var u=!0;return Fr(i,function(c,p,g){return u=!!o(c,p,g),u}),u}function go(i,o,u){for(var c=-1,p=i.length;++c<p;){var g=i[c],v=o(g);if(v!=null&&(T===e?v===v&&!ve(v):u(v,T)))var T=v,w=g}return w}function Hy(i,o,u,c){var p=i.length;for(u=q(u),u<0&&(u=-u>p?0:p+u),c=c===e||c>p?p:q(c),c<0&&(c+=p),c=u>c?0:Ml(c);u<c;)i[u++]=o;return i}function yc(i,o){var u=[];return Fr(i,function(c,p,g){o(c,p,g)&&u.push(c)}),u}function Bt(i,o,u,c,p){var g=-1,v=i.length;for(u||(u=Dv),p||(p=[]);++g<v;){var T=i[g];o>0&&u(T)?o>1?Bt(T,o-1,u,c,p):Ir(p,T):c||(p[p.length]=T)}return p}var wa=Bc(),vc=Bc(!0);function Je(i,o){return i&&wa(i,o,zt)}function xa(i,o){return i&&vc(i,o,zt)}function yo(i,o){return Ar(o,function(u){return xr(i[u])})}function ei(i,o){o=zr(o,i);for(var u=0,c=o.length;i!=null&&u<c;)i=i[tr(o[u++])];return u&&u==c?i:e}function bc(i,o,u){var c=o(i);return W(i)?c:Ir(c,u(i))}function Zt(i){return i==null?i===e?bm:ym:Xr&&Xr in ut(i)?_v(i):Vv(i)}function Sa(i,o){return i>o}function Wy(i,o){return i!=null&&st.call(i,o)}function qy(i,o){return i!=null&&o in ut(i)}function $y(i,o,u){return i>=$t(o,u)&&i<It(o,u)}function Ca(i,o,u){for(var c=u?aa:Xn,p=i[0].length,g=i.length,v=g,T=x(g),w=1/0,L=[];v--;){var E=i[v];v&&o&&(E=pt(E,ge(o))),w=$t(E.length,w),T[v]=!u&&(o||p>=120&&E.length>=120)?new Zr(v&&E):e}E=i[0];var O=-1,M=T[0];t:for(;++O<p&&L.length<w;){var R=E[O],G=o?o(R):R;if(R=u||R!==0?R:0,!(M?an(M,G):c(L,G,u))){for(v=g;--v;){var $=T[v];if(!($?an($,G):c(i[v],G,u)))continue t}M&&M.push(G),L.push(R)}}return L}function Qy(i,o,u,c){return Je(i,function(p,g,v){o(c,u(p),g,v)}),c}function mn(i,o,u){o=zr(o,i),i=sl(i,o);var c=i==null?i:i[tr(Me(o))];return c==null?e:me(c,i,u)}function Tc(i){return bt(i)&&Zt(i)==yi}function Yy(i){return bt(i)&&Zt(i)==sn}function Ky(i){return bt(i)&&Zt(i)==tn}function gn(i,o,u,c,p){return i===o?!0:i==null||o==null||!bt(i)&&!bt(o)?i!==i&&o!==o:Xy(i,o,u,c,gn,p)}function Xy(i,o,u,c,p,g){var v=W(i),T=W(o),w=v?Hn:Qt(i),L=T?Hn:Qt(o);w=w==yi?gr:w,L=L==yi?gr:L;var E=w==gr,O=L==gr,M=w==L;if(M&&Vr(i)){if(!Vr(o))return!1;v=!0,E=!1}if(M&&!E)return g||(g=new je),v||Ai(i)?Zc(i,o,u,c,p,g):Sv(i,o,w,u,c,p,g);if(!(u&A)){var R=E&&st.call(i,"__wrapped__"),G=O&&st.call(o,"__wrapped__");if(R||G){var $=R?i.value():i,U=G?o.value():o;return g||(g=new je),p($,U,u,c,g)}}return M?(g||(g=new je),Cv(i,o,u,c,p,g)):!1}function Jy(i){return bt(i)&&Qt(i)==Ve}function _a(i,o,u,c){var p=u.length,g=p,v=!c;if(i==null)return!g;for(i=ut(i);p--;){var T=u[p];if(v&&T[2]?T[1]!==i[T[0]]:!(T[0]in i))return!1}for(;++p<g;){T=u[p];var w=T[0],L=i[w],E=T[1];if(v&&T[2]){if(L===e&&!(w in i))return!1}else{var O=new je;if(c)var M=c(L,E,w,i,o,O);if(!(M===e?gn(E,L,A|I,c,O):M))return!1}}return!0}function Pc(i){if(!gt(i)||kv(i))return!1;var o=xr(i)?Jg:jm;return o.test(ii(i))}function Zy(i){return bt(i)&&Zt(i)==rn}function tv(i){return bt(i)&&Qt(i)==Ge}function ev(i){return bt(i)&&ko(i.length)&&!!ft[Zt(i)]}function wc(i){return typeof i=="function"?i:i==null?ce:typeof i=="object"?W(i)?Cc(i[0],i[1]):Sc(i):Hl(i)}function La(i){if(!bn(i))return ny(i);var o=[];for(var u in ut(i))st.call(i,u)&&u!="constructor"&&o.push(u);return o}function rv(i){if(!gt(i))return Nv(i);var o=bn(i),u=[];for(var c in i)c=="constructor"&&(o||!st.call(i,c))||u.push(c);return u}function Ea(i,o){return i<o}function xc(i,o){var u=-1,c=ue(i)?x(i.length):[];return Fr(i,function(p,g,v){c[++u]=o(p,g,v)}),c}function Sc(i){var o=Ba(i);return o.length==1&&o[0][2]?nl(o[0][0],o[0][1]):function(u){return u===i||_a(u,i,o)}}function Cc(i,o){return Wa(i)&&il(o)?nl(tr(i),o):function(u){var c=eu(u,i);return c===e&&c===o?ru(u,i):gn(o,c,A|I)}}function vo(i,o,u,c,p){i!==o&&wa(o,function(g,v){if(p||(p=new je),gt(g))iv(i,o,v,u,vo,c,p);else{var T=c?c($a(i,v),g,v+"",i,o,p):e;T===e&&(T=g),Ta(i,v,T)}},he)}function iv(i,o,u,c,p,g,v){var T=$a(i,u),w=$a(o,u),L=v.get(w);if(L){Ta(i,u,L);return}var E=g?g(T,w,u+"",i,o,v):e,O=E===e;if(O){var M=W(w),R=!M&&Vr(w),G=!M&&!R&&Ai(w);E=w,M||R||G?W(T)?E=T:Pt(T)?E=ae(T):R?(O=!1,E=zc(w,!0)):G?(O=!1,E=Nc(w,!0)):E=[]:Pn(w)||ni(w)?(E=T,ni(T)?E=kl(T):(!gt(T)||xr(T))&&(E=rl(w))):O=!1}O&&(v.set(w,E),p(E,w,c,g,v),v.delete(w)),Ta(i,u,E)}function _c(i,o){var u=i.length;if(u)return o+=o<0?u:0,wr(o,u)?i[o]:e}function Lc(i,o,u){o.length?o=pt(o,function(g){return W(g)?function(v){return ei(v,g.length===1?g[0]:g)}:g}):o=[ce];var c=-1;o=pt(o,ge(V()));var p=xc(i,function(g,v,T){var w=pt(o,function(L){return L(g)});return{criteria:w,index:++c,value:g}});return Ag(p,function(g,v){return gv(g,v,u)})}function nv(i,o){return Ec(i,o,function(u,c){return ru(i,c)})}function Ec(i,o,u){for(var c=-1,p=o.length,g={};++c<p;){var v=o[c],T=ei(i,v);u(T,v)&&yn(g,zr(v,i),T)}return g}function ov(i){return function(o){return ei(o,i)}}function Oa(i,o,u,c){var p=c?Og:Ti,g=-1,v=o.length,T=i;for(i===o&&(o=ae(o)),u&&(T=pt(i,ge(u)));++g<v;)for(var w=0,L=o[g],E=u?u(L):L;(w=p(T,E,w,c))>-1;)T!==i&&ao.call(T,w,1),ao.call(i,w,1);return i}function Oc(i,o){for(var u=i?o.length:0,c=u-1;u--;){var p=o[u];if(u==c||p!==g){var g=p;wr(p)?ao.call(i,p,1):Ma(i,p)}}return i}function Aa(i,o){return i+co(hc()*(o-i+1))}function sv(i,o,u,c){for(var p=-1,g=It(ho((o-i)/(u||1)),0),v=x(g);g--;)v[c?g:++p]=i,i+=u;return v}function Ia(i,o){var u="";if(!i||o<1||o>Or)return u;do o%2&&(u+=i),o=co(o/2),o&&(i+=i);while(o);return u}function Q(i,o){return Qa(ol(i,o,ce),i+"")}function av(i){return fc(Ii(i))}function uv(i,o){var u=Ii(i);return Eo(u,ti(o,0,u.length))}function yn(i,o,u,c){if(!gt(i))return i;o=zr(o,i);for(var p=-1,g=o.length,v=g-1,T=i;T!=null&&++p<g;){var w=tr(o[p]),L=u;if(w==="__proto__"||w==="constructor"||w==="prototype")return i;if(p!=v){var E=T[w];L=c?c(E,w,T):e,L===e&&(L=gt(E)?E:wr(o[p+1])?[]:{})}pn(T,w,L),T=T[w]}return i}var Ac=lo?function(i,o){return lo.set(i,o),i}:ce,hv=uo?function(i,o){return uo(i,"toString",{configurable:!0,enumerable:!1,value:nu(o),writable:!0})}:ce;function cv(i){return Eo(Ii(i))}function De(i,o,u){var c=-1,p=i.length;o<0&&(o=-o>p?0:p+o),u=u>p?p:u,u<0&&(u+=p),p=o>u?0:u-o>>>0,o>>>=0;for(var g=x(p);++c<p;)g[c]=i[c+o];return g}function lv(i,o){var u;return Fr(i,function(c,p,g){return u=o(c,p,g),!u}),!!u}function bo(i,o,u){var c=0,p=i==null?c:i.length;if(typeof o=="number"&&o===o&&p<=pm){for(;c<p;){var g=c+p>>>1,v=i[g];v!==null&&!ve(v)&&(u?v<=o:v<o)?c=g+1:p=g}return p}return Da(i,o,ce,u)}function Da(i,o,u,c){var p=0,g=i==null?0:i.length;if(g===0)return 0;o=u(o);for(var v=o!==o,T=o===null,w=ve(o),L=o===e;p<g;){var E=co((p+g)/2),O=u(i[E]),M=O!==e,R=O===null,G=O===O,$=ve(O);if(v)var U=c||G;else L?U=G&&(c||M):T?U=G&&M&&(c||!R):w?U=G&&M&&!R&&(c||!$):R||$?U=!1:U=c?O<=o:O<o;U?p=E+1:g=E}return $t(g,fm)}function Ic(i,o){for(var u=-1,c=i.length,p=0,g=[];++u<c;){var v=i[u],T=o?o(v):v;if(!u||!Be(T,w)){var w=T;g[p++]=v===0?0:v}}return g}function Dc(i){return typeof i=="number"?i:ve(i)?Bn:+i}function ye(i){if(typeof i=="string")return i;if(W(i))return pt(i,ye)+"";if(ve(i))return cc?cc.call(i):"";var o=i+"";return o=="0"&&1/i==-Yr?"-0":o}function Rr(i,o,u){var c=-1,p=Xn,g=i.length,v=!0,T=[],w=T;if(u)v=!1,p=aa;else if(g>=s){var L=o?null:wv(i);if(L)return Zn(L);v=!1,p=an,w=new Zr}else w=o?[]:T;t:for(;++c<g;){var E=i[c],O=o?o(E):E;if(E=u||E!==0?E:0,v&&O===O){for(var M=w.length;M--;)if(w[M]===O)continue t;o&&w.push(O),T.push(E)}else p(w,O,u)||(w!==T&&w.push(O),T.push(E))}return T}function Ma(i,o){return o=zr(o,i),i=sl(i,o),i==null||delete i[tr(Me(o))]}function Mc(i,o,u,c){return yn(i,o,u(ei(i,o)),c)}function To(i,o,u,c){for(var p=i.length,g=c?p:-1;(c?g--:++g<p)&&o(i[g],g,i););return u?De(i,c?0:g,c?g+1:p):De(i,c?g+1:0,c?p:g)}function kc(i,o){var u=i;return u instanceof K&&(u=u.value()),ua(o,function(c,p){return p.func.apply(p.thisArg,Ir([c],p.args))},u)}function ka(i,o,u){var c=i.length;if(c<2)return c?Rr(i[0]):[];for(var p=-1,g=x(c);++p<c;)for(var v=i[p],T=-1;++T<c;)T!=p&&(g[p]=dn(g[p]||v,i[T],o,u));return Rr(Bt(g,1),o,u)}function Fc(i,o,u){for(var c=-1,p=i.length,g=o.length,v={};++c<p;){var T=c<g?o[c]:e;u(v,i[c],T)}return v}function Fa(i){return Pt(i)?i:[]}function Ra(i){return typeof i=="function"?i:ce}function zr(i,o){return W(i)?i:Wa(i,o)?[i]:cl(ot(i))}var fv=Q;function Nr(i,o,u){var c=i.length;return u=u===e?c:u,!o&&u>=c?i:De(i,o,u)}var Rc=Zg||function(i){return Rt.clearTimeout(i)};function zc(i,o){if(o)return i.slice();var u=i.length,c=nc?nc(u):new i.constructor(u);return i.copy(c),c}function za(i){var o=new i.constructor(i.byteLength);return new oo(o).set(new oo(i)),o}function pv(i,o){var u=o?za(i.buffer):i.buffer;return new i.constructor(u,i.byteOffset,i.byteLength)}function dv(i){var o=new i.constructor(i.source,Th.exec(i));return o.lastIndex=i.lastIndex,o}function mv(i){return fn?ut(fn.call(i)):{}}function Nc(i,o){var u=o?za(i.buffer):i.buffer;return new i.constructor(u,i.byteOffset,i.length)}function Vc(i,o){if(i!==o){var u=i!==e,c=i===null,p=i===i,g=ve(i),v=o!==e,T=o===null,w=o===o,L=ve(o);if(!T&&!L&&!g&&i>o||g&&v&&w&&!T&&!L||c&&v&&w||!u&&w||!p)return 1;if(!c&&!g&&!L&&i<o||L&&u&&p&&!c&&!g||T&&u&&p||!v&&p||!w)return-1}return 0}function gv(i,o,u){for(var c=-1,p=i.criteria,g=o.criteria,v=p.length,T=u.length;++c<v;){var w=Vc(p[c],g[c]);if(w){if(c>=T)return w;var L=u[c];return w*(L=="desc"?-1:1)}}return i.index-o.index}function Gc(i,o,u,c){for(var p=-1,g=i.length,v=u.length,T=-1,w=o.length,L=It(g-v,0),E=x(w+L),O=!c;++T<w;)E[T]=o[T];for(;++p<v;)(O||p<g)&&(E[u[p]]=i[p]);for(;L--;)E[T++]=i[p++];return E}function Uc(i,o,u,c){for(var p=-1,g=i.length,v=-1,T=u.length,w=-1,L=o.length,E=It(g-T,0),O=x(E+L),M=!c;++p<E;)O[p]=i[p];for(var R=p;++w<L;)O[R+w]=o[w];for(;++v<T;)(M||p<g)&&(O[R+u[v]]=i[p++]);return O}function ae(i,o){var u=-1,c=i.length;for(o||(o=x(c));++u<c;)o[u]=i[u];return o}function Ze(i,o,u,c){var p=!u;u||(u={});for(var g=-1,v=o.length;++g<v;){var T=o[g],w=c?c(u[T],i[T],T,u,i):e;w===e&&(w=i[T]),p?br(u,T,w):pn(u,T,w)}return u}function yv(i,o){return Ze(i,Ha(i),o)}function vv(i,o){return Ze(i,tl(i),o)}function Po(i,o){return function(u,c){var p=W(u)?xg:Gy,g=o?o():{};return p(u,i,V(c,2),g)}}function Li(i){return Q(function(o,u){var c=-1,p=u.length,g=p>1?u[p-1]:e,v=p>2?u[2]:e;for(g=i.length>3&&typeof g=="function"?(p--,g):e,v&&te(u[0],u[1],v)&&(g=p<3?e:g,p=1),o=ut(o);++c<p;){var T=u[c];T&&i(o,T,c,g)}return o})}function jc(i,o){return function(u,c){if(u==null)return u;if(!ue(u))return i(u,c);for(var p=u.length,g=o?p:-1,v=ut(u);(o?g--:++g<p)&&c(v[g],g,v)!==!1;);return u}}function Bc(i){return function(o,u,c){for(var p=-1,g=ut(o),v=c(o),T=v.length;T--;){var w=v[i?T:++p];if(u(g[w],w,g)===!1)break}return o}}function bv(i,o,u){var c=o&F,p=vn(i);function g(){var v=this&&this!==Rt&&this instanceof g?p:i;return v.apply(c?u:this,arguments)}return g}function Hc(i){return function(o){o=ot(o);var u=Pi(o)?Ue(o):e,c=u?u[0]:o.charAt(0),p=u?Nr(u,1).join(""):o.slice(1);return c[i]()+p}}function Ei(i){return function(o){return ua(jl(Ul(o).replace(hg,"")),i,"")}}function vn(i){return function(){var o=arguments;switch(o.length){case 0:return new i;case 1:return new i(o[0]);case 2:return new i(o[0],o[1]);case 3:return new i(o[0],o[1],o[2]);case 4:return new i(o[0],o[1],o[2],o[3]);case 5:return new i(o[0],o[1],o[2],o[3],o[4]);case 6:return new i(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new i(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var u=_i(i.prototype),c=i.apply(u,o);return gt(c)?c:u}}function Tv(i,o,u){var c=vn(i);function p(){for(var g=arguments.length,v=x(g),T=g,w=Oi(p);T--;)v[T]=arguments[T];var L=g<3&&v[0]!==w&&v[g-1]!==w?[]:Dr(v,w);if(g-=L.length,g<u)return Yc(i,o,wo,p.placeholder,e,v,L,e,e,u-g);var E=this&&this!==Rt&&this instanceof p?c:i;return me(E,this,v)}return p}function Wc(i){return function(o,u,c){var p=ut(o);if(!ue(o)){var g=V(u,3);o=zt(o),u=function(T){return g(p[T],T,p)}}var v=i(o,u,c);return v>-1?p[g?o[v]:v]:e}}function qc(i){return Pr(function(o){var u=o.length,c=u,p=Ae.prototype.thru;for(i&&o.reverse();c--;){var g=o[c];if(typeof g!="function")throw new Oe(h);if(p&&!v&&_o(g)=="wrapper")var v=new Ae([],!0)}for(c=v?c:u;++c<u;){g=o[c];var T=_o(g),w=T=="wrapper"?ja(g):e;w&&qa(w[0])&&w[1]==(_e|Z|Ot|Ji)&&!w[4].length&&w[9]==1?v=v[_o(w[0])].apply(v,w[3]):v=g.length==1&&qa(g)?v[T]():v.thru(g)}return function(){var L=arguments,E=L[0];if(v&&L.length==1&&W(E))return v.plant(E).value();for(var O=0,M=u?o[O].apply(this,L):E;++O<u;)M=o[O].call(this,M);return M}})}function wo(i,o,u,c,p,g,v,T,w,L){var E=o&_e,O=o&F,M=o&B,R=o&(Z|ht),G=o&js,$=M?e:vn(i);function U(){for(var Y=arguments.length,X=x(Y),be=Y;be--;)X[be]=arguments[be];if(R)var ee=Oi(U),Te=Dg(X,ee);if(c&&(X=Gc(X,c,p,R)),g&&(X=Uc(X,g,v,R)),Y-=Te,R&&Y<L){var wt=Dr(X,ee);return Yc(i,o,wo,U.placeholder,u,X,wt,T,w,L-Y)}var He=O?u:this,Cr=M?He[i]:i;return Y=X.length,T?X=Gv(X,T):G&&Y>1&&X.reverse(),E&&w<Y&&(X.length=w),this&&this!==Rt&&this instanceof U&&(Cr=$||vn(Cr)),Cr.apply(He,X)}return U}function $c(i,o){return function(u,c){return Qy(u,i,o(c),{})}}function xo(i,o){return function(u,c){var p;if(u===e&&c===e)return o;if(u!==e&&(p=u),c!==e){if(p===e)return c;typeof u=="string"||typeof c=="string"?(u=ye(u),c=ye(c)):(u=Dc(u),c=Dc(c)),p=i(u,c)}return p}}function Na(i){return Pr(function(o){return o=pt(o,ge(V())),Q(function(u){var c=this;return i(o,function(p){return me(p,c,u)})})})}function So(i,o){o=o===e?" ":ye(o);var u=o.length;if(u<2)return u?Ia(o,i):o;var c=Ia(o,ho(i/wi(o)));return Pi(o)?Nr(Ue(c),0,i).join(""):c.slice(0,i)}function Pv(i,o,u,c){var p=o&F,g=vn(i);function v(){for(var T=-1,w=arguments.length,L=-1,E=c.length,O=x(E+w),M=this&&this!==Rt&&this instanceof v?g:i;++L<E;)O[L]=c[L];for(;w--;)O[L++]=arguments[++T];return me(M,p?u:this,O)}return v}function Qc(i){return function(o,u,c){return c&&typeof c!="number"&&te(o,u,c)&&(u=c=e),o=Sr(o),u===e?(u=o,o=0):u=Sr(u),c=c===e?o<u?1:-1:Sr(c),sv(o,u,c,i)}}function Co(i){return function(o,u){return typeof o=="string"&&typeof u=="string"||(o=ke(o),u=ke(u)),i(o,u)}}function Yc(i,o,u,c,p,g,v,T,w,L){var E=o&Z,O=E?v:e,M=E?e:v,R=E?g:e,G=E?e:g;o|=E?Ot:Ne,o&=~(E?Ne:Ot),o&j||(o&=~(F|B));var $=[i,o,p,R,O,G,M,T,w,L],U=u.apply(e,$);return qa(i)&&al(U,$),U.placeholder=c,ul(U,i,o)}function Va(i){var o=At[i];return function(u,c){if(u=ke(u),c=c==null?0:$t(q(c),292),c&&uc(u)){var p=(ot(u)+"e").split("e"),g=o(p[0]+"e"+(+p[1]+c));return p=(ot(g)+"e").split("e"),+(p[0]+"e"+(+p[1]-c))}return o(u)}}var wv=Si&&1/Zn(new Si([,-0]))[1]==Yr?function(i){return new Si(i)}:au;function Kc(i){return function(o){var u=Qt(o);return u==Ve?ma(o):u==Ge?Vg(o):Ig(o,i(o))}}function Tr(i,o,u,c,p,g,v,T){var w=o&B;if(!w&&typeof i!="function")throw new Oe(h);var L=c?c.length:0;if(L||(o&=~(Ot|Ne),c=p=e),v=v===e?v:It(q(v),0),T=T===e?T:q(T),L-=p?p.length:0,o&Ne){var E=c,O=p;c=p=e}var M=w?e:ja(i),R=[i,o,u,c,p,E,O,g,v,T];if(M&&zv(R,M),i=R[0],o=R[1],u=R[2],c=R[3],p=R[4],T=R[9]=R[9]===e?w?0:i.length:It(R[9]-L,0),!T&&o&(Z|ht)&&(o&=~(Z|ht)),!o||o==F)var G=bv(i,o,u);else o==Z||o==ht?G=Tv(i,o,T):(o==Ot||o==(F|Ot))&&!p.length?G=Pv(i,o,u,c):G=wo.apply(e,R);var $=M?Ac:al;return ul($(G,R),i,o)}function Xc(i,o,u,c){return i===e||Be(i,xi[u])&&!st.call(c,u)?o:i}function Jc(i,o,u,c,p,g){return gt(i)&&gt(o)&&(g.set(o,i),vo(i,o,e,Jc,g),g.delete(o)),i}function xv(i){return Pn(i)?e:i}function Zc(i,o,u,c,p,g){var v=u&A,T=i.length,w=o.length;if(T!=w&&!(v&&w>T))return!1;var L=g.get(i),E=g.get(o);if(L&&E)return L==o&&E==i;var O=-1,M=!0,R=u&I?new Zr:e;for(g.set(i,o),g.set(o,i);++O<T;){var G=i[O],$=o[O];if(c)var U=v?c($,G,O,o,i,g):c(G,$,O,i,o,g);if(U!==e){if(U)continue;M=!1;break}if(R){if(!ha(o,function(Y,X){if(!an(R,X)&&(G===Y||p(G,Y,u,c,g)))return R.push(X)})){M=!1;break}}else if(!(G===$||p(G,$,u,c,g))){M=!1;break}}return g.delete(i),g.delete(o),M}function Sv(i,o,u,c,p,g,v){switch(u){case vi:if(i.byteLength!=o.byteLength||i.byteOffset!=o.byteOffset)return!1;i=i.buffer,o=o.buffer;case sn:return!(i.byteLength!=o.byteLength||!g(new oo(i),new oo(o)));case Zi:case tn:case en:return Be(+i,+o);case Wn:return i.name==o.name&&i.message==o.message;case rn:case nn:return i==o+"";case Ve:var T=ma;case Ge:var w=c&A;if(T||(T=Zn),i.size!=o.size&&!w)return!1;var L=v.get(i);if(L)return L==o;c|=I,v.set(i,o);var E=Zc(T(i),T(o),c,p,g,v);return v.delete(i),E;case $n:if(fn)return fn.call(i)==fn.call(o)}return!1}function Cv(i,o,u,c,p,g){var v=u&A,T=Ga(i),w=T.length,L=Ga(o),E=L.length;if(w!=E&&!v)return!1;for(var O=w;O--;){var M=T[O];if(!(v?M in o:st.call(o,M)))return!1}var R=g.get(i),G=g.get(o);if(R&&G)return R==o&&G==i;var $=!0;g.set(i,o),g.set(o,i);for(var U=v;++O<w;){M=T[O];var Y=i[M],X=o[M];if(c)var be=v?c(X,Y,M,o,i,g):c(Y,X,M,i,o,g);if(!(be===e?Y===X||p(Y,X,u,c,g):be)){$=!1;break}U||(U=M=="constructor")}if($&&!U){var ee=i.constructor,Te=o.constructor;ee!=Te&&"constructor"in i&&"constructor"in o&&!(typeof ee=="function"&&ee instanceof ee&&typeof Te=="function"&&Te instanceof Te)&&($=!1)}return g.delete(i),g.delete(o),$}function Pr(i){return Qa(ol(i,e,dl),i+"")}function Ga(i){return bc(i,zt,Ha)}function Ua(i){return bc(i,he,tl)}var ja=lo?function(i){return lo.get(i)}:au;function _o(i){for(var o=i.name+"",u=Ci[o],c=st.call(Ci,o)?u.length:0;c--;){var p=u[c],g=p.func;if(g==null||g==i)return p.name}return o}function Oi(i){var o=st.call(m,"placeholder")?m:i;return o.placeholder}function V(){var i=m.iteratee||ou;return i=i===ou?wc:i,arguments.length?i(arguments[0],arguments[1]):i}function Lo(i,o){var u=i.__data__;return Mv(o)?u[typeof o=="string"?"string":"hash"]:u.map}function Ba(i){for(var o=zt(i),u=o.length;u--;){var c=o[u],p=i[c];o[u]=[c,p,il(p)]}return o}function ri(i,o){var u=Rg(i,o);return Pc(u)?u:e}function _v(i){var o=st.call(i,Xr),u=i[Xr];try{i[Xr]=e;var c=!0}catch(g){}var p=io.call(i);return c&&(o?i[Xr]=u:delete i[Xr]),p}var Ha=ya?function(i){return i==null?[]:(i=ut(i),Ar(ya(i),function(o){return sc.call(i,o)}))}:uu,tl=ya?function(i){for(var o=[];i;)Ir(o,Ha(i)),i=so(i);return o}:uu,Qt=Zt;(va&&Qt(new va(new ArrayBuffer(1)))!=vi||hn&&Qt(new hn)!=Ve||ba&&Qt(ba.resolve())!=gh||Si&&Qt(new Si)!=Ge||cn&&Qt(new cn)!=on)&&(Qt=function(i){var o=Zt(i),u=o==gr?i.constructor:e,c=u?ii(u):"";if(c)switch(c){case uy:return vi;case hy:return Ve;case cy:return gh;case ly:return Ge;case fy:return on}return o});function Lv(i,o,u){for(var c=-1,p=u.length;++c<p;){var g=u[c],v=g.size;switch(g.type){case"drop":i+=v;break;case"dropRight":o-=v;break;case"take":o=$t(o,i+v);break;case"takeRight":i=It(i,o-v);break}}return{start:i,end:o}}function Ev(i){var o=i.match(km);return o?o[1].split(Fm):[]}function el(i,o,u){o=zr(o,i);for(var c=-1,p=o.length,g=!1;++c<p;){var v=tr(o[c]);if(!(g=i!=null&&u(i,v)))break;i=i[v]}return g||++c!=p?g:(p=i==null?0:i.length,!!p&&ko(p)&&wr(v,p)&&(W(i)||ni(i)))}function Ov(i){var o=i.length,u=new i.constructor(o);return o&&typeof i[0]=="string"&&st.call(i,"index")&&(u.index=i.index,u.input=i.input),u}function rl(i){return typeof i.constructor=="function"&&!bn(i)?_i(so(i)):{}}function Av(i,o,u){var c=i.constructor;switch(o){case sn:return za(i);case Zi:case tn:return new c(+i);case vi:return pv(i,u);case Bs:case Hs:case Ws:case qs:case $s:case Qs:case Ys:case Ks:case Xs:return Nc(i,u);case Ve:return new c;case en:case nn:return new c(i);case rn:return dv(i);case Ge:return new c;case $n:return mv(i)}}function Iv(i,o){var u=o.length;if(!u)return i;var c=u-1;return o[c]=(u>1?"& ":"")+o[c],o=o.join(u>2?", ":" "),i.replace(Mm,`{
/* [wrapped with `+o+`] */
`)}function Dv(i){return W(i)||ni(i)||!!(ac&&i&&i[ac])}function wr(i,o){var u=typeof i;return o=o!=null?o:Or,!!o&&(u=="number"||u!="symbol"&&Hm.test(i))&&i>-1&&i%1==0&&i<o}function te(i,o,u){if(!gt(u))return!1;var c=typeof o;return(c=="number"?ue(u)&&wr(o,u.length):c=="string"&&o in u)?Be(u[o],i):!1}function Wa(i,o){if(W(i))return!1;var u=typeof i;return u=="number"||u=="symbol"||u=="boolean"||i==null||ve(i)?!0:Om.test(i)||!Em.test(i)||o!=null&&i in ut(o)}function Mv(i){var o=typeof i;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?i!=="__proto__":i===null}function qa(i){var o=_o(i),u=m[o];if(typeof u!="function"||!(o in K.prototype))return!1;if(i===u)return!0;var c=ja(u);return!!c&&i===c[0]}function kv(i){return!!ic&&ic in i}var Fv=eo?xr:hu;function bn(i){var o=i&&i.constructor,u=typeof o=="function"&&o.prototype||xi;return i===u}function il(i){return i===i&&!gt(i)}function nl(i,o){return function(u){return u==null?!1:u[i]===o&&(o!==e||i in ut(u))}}function Rv(i){var o=Do(i,function(c){return u.size===d&&u.clear(),c}),u=o.cache;return o}function zv(i,o){var u=i[1],c=o[1],p=u|c,g=p<(F|B|_e),v=c==_e&&u==Z||c==_e&&u==Ji&&i[7].length<=o[8]||c==(_e|Ji)&&o[7].length<=o[8]&&u==Z;if(!(g||v))return i;c&F&&(i[2]=o[2],p|=u&F?0:j);var T=o[3];if(T){var w=i[3];i[3]=w?Gc(w,T,o[4]):T,i[4]=w?Dr(i[3],y):o[4]}return T=o[5],T&&(w=i[5],i[5]=w?Uc(w,T,o[6]):T,i[6]=w?Dr(i[5],y):o[6]),T=o[7],T&&(i[7]=T),c&_e&&(i[8]=i[8]==null?o[8]:$t(i[8],o[8])),i[9]==null&&(i[9]=o[9]),i[0]=o[0],i[1]=p,i}function Nv(i){var o=[];if(i!=null)for(var u in ut(i))o.push(u);return o}function Vv(i){return io.call(i)}function ol(i,o,u){return o=It(o===e?i.length-1:o,0),function(){for(var c=arguments,p=-1,g=It(c.length-o,0),v=x(g);++p<g;)v[p]=c[o+p];p=-1;for(var T=x(o+1);++p<o;)T[p]=c[p];return T[o]=u(v),me(i,this,T)}}function sl(i,o){return o.length<2?i:ei(i,De(o,0,-1))}function Gv(i,o){for(var u=i.length,c=$t(o.length,u),p=ae(i);c--;){var g=o[c];i[c]=wr(g,u)?p[g]:e}return i}function $a(i,o){if(!(o==="constructor"&&typeof i[o]=="function")&&o!="__proto__")return i[o]}var al=hl(Ac),Tn=ey||function(i,o){return Rt.setTimeout(i,o)},Qa=hl(hv);function ul(i,o,u){var c=o+"";return Qa(i,Iv(c,Uv(Ev(c),u)))}function hl(i){var o=0,u=0;return function(){var c=oy(),p=um-(c-u);if(u=c,p>0){if(++o>=am)return arguments[0]}else o=0;return i.apply(e,arguments)}}function Eo(i,o){var u=-1,c=i.length,p=c-1;for(o=o===e?c:o;++u<o;){var g=Aa(u,p),v=i[g];i[g]=i[u],i[u]=v}return i.length=o,i}var cl=Rv(function(i){var o=[];return i.charCodeAt(0)===46&&o.push(""),i.replace(Am,function(u,c,p,g){o.push(p?g.replace(Nm,"$1"):c||u)}),o});function tr(i){if(typeof i=="string"||ve(i))return i;var o=i+"";return o=="0"&&1/i==-Yr?"-0":o}function ii(i){if(i!=null){try{return ro.call(i)}catch(o){}try{return i+""}catch(o){}}return""}function Uv(i,o){return Ee(dm,function(u){var c="_."+u[0];o&u[1]&&!Xn(i,c)&&i.push(c)}),i.sort()}function ll(i){if(i instanceof K)return i.clone();var o=new Ae(i.__wrapped__,i.__chain__);return o.__actions__=ae(i.__actions__),o.__index__=i.__index__,o.__values__=i.__values__,o}function jv(i,o,u){(u?te(i,o,u):o===e)?o=1:o=It(q(o),0);var c=i==null?0:i.length;if(!c||o<1)return[];for(var p=0,g=0,v=x(ho(c/o));p<c;)v[g++]=De(i,p,p+=o);return v}function Bv(i){for(var o=-1,u=i==null?0:i.length,c=0,p=[];++o<u;){var g=i[o];g&&(p[c++]=g)}return p}function Hv(){var i=arguments.length;if(!i)return[];for(var o=x(i-1),u=arguments[0],c=i;c--;)o[c-1]=arguments[c];return Ir(W(u)?ae(u):[u],Bt(o,1))}var Wv=Q(function(i,o){return Pt(i)?dn(i,Bt(o,1,Pt,!0)):[]}),qv=Q(function(i,o){var u=Me(o);return Pt(u)&&(u=e),Pt(i)?dn(i,Bt(o,1,Pt,!0),V(u,2)):[]}),$v=Q(function(i,o){var u=Me(o);return Pt(u)&&(u=e),Pt(i)?dn(i,Bt(o,1,Pt,!0),e,u):[]});function Qv(i,o,u){var c=i==null?0:i.length;return c?(o=u||o===e?1:q(o),De(i,o<0?0:o,c)):[]}function Yv(i,o,u){var c=i==null?0:i.length;return c?(o=u||o===e?1:q(o),o=c-o,De(i,0,o<0?0:o)):[]}function Kv(i,o){return i&&i.length?To(i,V(o,3),!0,!0):[]}function Xv(i,o){return i&&i.length?To(i,V(o,3),!0):[]}function Jv(i,o,u,c){var p=i==null?0:i.length;return p?(u&&typeof u!="number"&&te(i,o,u)&&(u=0,c=p),Hy(i,o,u,c)):[]}function fl(i,o,u){var c=i==null?0:i.length;if(!c)return-1;var p=u==null?0:q(u);return p<0&&(p=It(c+p,0)),Jn(i,V(o,3),p)}function pl(i,o,u){var c=i==null?0:i.length;if(!c)return-1;var p=c-1;return u!==e&&(p=q(u),p=u<0?It(c+p,0):$t(p,c-1)),Jn(i,V(o,3),p,!0)}function dl(i){var o=i==null?0:i.length;return o?Bt(i,1):[]}function Zv(i){var o=i==null?0:i.length;return o?Bt(i,Yr):[]}function tb(i,o){var u=i==null?0:i.length;return u?(o=o===e?1:q(o),Bt(i,o)):[]}function eb(i){for(var o=-1,u=i==null?0:i.length,c={};++o<u;){var p=i[o];c[p[0]]=p[1]}return c}function ml(i){return i&&i.length?i[0]:e}function rb(i,o,u){var c=i==null?0:i.length;if(!c)return-1;var p=u==null?0:q(u);return p<0&&(p=It(c+p,0)),Ti(i,o,p)}function ib(i){var o=i==null?0:i.length;return o?De(i,0,-1):[]}var nb=Q(function(i){var o=pt(i,Fa);return o.length&&o[0]===i[0]?Ca(o):[]}),ob=Q(function(i){var o=Me(i),u=pt(i,Fa);return o===Me(u)?o=e:u.pop(),u.length&&u[0]===i[0]?Ca(u,V(o,2)):[]}),sb=Q(function(i){var o=Me(i),u=pt(i,Fa);return o=typeof o=="function"?o:e,o&&u.pop(),u.length&&u[0]===i[0]?Ca(u,e,o):[]});function ab(i,o){return i==null?"":iy.call(i,o)}function Me(i){var o=i==null?0:i.length;return o?i[o-1]:e}function ub(i,o,u){var c=i==null?0:i.length;if(!c)return-1;var p=c;return u!==e&&(p=q(u),p=p<0?It(c+p,0):$t(p,c-1)),o===o?Ug(i,o,p):Jn(i,Yh,p,!0)}function hb(i,o){return i&&i.length?_c(i,q(o)):e}var cb=Q(gl);function gl(i,o){return i&&i.length&&o&&o.length?Oa(i,o):i}function lb(i,o,u){return i&&i.length&&o&&o.length?Oa(i,o,V(u,2)):i}function fb(i,o,u){return i&&i.length&&o&&o.length?Oa(i,o,e,u):i}var pb=Pr(function(i,o){var u=i==null?0:i.length,c=Pa(i,o);return Oc(i,pt(o,function(p){return wr(p,u)?+p:p}).sort(Vc)),c});function db(i,o){var u=[];if(!(i&&i.length))return u;var c=-1,p=[],g=i.length;for(o=V(o,3);++c<g;){var v=i[c];o(v,c,i)&&(u.push(v),p.push(c))}return Oc(i,p),u}function Ya(i){return i==null?i:ay.call(i)}function mb(i,o,u){var c=i==null?0:i.length;return c?(u&&typeof u!="number"&&te(i,o,u)?(o=0,u=c):(o=o==null?0:q(o),u=u===e?c:q(u)),De(i,o,u)):[]}function gb(i,o){return bo(i,o)}function yb(i,o,u){return Da(i,o,V(u,2))}function vb(i,o){var u=i==null?0:i.length;if(u){var c=bo(i,o);if(c<u&&Be(i[c],o))return c}return-1}function bb(i,o){return bo(i,o,!0)}function Tb(i,o,u){return Da(i,o,V(u,2),!0)}function Pb(i,o){var u=i==null?0:i.length;if(u){var c=bo(i,o,!0)-1;if(Be(i[c],o))return c}return-1}function wb(i){return i&&i.length?Ic(i):[]}function xb(i,o){return i&&i.length?Ic(i,V(o,2)):[]}function Sb(i){var o=i==null?0:i.length;return o?De(i,1,o):[]}function Cb(i,o,u){return i&&i.length?(o=u||o===e?1:q(o),De(i,0,o<0?0:o)):[]}function _b(i,o,u){var c=i==null?0:i.length;return c?(o=u||o===e?1:q(o),o=c-o,De(i,o<0?0:o,c)):[]}function Lb(i,o){return i&&i.length?To(i,V(o,3),!1,!0):[]}function Eb(i,o){return i&&i.length?To(i,V(o,3)):[]}var Ob=Q(function(i){return Rr(Bt(i,1,Pt,!0))}),Ab=Q(function(i){var o=Me(i);return Pt(o)&&(o=e),Rr(Bt(i,1,Pt,!0),V(o,2))}),Ib=Q(function(i){var o=Me(i);return o=typeof o=="function"?o:e,Rr(Bt(i,1,Pt,!0),e,o)});function Db(i){return i&&i.length?Rr(i):[]}function Mb(i,o){return i&&i.length?Rr(i,V(o,2)):[]}function kb(i,o){return o=typeof o=="function"?o:e,i&&i.length?Rr(i,e,o):[]}function Ka(i){if(!(i&&i.length))return[];var o=0;return i=Ar(i,function(u){if(Pt(u))return o=It(u.length,o),!0}),pa(o,function(u){return pt(i,ca(u))})}function yl(i,o){if(!(i&&i.length))return[];var u=Ka(i);return o==null?u:pt(u,function(c){return me(o,e,c)})}var Fb=Q(function(i,o){return Pt(i)?dn(i,o):[]}),Rb=Q(function(i){return ka(Ar(i,Pt))}),zb=Q(function(i){var o=Me(i);return Pt(o)&&(o=e),ka(Ar(i,Pt),V(o,2))}),Nb=Q(function(i){var o=Me(i);return o=typeof o=="function"?o:e,ka(Ar(i,Pt),e,o)}),Vb=Q(Ka);function Gb(i,o){return Fc(i||[],o||[],pn)}function Ub(i,o){return Fc(i||[],o||[],yn)}var jb=Q(function(i){var o=i.length,u=o>1?i[o-1]:e;return u=typeof u=="function"?(i.pop(),u):e,yl(i,u)});function vl(i){var o=m(i);return o.__chain__=!0,o}function Bb(i,o){return o(i),i}function Oo(i,o){return o(i)}var Hb=Pr(function(i){var o=i.length,u=o?i[0]:0,c=this.__wrapped__,p=function(g){return Pa(g,i)};return o>1||this.__actions__.length||!(c instanceof K)||!wr(u)?this.thru(p):(c=c.slice(u,+u+(o?1:0)),c.__actions__.push({func:Oo,args:[p],thisArg:e}),new Ae(c,this.__chain__).thru(function(g){return o&&!g.length&&g.push(e),g}))});function Wb(){return vl(this)}function qb(){return new Ae(this.value(),this.__chain__)}function $b(){this.__values__===e&&(this.__values__=Dl(this.value()));var i=this.__index__>=this.__values__.length,o=i?e:this.__values__[this.__index__++];return{done:i,value:o}}function Qb(){return this}function Yb(i){for(var o,u=this;u instanceof po;){var c=ll(u);c.__index__=0,c.__values__=e,o?p.__wrapped__=c:o=c;var p=c;u=u.__wrapped__}return p.__wrapped__=i,o}function Kb(){var i=this.__wrapped__;if(i instanceof K){var o=i;return this.__actions__.length&&(o=new K(this)),o=o.reverse(),o.__actions__.push({func:Oo,args:[Ya],thisArg:e}),new Ae(o,this.__chain__)}return this.thru(Ya)}function Xb(){return kc(this.__wrapped__,this.__actions__)}var Jb=Po(function(i,o,u){st.call(i,u)?++i[u]:br(i,u,1)});function Zb(i,o,u){var c=W(i)?$h:By;return u&&te(i,o,u)&&(o=e),c(i,V(o,3))}function t0(i,o){var u=W(i)?Ar:yc;return u(i,V(o,3))}var e0=Wc(fl),r0=Wc(pl);function i0(i,o){return Bt(Ao(i,o),1)}function n0(i,o){return Bt(Ao(i,o),Yr)}function o0(i,o,u){return u=u===e?1:q(u),Bt(Ao(i,o),u)}function bl(i,o){var u=W(i)?Ee:Fr;return u(i,V(o,3))}function Tl(i,o){var u=W(i)?Sg:gc;return u(i,V(o,3))}var s0=Po(function(i,o,u){st.call(i,u)?i[u].push(o):br(i,u,[o])});function a0(i,o,u,c){i=ue(i)?i:Ii(i),u=u&&!c?q(u):0;var p=i.length;return u<0&&(u=It(p+u,0)),Fo(i)?u<=p&&i.indexOf(o,u)>-1:!!p&&Ti(i,o,u)>-1}var u0=Q(function(i,o,u){var c=-1,p=typeof o=="function",g=ue(i)?x(i.length):[];return Fr(i,function(v){g[++c]=p?me(o,v,u):mn(v,o,u)}),g}),h0=Po(function(i,o,u){br(i,u,o)});function Ao(i,o){var u=W(i)?pt:xc;return u(i,V(o,3))}function c0(i,o,u,c){return i==null?[]:(W(o)||(o=o==null?[]:[o]),u=c?e:u,W(u)||(u=u==null?[]:[u]),Lc(i,o,u))}var l0=Po(function(i,o,u){i[u?0:1].push(o)},function(){return[[],[]]});function f0(i,o,u){var c=W(i)?ua:Xh,p=arguments.length<3;return c(i,V(o,4),u,p,Fr)}function p0(i,o,u){var c=W(i)?Cg:Xh,p=arguments.length<3;return c(i,V(o,4),u,p,gc)}function d0(i,o){var u=W(i)?Ar:yc;return u(i,Mo(V(o,3)))}function m0(i){var o=W(i)?fc:av;return o(i)}function g0(i,o,u){(u?te(i,o,u):o===e)?o=1:o=q(o);var c=W(i)?Ny:uv;return c(i,o)}function y0(i){var o=W(i)?Vy:cv;return o(i)}function v0(i){if(i==null)return 0;if(ue(i))return Fo(i)?wi(i):i.length;var o=Qt(i);return o==Ve||o==Ge?i.size:La(i).length}function b0(i,o,u){var c=W(i)?ha:lv;return u&&te(i,o,u)&&(o=e),c(i,V(o,3))}var T0=Q(function(i,o){if(i==null)return[];var u=o.length;return u>1&&te(i,o[0],o[1])?o=[]:u>2&&te(o[0],o[1],o[2])&&(o=[o[0]]),Lc(i,Bt(o,1),[])}),Io=ty||function(){return Rt.Date.now()};function P0(i,o){if(typeof o!="function")throw new Oe(h);return i=q(i),function(){if(--i<1)return o.apply(this,arguments)}}function Pl(i,o,u){return o=u?e:o,o=i&&o==null?i.length:o,Tr(i,_e,e,e,e,e,o)}function wl(i,o){var u;if(typeof o!="function")throw new Oe(h);return i=q(i),function(){return--i>0&&(u=o.apply(this,arguments)),i<=1&&(o=e),u}}var Xa=Q(function(i,o,u){var c=F;if(u.length){var p=Dr(u,Oi(Xa));c|=Ot}return Tr(i,c,o,u,p)}),xl=Q(function(i,o,u){var c=F|B;if(u.length){var p=Dr(u,Oi(xl));c|=Ot}return Tr(o,c,i,u,p)});function Sl(i,o,u){o=u?e:o;var c=Tr(i,Z,e,e,e,e,e,o);return c.placeholder=Sl.placeholder,c}function Cl(i,o,u){o=u?e:o;var c=Tr(i,ht,e,e,e,e,e,o);return c.placeholder=Cl.placeholder,c}function _l(i,o,u){var c,p,g,v,T,w,L=0,E=!1,O=!1,M=!0;if(typeof i!="function")throw new Oe(h);o=ke(o)||0,gt(u)&&(E=!!u.leading,O="maxWait"in u,g=O?It(ke(u.maxWait)||0,o):g,M="trailing"in u?!!u.trailing:M);function R(wt){var He=c,Cr=p;return c=p=e,L=wt,v=i.apply(Cr,He),v}function G(wt){return L=wt,T=Tn(Y,o),E?R(wt):v}function $(wt){var He=wt-w,Cr=wt-L,Wl=o-He;return O?$t(Wl,g-Cr):Wl}function U(wt){var He=wt-w,Cr=wt-L;return w===e||He>=o||He<0||O&&Cr>=g}function Y(){var wt=Io();if(U(wt))return X(wt);T=Tn(Y,$(wt))}function X(wt){return T=e,M&&c?R(wt):(c=p=e,v)}function be(){T!==e&&Rc(T),L=0,c=w=p=T=e}function ee(){return T===e?v:X(Io())}function Te(){var wt=Io(),He=U(wt);if(c=arguments,p=this,w=wt,He){if(T===e)return G(w);if(O)return Rc(T),T=Tn(Y,o),R(w)}return T===e&&(T=Tn(Y,o)),v}return Te.cancel=be,Te.flush=ee,Te}var w0=Q(function(i,o){return mc(i,1,o)}),x0=Q(function(i,o,u){return mc(i,ke(o)||0,u)});function S0(i){return Tr(i,js)}function Do(i,o){if(typeof i!="function"||o!=null&&typeof o!="function")throw new Oe(h);var u=function(){var c=arguments,p=o?o.apply(this,c):c[0],g=u.cache;if(g.has(p))return g.get(p);var v=i.apply(this,c);return u.cache=g.set(p,v)||g,v};return u.cache=new(Do.Cache||vr),u}Do.Cache=vr;function Mo(i){if(typeof i!="function")throw new Oe(h);return function(){var o=arguments;switch(o.length){case 0:return!i.call(this);case 1:return!i.call(this,o[0]);case 2:return!i.call(this,o[0],o[1]);case 3:return!i.call(this,o[0],o[1],o[2])}return!i.apply(this,o)}}function C0(i){return wl(2,i)}var _0=fv(function(i,o){o=o.length==1&&W(o[0])?pt(o[0],ge(V())):pt(Bt(o,1),ge(V()));var u=o.length;return Q(function(c){for(var p=-1,g=$t(c.length,u);++p<g;)c[p]=o[p].call(this,c[p]);return me(i,this,c)})}),Ja=Q(function(i,o){var u=Dr(o,Oi(Ja));return Tr(i,Ot,e,o,u)}),Ll=Q(function(i,o){var u=Dr(o,Oi(Ll));return Tr(i,Ne,e,o,u)}),L0=Pr(function(i,o){return Tr(i,Ji,e,e,e,o)});function E0(i,o){if(typeof i!="function")throw new Oe(h);return o=o===e?o:q(o),Q(i,o)}function O0(i,o){if(typeof i!="function")throw new Oe(h);return o=o==null?0:It(q(o),0),Q(function(u){var c=u[o],p=Nr(u,0,o);return c&&Ir(p,c),me(i,this,p)})}function A0(i,o,u){var c=!0,p=!0;if(typeof i!="function")throw new Oe(h);return gt(u)&&(c="leading"in u?!!u.leading:c,p="trailing"in u?!!u.trailing:p),_l(i,o,{leading:c,maxWait:o,trailing:p})}function I0(i){return Pl(i,1)}function D0(i,o){return Ja(Ra(o),i)}function M0(){if(!arguments.length)return[];var i=arguments[0];return W(i)?i:[i]}function k0(i){return Ie(i,C)}function F0(i,o){return o=typeof o=="function"?o:e,Ie(i,C,o)}function R0(i){return Ie(i,b|C)}function z0(i,o){return o=typeof o=="function"?o:e,Ie(i,b|C,o)}function N0(i,o){return o==null||dc(i,o,zt(o))}function Be(i,o){return i===o||i!==i&&o!==o}var V0=Co(Sa),G0=Co(function(i,o){return i>=o}),ni=Tc(function(){return arguments}())?Tc:function(i){return bt(i)&&st.call(i,"callee")&&!sc.call(i,"callee")},W=x.isArray,U0=Uh?ge(Uh):Yy;function ue(i){return i!=null&&ko(i.length)&&!xr(i)}function Pt(i){return bt(i)&&ue(i)}function j0(i){return i===!0||i===!1||bt(i)&&Zt(i)==Zi}var Vr=ry||hu,B0=jh?ge(jh):Ky;function H0(i){return bt(i)&&i.nodeType===1&&!Pn(i)}function W0(i){if(i==null)return!0;if(ue(i)&&(W(i)||typeof i=="string"||typeof i.splice=="function"||Vr(i)||Ai(i)||ni(i)))return!i.length;var o=Qt(i);if(o==Ve||o==Ge)return!i.size;if(bn(i))return!La(i).length;for(var u in i)if(st.call(i,u))return!1;return!0}function q0(i,o){return gn(i,o)}function $0(i,o,u){u=typeof u=="function"?u:e;var c=u?u(i,o):e;return c===e?gn(i,o,e,u):!!c}function Za(i){if(!bt(i))return!1;var o=Zt(i);return o==Wn||o==gm||typeof i.message=="string"&&typeof i.name=="string"&&!Pn(i)}function Q0(i){return typeof i=="number"&&uc(i)}function xr(i){if(!gt(i))return!1;var o=Zt(i);return o==qn||o==mh||o==mm||o==vm}function El(i){return typeof i=="number"&&i==q(i)}function ko(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=Or}function gt(i){var o=typeof i;return i!=null&&(o=="object"||o=="function")}function bt(i){return i!=null&&typeof i=="object"}var Ol=Bh?ge(Bh):Jy;function Y0(i,o){return i===o||_a(i,o,Ba(o))}function K0(i,o,u){return u=typeof u=="function"?u:e,_a(i,o,Ba(o),u)}function X0(i){return Al(i)&&i!=+i}function J0(i){if(Fv(i))throw new H(a);return Pc(i)}function Z0(i){return i===null}function tT(i){return i==null}function Al(i){return typeof i=="number"||bt(i)&&Zt(i)==en}function Pn(i){if(!bt(i)||Zt(i)!=gr)return!1;var o=so(i);if(o===null)return!0;var u=st.call(o,"constructor")&&o.constructor;return typeof u=="function"&&u instanceof u&&ro.call(u)==Kg}var tu=Hh?ge(Hh):Zy;function eT(i){return El(i)&&i>=-Or&&i<=Or}var Il=Wh?ge(Wh):tv;function Fo(i){return typeof i=="string"||!W(i)&&bt(i)&&Zt(i)==nn}function ve(i){return typeof i=="symbol"||bt(i)&&Zt(i)==$n}var Ai=qh?ge(qh):ev;function rT(i){return i===e}function iT(i){return bt(i)&&Qt(i)==on}function nT(i){return bt(i)&&Zt(i)==Tm}var oT=Co(Ea),sT=Co(function(i,o){return i<=o});function Dl(i){if(!i)return[];if(ue(i))return Fo(i)?Ue(i):ae(i);if(un&&i[un])return Ng(i[un]());var o=Qt(i),u=o==Ve?ma:o==Ge?Zn:Ii;return u(i)}function Sr(i){if(!i)return i===0?i:0;if(i=ke(i),i===Yr||i===-Yr){var o=i<0?-1:1;return o*lm}return i===i?i:0}function q(i){var o=Sr(i),u=o%1;return o===o?u?o-u:o:0}function Ml(i){return i?ti(q(i),0,Xe):0}function ke(i){if(typeof i=="number")return i;if(ve(i))return Bn;if(gt(i)){var o=typeof i.valueOf=="function"?i.valueOf():i;i=gt(o)?o+"":o}if(typeof i!="string")return i===0?i:+i;i=Jh(i);var u=Um.test(i);return u||Bm.test(i)?Pg(i.slice(2),u?2:8):Gm.test(i)?Bn:+i}function kl(i){return Ze(i,he(i))}function aT(i){return i?ti(q(i),-Or,Or):i===0?i:0}function ot(i){return i==null?"":ye(i)}var uT=Li(function(i,o){if(bn(o)||ue(o)){Ze(o,zt(o),i);return}for(var u in o)st.call(o,u)&&pn(i,u,o[u])}),Fl=Li(function(i,o){Ze(o,he(o),i)}),Ro=Li(function(i,o,u,c){Ze(o,he(o),i,c)}),hT=Li(function(i,o,u,c){Ze(o,zt(o),i,c)}),cT=Pr(Pa);function lT(i,o){var u=_i(i);return o==null?u:pc(u,o)}var fT=Q(function(i,o){i=ut(i);var u=-1,c=o.length,p=c>2?o[2]:e;for(p&&te(o[0],o[1],p)&&(c=1);++u<c;)for(var g=o[u],v=he(g),T=-1,w=v.length;++T<w;){var L=v[T],E=i[L];(E===e||Be(E,xi[L])&&!st.call(i,L))&&(i[L]=g[L])}return i}),pT=Q(function(i){return i.push(e,Jc),me(Rl,e,i)});function dT(i,o){return Qh(i,V(o,3),Je)}function mT(i,o){return Qh(i,V(o,3),xa)}function gT(i,o){return i==null?i:wa(i,V(o,3),he)}function yT(i,o){return i==null?i:vc(i,V(o,3),he)}function vT(i,o){return i&&Je(i,V(o,3))}function bT(i,o){return i&&xa(i,V(o,3))}function TT(i){return i==null?[]:yo(i,zt(i))}function PT(i){return i==null?[]:yo(i,he(i))}function eu(i,o,u){var c=i==null?e:ei(i,o);return c===e?u:c}function wT(i,o){return i!=null&&el(i,o,Wy)}function ru(i,o){return i!=null&&el(i,o,qy)}var xT=$c(function(i,o,u){o!=null&&typeof o.toString!="function"&&(o=io.call(o)),i[o]=u},nu(ce)),ST=$c(function(i,o,u){o!=null&&typeof o.toString!="function"&&(o=io.call(o)),st.call(i,o)?i[o].push(u):i[o]=[u]},V),CT=Q(mn);function zt(i){return ue(i)?lc(i):La(i)}function he(i){return ue(i)?lc(i,!0):rv(i)}function _T(i,o){var u={};return o=V(o,3),Je(i,function(c,p,g){br(u,o(c,p,g),c)}),u}function LT(i,o){var u={};return o=V(o,3),Je(i,function(c,p,g){br(u,p,o(c,p,g))}),u}var ET=Li(function(i,o,u){vo(i,o,u)}),Rl=Li(function(i,o,u,c){vo(i,o,u,c)}),OT=Pr(function(i,o){var u={};if(i==null)return u;var c=!1;o=pt(o,function(g){return g=zr(g,i),c||(c=g.length>1),g}),Ze(i,Ua(i),u),c&&(u=Ie(u,b|S|C,xv));for(var p=o.length;p--;)Ma(u,o[p]);return u});function AT(i,o){return zl(i,Mo(V(o)))}var IT=Pr(function(i,o){return i==null?{}:nv(i,o)});function zl(i,o){if(i==null)return{};var u=pt(Ua(i),function(c){return[c]});return o=V(o),Ec(i,u,function(c,p){return o(c,p[0])})}function DT(i,o,u){o=zr(o,i);var c=-1,p=o.length;for(p||(p=1,i=e);++c<p;){var g=i==null?e:i[tr(o[c])];g===e&&(c=p,g=u),i=xr(g)?g.call(i):g}return i}function MT(i,o,u){return i==null?i:yn(i,o,u)}function kT(i,o,u,c){return c=typeof c=="function"?c:e,i==null?i:yn(i,o,u,c)}var Nl=Kc(zt),Vl=Kc(he);function FT(i,o,u){var c=W(i),p=c||Vr(i)||Ai(i);if(o=V(o,4),u==null){var g=i&&i.constructor;p?u=c?new g:[]:gt(i)?u=xr(g)?_i(so(i)):{}:u={}}return(p?Ee:Je)(i,function(v,T,w){return o(u,v,T,w)}),u}function RT(i,o){return i==null?!0:Ma(i,o)}function zT(i,o,u){return i==null?i:Mc(i,o,Ra(u))}function NT(i,o,u,c){return c=typeof c=="function"?c:e,i==null?i:Mc(i,o,Ra(u),c)}function Ii(i){return i==null?[]:da(i,zt(i))}function VT(i){return i==null?[]:da(i,he(i))}function GT(i,o,u){return u===e&&(u=o,o=e),u!==e&&(u=ke(u),u=u===u?u:0),o!==e&&(o=ke(o),o=o===o?o:0),ti(ke(i),o,u)}function UT(i,o,u){return o=Sr(o),u===e?(u=o,o=0):u=Sr(u),i=ke(i),$y(i,o,u)}function jT(i,o,u){if(u&&typeof u!="boolean"&&te(i,o,u)&&(o=u=e),u===e&&(typeof o=="boolean"?(u=o,o=e):typeof i=="boolean"&&(u=i,i=e)),i===e&&o===e?(i=0,o=1):(i=Sr(i),o===e?(o=i,i=0):o=Sr(o)),i>o){var c=i;i=o,o=c}if(u||i%1||o%1){var p=hc();return $t(i+p*(o-i+Tg("1e-"+((p+"").length-1))),o)}return Aa(i,o)}var BT=Ei(function(i,o,u){return o=o.toLowerCase(),i+(u?Gl(o):o)});function Gl(i){return iu(ot(i).toLowerCase())}function Ul(i){return i=ot(i),i&&i.replace(Wm,Mg).replace(cg,"")}function HT(i,o,u){i=ot(i),o=ye(o);var c=i.length;u=u===e?c:ti(q(u),0,c);var p=u;return u-=o.length,u>=0&&i.slice(u,p)==o}function WT(i){return i=ot(i),i&&Cm.test(i)?i.replace(vh,kg):i}function qT(i){return i=ot(i),i&&Im.test(i)?i.replace(Js,"\\$&"):i}var $T=Ei(function(i,o,u){return i+(u?"-":"")+o.toLowerCase()}),QT=Ei(function(i,o,u){return i+(u?" ":"")+o.toLowerCase()}),YT=Hc("toLowerCase");function KT(i,o,u){i=ot(i),o=q(o);var c=o?wi(i):0;if(!o||c>=o)return i;var p=(o-c)/2;return So(co(p),u)+i+So(ho(p),u)}function XT(i,o,u){i=ot(i),o=q(o);var c=o?wi(i):0;return o&&c<o?i+So(o-c,u):i}function JT(i,o,u){i=ot(i),o=q(o);var c=o?wi(i):0;return o&&c<o?So(o-c,u)+i:i}function ZT(i,o,u){return u||o==null?o=0:o&&(o=+o),sy(ot(i).replace(Zs,""),o||0)}function tP(i,o,u){return(u?te(i,o,u):o===e)?o=1:o=q(o),Ia(ot(i),o)}function eP(){var i=arguments,o=ot(i[0]);return i.length<3?o:o.replace(i[1],i[2])}var rP=Ei(function(i,o,u){return i+(u?"_":"")+o.toLowerCase()});function iP(i,o,u){return u&&typeof u!="number"&&te(i,o,u)&&(o=u=e),u=u===e?Xe:u>>>0,u?(i=ot(i),i&&(typeof o=="string"||o!=null&&!tu(o))&&(o=ye(o),!o&&Pi(i))?Nr(Ue(i),0,u):i.split(o,u)):[]}var nP=Ei(function(i,o,u){return i+(u?" ":"")+iu(o)});function oP(i,o,u){return i=ot(i),u=u==null?0:ti(q(u),0,i.length),o=ye(o),i.slice(u,u+o.length)==o}function sP(i,o,u){var c=m.templateSettings;u&&te(i,o,u)&&(o=e),i=ot(i),o=Ro({},o,c,Xc);var p=Ro({},o.imports,c.imports,Xc),g=zt(p),v=da(p,g),T,w,L=0,E=o.interpolate||Qn,O="__p += '",M=ga((o.escape||Qn).source+"|"+E.source+"|"+(E===bh?Vm:Qn).source+"|"+(o.evaluate||Qn).source+"|$","g"),R="//# sourceURL="+(st.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++mg+"]")+`
`;i.replace(M,function(U,Y,X,be,ee,Te){return X||(X=be),O+=i.slice(L,Te).replace(qm,Fg),Y&&(T=!0,O+=`' +
__e(`+Y+`) +
'`),ee&&(w=!0,O+=`';
`+ee+`;
__p += '`),X&&(O+=`' +
((__t = (`+X+`)) == null ? '' : __t) +
'`),L=Te+U.length,U}),O+=`';
`;var G=st.call(o,"variable")&&o.variable;if(!G)O=`with (obj) {
`+O+`
}
`;else if(zm.test(G))throw new H(l);O=(w?O.replace(Pm,""):O).replace(wm,"$1").replace(xm,"$1;"),O="function("+(G||"obj")+`) {
`+(G?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(T?", __e = _.escape":"")+(w?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+O+`return __p
}`;var $=Bl(function(){return rt(g,R+"return "+O).apply(e,v)});if($.source=O,Za($))throw $;return $}function aP(i){return ot(i).toLowerCase()}function uP(i){return ot(i).toUpperCase()}function hP(i,o,u){if(i=ot(i),i&&(u||o===e))return Jh(i);if(!i||!(o=ye(o)))return i;var c=Ue(i),p=Ue(o),g=Zh(c,p),v=tc(c,p)+1;return Nr(c,g,v).join("")}function cP(i,o,u){if(i=ot(i),i&&(u||o===e))return i.slice(0,rc(i)+1);if(!i||!(o=ye(o)))return i;var c=Ue(i),p=tc(c,Ue(o))+1;return Nr(c,0,p).join("")}function lP(i,o,u){if(i=ot(i),i&&(u||o===e))return i.replace(Zs,"");if(!i||!(o=ye(o)))return i;var c=Ue(i),p=Zh(c,Ue(o));return Nr(c,p).join("")}function fP(i,o){var u=om,c=sm;if(gt(o)){var p="separator"in o?o.separator:p;u="length"in o?q(o.length):u,c="omission"in o?ye(o.omission):c}i=ot(i);var g=i.length;if(Pi(i)){var v=Ue(i);g=v.length}if(u>=g)return i;var T=u-wi(c);if(T<1)return c;var w=v?Nr(v,0,T).join(""):i.slice(0,T);if(p===e)return w+c;if(v&&(T+=w.length-T),tu(p)){if(i.slice(T).search(p)){var L,E=w;for(p.global||(p=ga(p.source,ot(Th.exec(p))+"g")),p.lastIndex=0;L=p.exec(E);)var O=L.index;w=w.slice(0,O===e?T:O)}}else if(i.indexOf(ye(p),T)!=T){var M=w.lastIndexOf(p);M>-1&&(w=w.slice(0,M))}return w+c}function pP(i){return i=ot(i),i&&Sm.test(i)?i.replace(yh,jg):i}var dP=Ei(function(i,o,u){return i+(u?" ":"")+o.toUpperCase()}),iu=Hc("toUpperCase");function jl(i,o,u){return i=ot(i),o=u?e:o,o===e?zg(i)?Wg(i):Eg(i):i.match(o)||[]}var Bl=Q(function(i,o){try{return me(i,e,o)}catch(u){return Za(u)?u:new H(u)}}),mP=Pr(function(i,o){return Ee(o,function(u){u=tr(u),br(i,u,Xa(i[u],i))}),i});function gP(i){var o=i==null?0:i.length,u=V();return i=o?pt(i,function(c){if(typeof c[1]!="function")throw new Oe(h);return[u(c[0]),c[1]]}):[],Q(function(c){for(var p=-1;++p<o;){var g=i[p];if(me(g[0],this,c))return me(g[1],this,c)}})}function yP(i){return jy(Ie(i,b))}function nu(i){return function(){return i}}function vP(i,o){return i==null||i!==i?o:i}var bP=qc(),TP=qc(!0);function ce(i){return i}function ou(i){return wc(typeof i=="function"?i:Ie(i,b))}function PP(i){return Sc(Ie(i,b))}function wP(i,o){return Cc(i,Ie(o,b))}var xP=Q(function(i,o){return function(u){return mn(u,i,o)}}),SP=Q(function(i,o){return function(u){return mn(i,u,o)}});function su(i,o,u){var c=zt(o),p=yo(o,c);u==null&&!(gt(o)&&(p.length||!c.length))&&(u=o,o=i,i=this,p=yo(o,zt(o)));var g=!(gt(u)&&"chain"in u)||!!u.chain,v=xr(i);return Ee(p,function(T){var w=o[T];i[T]=w,v&&(i.prototype[T]=function(){var L=this.__chain__;if(g||L){var E=i(this.__wrapped__),O=E.__actions__=ae(this.__actions__);return O.push({func:w,args:arguments,thisArg:i}),E.__chain__=L,E}return w.apply(i,Ir([this.value()],arguments))})}),i}function CP(){return Rt._===this&&(Rt._=Xg),this}function au(){}function _P(i){return i=q(i),Q(function(o){return _c(o,i)})}var LP=Na(pt),EP=Na($h),OP=Na(ha);function Hl(i){return Wa(i)?ca(tr(i)):ov(i)}function AP(i){return function(o){return i==null?e:ei(i,o)}}var IP=Qc(),DP=Qc(!0);function uu(){return[]}function hu(){return!1}function MP(){return{}}function kP(){return""}function FP(){return!0}function RP(i,o){if(i=q(i),i<1||i>Or)return[];var u=Xe,c=$t(i,Xe);o=V(o),i-=Xe;for(var p=pa(c,o);++u<i;)o(u);return p}function zP(i){return W(i)?pt(i,tr):ve(i)?[i]:ae(cl(ot(i)))}function NP(i){var o=++Yg;return ot(i)+o}var VP=xo(function(i,o){return i+o},0),GP=Va("ceil"),UP=xo(function(i,o){return i/o},1),jP=Va("floor");function BP(i){return i&&i.length?go(i,ce,Sa):e}function HP(i,o){return i&&i.length?go(i,V(o,2),Sa):e}function WP(i){return Kh(i,ce)}function qP(i,o){return Kh(i,V(o,2))}function $P(i){return i&&i.length?go(i,ce,Ea):e}function QP(i,o){return i&&i.length?go(i,V(o,2),Ea):e}var YP=xo(function(i,o){return i*o},1),KP=Va("round"),XP=xo(function(i,o){return i-o},0);function JP(i){return i&&i.length?fa(i,ce):0}function ZP(i,o){return i&&i.length?fa(i,V(o,2)):0}return m.after=P0,m.ary=Pl,m.assign=uT,m.assignIn=Fl,m.assignInWith=Ro,m.assignWith=hT,m.at=cT,m.before=wl,m.bind=Xa,m.bindAll=mP,m.bindKey=xl,m.castArray=M0,m.chain=vl,m.chunk=jv,m.compact=Bv,m.concat=Hv,m.cond=gP,m.conforms=yP,m.constant=nu,m.countBy=Jb,m.create=lT,m.curry=Sl,m.curryRight=Cl,m.debounce=_l,m.defaults=fT,m.defaultsDeep=pT,m.defer=w0,m.delay=x0,m.difference=Wv,m.differenceBy=qv,m.differenceWith=$v,m.drop=Qv,m.dropRight=Yv,m.dropRightWhile=Kv,m.dropWhile=Xv,m.fill=Jv,m.filter=t0,m.flatMap=i0,m.flatMapDeep=n0,m.flatMapDepth=o0,m.flatten=dl,m.flattenDeep=Zv,m.flattenDepth=tb,m.flip=S0,m.flow=bP,m.flowRight=TP,m.fromPairs=eb,m.functions=TT,m.functionsIn=PT,m.groupBy=s0,m.initial=ib,m.intersection=nb,m.intersectionBy=ob,m.intersectionWith=sb,m.invert=xT,m.invertBy=ST,m.invokeMap=u0,m.iteratee=ou,m.keyBy=h0,m.keys=zt,m.keysIn=he,m.map=Ao,m.mapKeys=_T,m.mapValues=LT,m.matches=PP,m.matchesProperty=wP,m.memoize=Do,m.merge=ET,m.mergeWith=Rl,m.method=xP,m.methodOf=SP,m.mixin=su,m.negate=Mo,m.nthArg=_P,m.omit=OT,m.omitBy=AT,m.once=C0,m.orderBy=c0,m.over=LP,m.overArgs=_0,m.overEvery=EP,m.overSome=OP,m.partial=Ja,m.partialRight=Ll,m.partition=l0,m.pick=IT,m.pickBy=zl,m.property=Hl,m.propertyOf=AP,m.pull=cb,m.pullAll=gl,m.pullAllBy=lb,m.pullAllWith=fb,m.pullAt=pb,m.range=IP,m.rangeRight=DP,m.rearg=L0,m.reject=d0,m.remove=db,m.rest=E0,m.reverse=Ya,m.sampleSize=g0,m.set=MT,m.setWith=kT,m.shuffle=y0,m.slice=mb,m.sortBy=T0,m.sortedUniq=wb,m.sortedUniqBy=xb,m.split=iP,m.spread=O0,m.tail=Sb,m.take=Cb,m.takeRight=_b,m.takeRightWhile=Lb,m.takeWhile=Eb,m.tap=Bb,m.throttle=A0,m.thru=Oo,m.toArray=Dl,m.toPairs=Nl,m.toPairsIn=Vl,m.toPath=zP,m.toPlainObject=kl,m.transform=FT,m.unary=I0,m.union=Ob,m.unionBy=Ab,m.unionWith=Ib,m.uniq=Db,m.uniqBy=Mb,m.uniqWith=kb,m.unset=RT,m.unzip=Ka,m.unzipWith=yl,m.update=zT,m.updateWith=NT,m.values=Ii,m.valuesIn=VT,m.without=Fb,m.words=jl,m.wrap=D0,m.xor=Rb,m.xorBy=zb,m.xorWith=Nb,m.zip=Vb,m.zipObject=Gb,m.zipObjectDeep=Ub,m.zipWith=jb,m.entries=Nl,m.entriesIn=Vl,m.extend=Fl,m.extendWith=Ro,su(m,m),m.add=VP,m.attempt=Bl,m.camelCase=BT,m.capitalize=Gl,m.ceil=GP,m.clamp=GT,m.clone=k0,m.cloneDeep=R0,m.cloneDeepWith=z0,m.cloneWith=F0,m.conformsTo=N0,m.deburr=Ul,m.defaultTo=vP,m.divide=UP,m.endsWith=HT,m.eq=Be,m.escape=WT,m.escapeRegExp=qT,m.every=Zb,m.find=e0,m.findIndex=fl,m.findKey=dT,m.findLast=r0,m.findLastIndex=pl,m.findLastKey=mT,m.floor=jP,m.forEach=bl,m.forEachRight=Tl,m.forIn=gT,m.forInRight=yT,m.forOwn=vT,m.forOwnRight=bT,m.get=eu,m.gt=V0,m.gte=G0,m.has=wT,m.hasIn=ru,m.head=ml,m.identity=ce,m.includes=a0,m.indexOf=rb,m.inRange=UT,m.invoke=CT,m.isArguments=ni,m.isArray=W,m.isArrayBuffer=U0,m.isArrayLike=ue,m.isArrayLikeObject=Pt,m.isBoolean=j0,m.isBuffer=Vr,m.isDate=B0,m.isElement=H0,m.isEmpty=W0,m.isEqual=q0,m.isEqualWith=$0,m.isError=Za,m.isFinite=Q0,m.isFunction=xr,m.isInteger=El,m.isLength=ko,m.isMap=Ol,m.isMatch=Y0,m.isMatchWith=K0,m.isNaN=X0,m.isNative=J0,m.isNil=tT,m.isNull=Z0,m.isNumber=Al,m.isObject=gt,m.isObjectLike=bt,m.isPlainObject=Pn,m.isRegExp=tu,m.isSafeInteger=eT,m.isSet=Il,m.isString=Fo,m.isSymbol=ve,m.isTypedArray=Ai,m.isUndefined=rT,m.isWeakMap=iT,m.isWeakSet=nT,m.join=ab,m.kebabCase=$T,m.last=Me,m.lastIndexOf=ub,m.lowerCase=QT,m.lowerFirst=YT,m.lt=oT,m.lte=sT,m.max=BP,m.maxBy=HP,m.mean=WP,m.meanBy=qP,m.min=$P,m.minBy=QP,m.stubArray=uu,m.stubFalse=hu,m.stubObject=MP,m.stubString=kP,m.stubTrue=FP,m.multiply=YP,m.nth=hb,m.noConflict=CP,m.noop=au,m.now=Io,m.pad=KT,m.padEnd=XT,m.padStart=JT,m.parseInt=ZT,m.random=jT,m.reduce=f0,m.reduceRight=p0,m.repeat=tP,m.replace=eP,m.result=DT,m.round=KP,m.runInContext=P,m.sample=m0,m.size=v0,m.snakeCase=rP,m.some=b0,m.sortedIndex=gb,m.sortedIndexBy=yb,m.sortedIndexOf=vb,m.sortedLastIndex=bb,m.sortedLastIndexBy=Tb,m.sortedLastIndexOf=Pb,m.startCase=nP,m.startsWith=oP,m.subtract=XP,m.sum=JP,m.sumBy=ZP,m.template=sP,m.times=RP,m.toFinite=Sr,m.toInteger=q,m.toLength=Ml,m.toLower=aP,m.toNumber=ke,m.toSafeInteger=aT,m.toString=ot,m.toUpper=uP,m.trim=hP,m.trimEnd=cP,m.trimStart=lP,m.truncate=fP,m.unescape=pP,m.uniqueId=NP,m.upperCase=dP,m.upperFirst=iu,m.each=bl,m.eachRight=Tl,m.first=ml,su(m,function(){var i={};return Je(m,function(o,u){st.call(m.prototype,u)||(i[u]=o)}),i}(),{chain:!1}),m.VERSION=n,Ee(["bind","bindKey","curry","curryRight","partial","partialRight"],function(i){m[i].placeholder=m}),Ee(["drop","take"],function(i,o){K.prototype[i]=function(u){u=u===e?1:It(q(u),0);var c=this.__filtered__&&!o?new K(this):this.clone();return c.__filtered__?c.__takeCount__=$t(u,c.__takeCount__):c.__views__.push({size:$t(u,Xe),type:i+(c.__dir__<0?"Right":"")}),c},K.prototype[i+"Right"]=function(u){return this.reverse()[i](u).reverse()}}),Ee(["filter","map","takeWhile"],function(i,o){var u=o+1,c=u==dh||u==cm;K.prototype[i]=function(p){var g=this.clone();return g.__iteratees__.push({iteratee:V(p,3),type:u}),g.__filtered__=g.__filtered__||c,g}}),Ee(["head","last"],function(i,o){var u="take"+(o?"Right":"");K.prototype[i]=function(){return this[u](1).value()[0]}}),Ee(["initial","tail"],function(i,o){var u="drop"+(o?"":"Right");K.prototype[i]=function(){return this.__filtered__?new K(this):this[u](1)}}),K.prototype.compact=function(){return this.filter(ce)},K.prototype.find=function(i){return this.filter(i).head()},K.prototype.findLast=function(i){return this.reverse().find(i)},K.prototype.invokeMap=Q(function(i,o){return typeof i=="function"?new K(this):this.map(function(u){return mn(u,i,o)})}),K.prototype.reject=function(i){return this.filter(Mo(V(i)))},K.prototype.slice=function(i,o){i=q(i);var u=this;return u.__filtered__&&(i>0||o<0)?new K(u):(i<0?u=u.takeRight(-i):i&&(u=u.drop(i)),o!==e&&(o=q(o),u=o<0?u.dropRight(-o):u.take(o-i)),u)},K.prototype.takeRightWhile=function(i){return this.reverse().takeWhile(i).reverse()},K.prototype.toArray=function(){return this.take(Xe)},Je(K.prototype,function(i,o){var u=/^(?:filter|find|map|reject)|While$/.test(o),c=/^(?:head|last)$/.test(o),p=m[c?"take"+(o=="last"?"Right":""):o],g=c||/^find/.test(o);p&&(m.prototype[o]=function(){var v=this.__wrapped__,T=c?[1]:arguments,w=v instanceof K,L=T[0],E=w||W(v),O=function(Y){var X=p.apply(m,Ir([Y],T));return c&&M?X[0]:X};E&&u&&typeof L=="function"&&L.length!=1&&(w=E=!1);var M=this.__chain__,R=!!this.__actions__.length,G=g&&!M,$=w&&!R;if(!g&&E){v=$?v:new K(this);var U=i.apply(v,T);return U.__actions__.push({func:Oo,args:[O],thisArg:e}),new Ae(U,M)}return G&&$?i.apply(this,T):(U=this.thru(O),G?c?U.value()[0]:U.value():U)})}),Ee(["pop","push","shift","sort","splice","unshift"],function(i){var o=to[i],u=/^(?:push|sort|unshift)$/.test(i)?"tap":"thru",c=/^(?:pop|shift)$/.test(i);m.prototype[i]=function(){var p=arguments;if(c&&!this.__chain__){var g=this.value();return o.apply(W(g)?g:[],p)}return this[u](function(v){return o.apply(W(v)?v:[],p)})}}),Je(K.prototype,function(i,o){var u=m[o];if(u){var c=u.name+"";st.call(Ci,c)||(Ci[c]=[]),Ci[c].push({name:o,func:u})}}),Ci[wo(e,B).name]=[{name:"wrapper",func:e}],K.prototype.clone=py,K.prototype.reverse=dy,K.prototype.value=my,m.prototype.at=Hb,m.prototype.chain=Wb,m.prototype.commit=qb,m.prototype.next=$b,m.prototype.plant=Yb,m.prototype.reverse=Kb,m.prototype.toJSON=m.prototype.valueOf=m.prototype.value=Xb,m.prototype.first=m.prototype.head,un&&(m.prototype[un]=Qb),m},Mr=qg();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(Rt._=Mr,define(function(){return Mr})):Kr?((Kr.exports=Mr)._=Mr,oa._=Mr):Rt._=Mr}).call(r)}),rm=class extends Set{constructor(r,t=!1){super(r),this.valuesAsFlags=t}};function Nn(r){if(r instanceof Map)return Object.fromEntries([...r.entries()].map(([t,e])=>[t,Nn(e)]));if(r instanceof Set)return Array.from(r.values()).map(Nn);if(r instanceof rm)return{values:[...r.values()],valuesAsFlags:r.valuesAsFlags};if(typeof r=="object"){let t={};return Object.entries(r).forEach(([e,n])=>{t[e]=Nn(n)}),t}else return r}var cD=uh(hh(),1);var VS=uh(hh(),1);function mi(r,t){if(typeof r!="object")throw new Error(`Cannot merge into non-object objectToMergeWith. Received: ${JSON.stringify(r)}`);if(typeof t!="object")throw new Error(`Cannot merge using non-object objectToMergeWith. Received: ${JSON.stringify(t)}`);let e=(0,VS.cloneDeep)(r);for(let[n,s]of Object.entries(t))typeof s!="object"||s instanceof Set||e[n]===void 0?e[n]=s:e[n]=mi(e[n],s);return e}function im(r,t){if(!(r===void 0||typeof r!="object"))for(let e of Object.keys(r)){if(e===t)return r[e];let n=r[e];if(typeof n=="object"){let s=im(n,t);if(s!==void 0)return s}}}var ah="@composite:",GS="@inherit:",US=class{constructor(r,t,e){this.tiledClassToMembersMap=r,this.enumNameToValuesMap=t,this.parserOptions=e,this.memoiser=new Map}flattenMembers(r,t){return this.memoiser.has(r)?{[r]:this.memoiser.get(r)}:(this.memoiser.set(r,t.reduce((e,n)=>it(it({},e),this.flattenMemberProperty(n)),{})),{[r]:this.memoiser.get(r)})}flattenMemberProperty(r){var e;let t=(e=r.propertyType)!=null?e:r.propertytype;if(r.type==="class"){if(!this.memoiser.has(t)){let a=this.tiledClassToMembersMap.get(t).reduce((h,l)=>mi(this.flattenMemberProperty(l),h),{});this.memoiser.set(t,a)}let n=this.memoiser.get(t),s=mi(n,this.flattenValue(r.value,n));return this.checkIfShouldFlatten(r.name)?s:{[r.name.replace(ah,"")]:s}}else return this.enumNameToValuesMap.has(t)?this.enumNameToValuesMap.get(t).valuesAsFlags?{[r.name]:new Set(r.value.split(",").filter(n=>n!==""))}:{[r.name]:r.value}:{[r.name]:r.value}}get memoisedFlattenedProperties(){return this.memoiser}flattenValue(r,t){return Object.entries(r).reduce((e,[n,s])=>{if(typeof s!="object")return im(t,n)instanceof Set?mi({[n]:new Set(s.split(",").filter(a=>a!==""))},e):mi({[n]:s},e);if(this.checkIfShouldFlatten(n))return mi(this.flattenValue(s,t),e);{let a=n.replace(ah,"");return mi({[a]:this.flattenValue(s,t)},e)}},{})}checkIfShouldFlatten(r){var t;return((t=this.parserOptions)==null?void 0:t.defaultComposite)===!0?r.startsWith(GS):!r.startsWith(ah)}},tm=uh(hh(),1),jS=class{constructor(r){this.flattener=r}flattenPropertiesOnObject(r){var t,e,n,s;return Pe(it(it({},this.flattener.memoisedFlattenedProperties.get((t=r.class)!=null?t:r.type)),(e=r.properties)==null?void 0:e.reduce((a,h)=>it(it({},a),this.flattener.flattenMemberProperty(h)),{})),{name:r.name,id:r.id,class:(s=(n=r.class)!=null?n:r.type)!=null?s:null,x:r.x,y:r.y})}flattenPropertiesOnTile(r){var t,e,n,s;return Pe(it(it({},this.flattener.memoisedFlattenedProperties.get((t=r.class)!=null?t:r.type)),(e=r.properties)==null?void 0:e.reduce((a,h)=>it(it({},a),this.flattener.flattenMemberProperty(h)),{})),{id:r.id,class:(s=(n=r.class)!=null?n:r.type)!=null?s:null})}getCustomTypesMap(){return new Map([...this.flattener.memoisedFlattenedProperties.entries()].map(([r,t])=>[r,(0,tm.cloneDeep)(t)]))}getEnumsMap(){return new Map([...this.flattener.enumNameToValuesMap.entries()].map(([r,t])=>[r,(0,tm.cloneDeep)(t)]))}toJSON(){return JSON.stringify({customTypes:Nn(this.getCustomTypesMap()),enums:Nn(this.getEnumsMap())},null,4)}};function BS(r,t){let e=new Map(r.propertyTypes.filter(a=>a.type==="enum").map(a=>[a.name,new rm(a.values,a.valuesAsFlags)])),n=new Map(r.propertyTypes.filter(a=>a.type==="class").map(a=>[a.name,a.members])),s=new US(n,e,t);return n.forEach((a,h)=>{s.flattenMembers(h,a)}),new jS(s)}var nm={parse:BS};var gi=class{constructor(t,e){this.phaserTile=t;this.tiledProject=e}getProperty(t){var s,a;let e={};if(this.tiledProject){let h=nm.parse(this.tiledProject),l=this.getType();if(l){let f=(s=h.getCustomTypesMap())==null?void 0:s.get(l);if(f)for(let[d,y]of Object.entries(f))e[d]=y}}return(a=this.phaserTile.properties[t])!=null?a:e[t]}hasProperty(t){return this.getProperty(t)!=null}getType(){var t,e;return(e=(t=this.phaserTile.tileset)==null?void 0:t.tileData[this.phaserTile.index-1])==null?void 0:e.type}};var Vn=class{constructor(t,e){this.phaserTilemapLayer=t;this.tiledProject=e}getName(){return this.phaserTilemapLayer.layer.name}getProperty(t){let e=this.phaserTilemapLayer.layer.properties,n=e==null?void 0:e.find(s=>s.name==t);return n==null?void 0:n.value}hasProperty(t){return this.getProperty(t)!=null}isCharLayer(){return this.hasProperty(Ki)}getData(){return this.phaserTilemapLayer.layer.data.map(t=>t.map(e=>new gi(e,this.tiledProject)))}};var Gs=class{constructor(t,e){this.phaserTilemap=t;this.tiledProject=e;for(let n of this.phaserTilemap.layers)if(n.tilemapLayer==null)throw new Error(`Error initializing tilemap. Layer '${n.name}' has no 'tilemapLayer'. This can happen if you call 'createLayer' with the wrong layer ID.`)}getTileWidth(){return this.phaserTilemap.tileWidth}getTileHeight(){return this.phaserTilemap.tileHeight}getWidth(){return this.phaserTilemap.width}getHeight(){return this.phaserTilemap.height}getOrientation(){return this.phaserTilemap.orientation==Phaser.Tilemaps.Orientation.ISOMETRIC.toString()?"isometric":"orthogonal"}getLayers(){return this.phaserTilemap.layers.map(t=>new Vn(t.tilemapLayer,this.tiledProject))}hasTileAt(t,e,n){return!!this.phaserTilemap.hasTileAt(t,e,n)}getTileAt(t,e,n){let s=this.phaserTilemap.getTileAt(t,e,!1,n);if(s)return new gi(s,this.tiledProject)}};var ch=class{constructor(t,e="orthogonal",n="ge_collide"){this.map=t;this.orientation=e;this.layerMap=new Map;this.layers=[];let s=-1,a=-1;Object.entries(t).map(([h,l])=>{var S;let f=(S=l.data[0])==null?void 0:S.length,d=l.data.length;if(s!==-1&&s!==f||a!==-1&&a!==d)throw new Error("All tilemap layers must have the same dimensions.");s=f,a=d;let y=[];for(let C=0;C<l.data.length;C++){let A=[];for(let I=0;I<l.data[C].length;I++){let F=new fh(l.data[C][I]===1,n);A.push(F)}y.push(A)}let b=new lh(h,y,l.isCharLayer);this.layers.push(b),this.layerMap.set(h,b)})}getWidth(){var t,e;return((e=(t=Object.values(this.map)[0])==null?void 0:t.data[0])==null?void 0:e.length)||0}getHeight(){var t;return((t=Object.values(this.map)[0])==null?void 0:t.data.length)||0}getOrientation(){return this.orientation}getLayers(){return this.layers}hasTileAt(t,e,n){return!n||!this.layerMap.get(n)?!1:t>=0&&t<this.getWidth()&&e>=0&&e<this.getHeight()}getTileAt(t,e,n){if(!n)return;let s=this.layerMap.get(n);if(s)return s.getData()[e][t]}},lh=class{constructor(t,e,n=!1){this.name=t;this.tiles=e;this.isCharLayerInternal=n}getName(){return this.name}getProperty(t){if(t==="ge_charLayer"&&this.isCharLayerInternal)return this.name}hasProperty(t){return t==="ge_charLayer"&&this.isCharLayerInternal}getData(){return this.tiles}isCharLayer(){return this.isCharLayerInternal}},fh=class{constructor(t,e){this.isBlocking=t;this.collisionPropertyName=e}getProperty(t){return t===this.collisionPropertyName?this.isBlocking:!1}hasProperty(t){return t===this.collisionPropertyName}};var Gn=class{constructor(t,e){this.props={};var a;let n=t.find(h=>{var d;if(!h.tiles)return!1;let l=(d=h.firstgid)!=null?d:0;return!!h.tiles.find(y=>y.id+l===e)});if(!n)return;let s=(a=n.tiles)==null?void 0:a.find(h=>{var l;return h.id+((l=n.firstgid)!=null?l:0)===e});if(s!=null&&s.properties)for(let h of s.properties)h.name&&(this.props[h.name]=h.value)}getProperty(t){return this.props[t]}hasProperty(t){return this.props[t]!==void 0}};var Un=class{constructor(t,e){this.layer=e;this.data=[];if(this.data=[],this.layer.data)for(let n=0;n<(this.layer.height||0);n++){let s=[];for(let a=0;a<(this.layer.width||0);a++){let h=this.layer.data[n*(this.layer.width||0)+a];h!==void 0?s.push(new Gn(t,h)):s.push(void 0)}this.data.push(s)}}getName(){return this.layer.name}getProperty(t){var e,n;return(n=(e=this.layer.properties)==null?void 0:e.find(s=>s.name===t))==null?void 0:n.value}hasProperty(t){return this.getProperty(t)!==void 0}getData(){return this.data}isCharLayer(){return this.hasProperty("ge_charLayer")}};var ph=class{constructor(t){this.rawTilemap=t;this.layers=[];var e;this.layers=(e=this.rawTilemap.layers)==null?void 0:e.map(n=>new Un(this.rawTilemap.tilesets,n))}hasTileAt(t,e,n){if(t<0||t>=this.rawTilemap.width||e<0||e>=this.rawTilemap.height||!this.rawTilemap.layers)return!1;let s=this.rawTilemap.layers.find(h=>h.name===n);if(!s)return!1;let a=e*this.rawTilemap.width+t;return s.data[a]>0}getTileAt(t,e,n){if(t<0||t>=this.rawTilemap.width||e<0||e>=this.rawTilemap.height||!this.rawTilemap.layers)return;let s=this.layers.find(a=>a.getName()===n);if(s)return s.getData()[e][t]}getOrientation(){return this.rawTilemap.orientation}getLayers(){return this.layers}getWidth(){return this.rawTilemap.width}getHeight(){return this.rawTilemap.height}};var jn=class jn{constructor(t){this.scene=t;this.geHeadless=new Ns(!1);this.isCreatedInternal=!1;jn.welcomeMessagePrinted||(console.log(`Using GridEngine Phaser Plugin v${Is}`),jn.welcomeMessagePrinted=!0),this.scene.sys.events.once("boot",this.boot,this)}boot(){this.scene.sys.events.on("update",this.update,this)}getCharLayer(t){return this.geHeadless.getCharLayer(t)}getTransition(t,e){return this.geHeadless.getTransition(t,e)}setTransition(t,e,n){this.geHeadless.setTransition(t,e,n)}create(t,e){this.geHeadless.create(new Gs(t,e.tiledProject),e),this.isCreatedInternal=!0,this.gridCharacters=new Map;let n=this.setConfigDefaults(e);this.config=n,this.gridTilemap=new ci(t),this.addCharacters()}getPosition(t){return this.geHeadless.getPosition(t)}move(t,e){this.geHeadless.move(t,e)}moveRandomly(t,e=0,n=-1){this.geHeadless.moveRandomly(t,e,n)}getMovement(t){return this.geHeadless.getMovement(t)}moveTo(t,e,n){return this.geHeadless.moveTo(t,e,n)}stopMovement(t){this.geHeadless.stopMovement(t)}setSpeed(t,e){this.geHeadless.setSpeed(t,e)}getSpeed(t){return this.geHeadless.getSpeed(t)}setContainer(t,e){var s;this.initGuard();let n=(s=this.gridCharacters)==null?void 0:s.get(t);if(!n)throw this.createCharUnknownErr(t);n.setContainer(e)}getContainer(t){var n;this.initGuard();let e=(n=this.gridCharacters)==null?void 0:n.get(t);if(!e)throw this.createCharUnknownErr(t);return e.getContainer()}getOffsetX(t){var n;this.initGuard();let e=(n=this.gridCharacters)==null?void 0:n.get(t);if(!e)throw this.createCharUnknownErr(t);return e.getOffsetX()}setOffsetX(t,e){var s;this.initGuard();let n=(s=this.gridCharacters)==null?void 0:s.get(t);if(!n)throw this.createCharUnknownErr(t);n.setOffsetX(e)}getOffsetY(t){var n;this.initGuard();let e=(n=this.gridCharacters)==null?void 0:n.get(t);if(!e)throw this.createCharUnknownErr(t);return e.getOffsetY()}setOffsetY(t,e){var s;this.initGuard();let n=(s=this.gridCharacters)==null?void 0:s.get(t);if(!n)throw this.createCharUnknownErr(t);n.setOffsetY(e)}collidesWithTiles(t){return this.geHeadless.collidesWithTiles(t)}getWalkingAnimationMapping(t){var s;this.initGuard();let e=(s=this.gridCharacters)==null?void 0:s.get(t);if(!e)throw this.createCharUnknownErr(t);let n=e.getAnimation();return n==null?void 0:n.getWalkingAnimationMapping()}hasLayerOverlay(){var t;return this.initGuard(),!!((t=this.config)!=null&&t.layerOverlay)}setWalkingAnimationMapping(t,e){var a;this.initGuard();let n=(a=this.gridCharacters)==null?void 0:a.get(t);if(!n)throw this.createCharUnknownErr(t);let s=n.getAnimation();s==null||s.setWalkingAnimationMapping(e)}update(t,e){if(this.isCreatedInternal&&this.gridCharacters)for(let[n,s]of this.gridCharacters)s.update(e);this.geHeadless.update(t,e)}addCharacter(t){this.geHeadless.addCharacter(t),this.addCharacterInternal(t)}hasCharacter(t){return this.geHeadless.hasCharacter(t)}removeCharacter(t){var n,s;this.initGuard();let e=(n=this.gridCharacters)==null?void 0:n.get(t);if(!e)throw this.createCharUnknownErr(t);e.destroy(),(s=this.gridCharacters)==null||s.delete(t),this.geHeadless.removeCharacter(t)}removeAllCharacters(){if(this.initGuard(),!!this.gridCharacters){for(let t of this.gridCharacters.keys())this.removeCharacter(t);this.geHeadless.removeAllCharacters()}}getAllCharacters(t){return this.geHeadless.getAllCharacters(t)}getLabels(t){return this.geHeadless.getLabels(t)}addLabels(t,e){this.geHeadless.addLabels(t,e)}removeLabels(t,e){this.geHeadless.removeLabels(t,e)}clearLabels(t){this.geHeadless.clearLabels(t)}follow(t,e,n,s){let a;n===void 0?a={distance:0,closestPointIfBlocked:!1}:typeof n=="number"?(a={distance:n,closestPointIfBlocked:!1},s&&(a.closestPointIfBlocked=!0)):a=n,this.geHeadless.follow(t,e,a)}isMoving(t){return this.geHeadless.isMoving(t)}getFacingDirection(t){return this.geHeadless.getFacingDirection(t)}getFacingPosition(t){return this.geHeadless.getFacingPosition(t)}turnTowards(t,e){var s;this.initGuard();let n=(s=this.gridCharacters)==null?void 0:s.get(t);if(!n)throw this.createCharUnknownErr(t);n.turnTowards(e),this.geHeadless.turnTowards(t,e)}getCharactersAt(t,e){return this.geHeadless.getCharactersAt(t,e)}setPosition(t,e,n){this.geHeadless.setPosition(t,e,n)}getSprite(t){var n;this.initGuard();let e=(n=this.gridCharacters)==null?void 0:n.get(t);if(!e)throw this.createCharUnknownErr(t);return e.getSprite()}setSprite(t,e){var s;this.initGuard();let n=(s=this.gridCharacters)==null?void 0:s.get(t);if(!n)throw this.createCharUnknownErr(t);e.setOrigin(0,0),n.setSprite(e)}isBlocked(t,e,n=["geDefault"]){return this.geHeadless.isBlocked(t,e,n)}isTileBlocked(t,e){return this.geHeadless.isTileBlocked(t,e)}getCollisionGroups(t){return this.geHeadless.getCollisionGroups(t)}setCollisionGroups(t,e){this.geHeadless.setCollisionGroups(t,e)}getIgnoreCollisionGroups(t){return this.geHeadless.getIgnoreCollisionGroups(t)}setIgnoreCollisionGroups(t,e){this.geHeadless.setIgnoreCollisionGroups(t,e)}getTilePosInDirection(t,e,n){return this.geHeadless.getTilePosInDirection(t,e,n)}findShortestPath(t,e,n={}){return this.geHeadless.findShortestPath(t,e,n)}steppedOn(t,e,n){return this.geHeadless.steppedOn(t,e,n)}characterShifted(){return this.geHeadless.characterShifted()}movementStarted(){return this.geHeadless.movementStarted()}movementStopped(){return this.geHeadless.movementStopped()}directionChanged(){return this.geHeadless.directionChanged()}positionChangeStarted(){return this.geHeadless.positionChangeStarted()}positionChangeFinished(){return this.geHeadless.positionChangeFinished()}getMovementProgress(t){return this.geHeadless.getMovementProgress(t)}rebuildTileCollisionCache(t,e,n,s){this.geHeadless.rebuildTileCollisionCache(t,e,n,s)}addQueueMovements(t,e,n){this.geHeadless.addQueueMovements(t,e,n)}getEnqueuedMovements(t){return this.geHeadless.getEnqueuedMovements(t)}queueMovementFinished(){return this.geHeadless.queueMovementFinished()}clearEnqueuedMovements(t){return this.geHeadless.clearEnqueuedMovements(t)}getState(){return{characters:this.geHeadless.getState().characters.map(t=>Pe(it({},t),{offsetX:this.getOffsetX(t.id),offsetY:this.getOffsetY(t.id)}))}}setState(t){if(this.geHeadless.setState(t),this.gridCharacters)for(let e of t.characters){let n=this.gridCharacters.get(e.id);n&&(n.setOffsetX(e.offsetX),n.setOffsetY(e.offsetY))}}getTileCost(t,e,n){return this.initGuard(),this.geHeadless.getTileCost(t,e,n)}setConfigDefaults(t){return it({collisionTilePropertyName:"ge_collide",numberOfDirections:4,characterCollisionStrategy:"BLOCK_TWO_TILES",layerOverlay:!1,cacheTileCollisions:!1},t)}initGuard(){if(!this.isCreatedInternal)throw this.createUninitializedErr()}createUninitializedErr(){throw new Error("GridEngine not initialized. You need to call create() first.")}addCharacters(){var t;(t=this.config)==null||t.characters.forEach(e=>this.addCharacterInternal(e))}createCharUnknownErr(t){return new Error(`Character unknown: ${t}`)}addCharacterInternal(t){var n;if(this.initGuard(),!this.gridTilemap)throw this.createUninitializedErr();if(!this.config)throw this.createUninitializedErr();let e=new hs(t,this.scene,this.gridTilemap,this.config.layerOverlay,this.geHeadless);(n=this.gridCharacters)==null||n.set(t.id,e)}};jn.welcomeMessagePrinted=!1;var Us=jn;var AM=Us;export{ch as ArrayTilemap,oh as CharacterShiftAction,cs as CollisionStrategy,le as Direction,Us as GridEngine,Ns as GridEngineHeadless,sh as MoveToResult,zi as NoPathFoundStrategy,Gr as NumberOfDirections,On as PathBlockedStrategy,gi as PhaserTile,Vn as PhaserTileLayer,Gs as PhaserTilemap,Zd as QueuedPathBlockedStrategy,Un as TiledLayer,Gn as TiledTile,ph as TiledTilemap,AM as default,re as directionFromPos};
/*! Bundled license information:

tiled-property-flattener/dist/tiled_property_flattener.min.js:
  (*! Bundled license information:
  
  lodash/lodash.js:
    (**
     * @license
     * Lodash <https://lodash.com/>
     * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
     * Released under MIT license <https://lodash.com/license>
     * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
     * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
     *)
  *)
*/
